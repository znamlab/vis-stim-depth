<?xml version="1.0" encoding="utf-8"?>
<WorkflowBuilder Version="2.6.2"
                 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                 xmlns:osc="clr-namespace:Bonsai.Osc;assembly=Bonsai.Osc"
                 xmlns:io="clr-namespace:Bonsai.IO;assembly=Bonsai.System"
                 xmlns:rx="clr-namespace:Bonsai.Reactive;assembly=Bonsai.Core"
                 xmlns:sys="clr-namespace:System;assembly=mscorlib"
                 xmlns:p1="clr-namespace:;assembly=Extensions"
                 xmlns:scr="clr-namespace:Bonsai.Scripting;assembly=Bonsai.Scripting"
                 xmlns:num="clr-namespace:Bonsai.Numerics;assembly=Bonsai.Numerics"
                 xmlns:harp="clr-namespace:Bonsai.Harp;assembly=Bonsai.Harp"
                 xmlns:dsp="clr-namespace:Bonsai.Dsp;assembly=Bonsai.Dsp"
                 xmlns:p2="clr-namespace:Bonsai.Harp.CF;assembly=Bonsai.Harp.CF"
                 xmlns:gl="clr-namespace:Bonsai.Shaders;assembly=Bonsai.Shaders"
                 xmlns:res="clr-namespace:Bonsai.Resources;assembly=Bonsai.System"
                 xmlns:wie="clr-namespace:Bonsai.Windows.Input;assembly=Bonsai.Windows.Input"
                 xmlns:p3="clr-namespace:Bonsai.Numerics.Distributions;assembly=Bonsai.Numerics"
                 xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib"
                 xmlns="https://bonsai-rx.org/2018/workflow">
  <Workflow>
    <Nodes>
      <Expression xsi:type="Combinator">
        <Combinator xsi:type="osc:CreateUdpClient">
          <osc:Name>UdpSend</osc:Name>
          <osc:Port>2323</osc:Port>
          <osc:RemoteHostName>10.0.250.44</osc:RemoteHostName>
          <osc:RemotePort>2323</osc:RemotePort>
        </Combinator>
      </Expression>
      <Expression xsi:type="Combinator">
        <Combinator xsi:type="osc:CreateUdpClient">
          <osc:Name>UdpSend_beh</osc:Name>
          <osc:Port>2324</osc:Port>
          <osc:RemoteHostName>10.0.250.44</osc:RemoteHostName>
          <osc:RemotePort>2324</osc:RemotePort>
        </Combinator>
      </Expression>
      <Expression xsi:type="GroupWorkflow">
        <Name>PhotodiodeSequence</Name>
        <Workflow>
          <Nodes>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="FileName" DisplayName="Sequence File" />
            </Expression>
            <Expression xsi:type="io:CsvReader">
              <io:FileName>Extensions\random_sequence_5values_alternate.csv</io:FileName>
              <io:ScanPattern>%d</io:ScanPattern>
              <io:SkipRows>0</io:SkipRows>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:ToList" />
            </Expression>
            <Expression xsi:type="BehaviorSubject">
              <Name>sequence</Name>
            </Expression>
            <Expression xsi:type="WorkflowOutput" />
          </Nodes>
          <Edges>
            <Edge From="0" To="1" Label="Source1" />
            <Edge From="1" To="2" Label="Source1" />
            <Edge From="2" To="3" Label="Source1" />
            <Edge From="3" To="4" Label="Source1" />
          </Edges>
        </Workflow>
      </Expression>
      <Expression xsi:type="PublishSubject" TypeArguments="sys:Int32">
        <Name>TrialNo</Name>
      </Expression>
      <Expression xsi:type="Combinator">
        <Combinator xsi:type="p1:MetadataSource">
          <p1:ExpInfo>
            <p1:Animal>Test</p1:Animal>
            <p1:RootDirectory>D:\data</p1:RootDirectory>
          </p1:ExpInfo>
          <p1:Animal>Test</p1:Animal>
          <p1:RootDirectory>D:\data</p1:RootDirectory>
        </Combinator>
      </Expression>
      <Expression xsi:type="Combinator">
        <Combinator xsi:type="rx:Timestamp" />
      </Expression>
      <Expression xsi:type="scr:ExpressionTransform">
        <scr:Expression>new(
it.Value.Animal as Animal,
it.Value.RootDirectory as RootDirectory,
it.Timestamp.Year.ToString() as Year,
it.Timestamp.Month&lt;10? ("0"+it.Timestamp.Month.ToString()):(it.Timestamp.Month.ToString()) as Month,
it.Timestamp.Day&lt;10? ("0"+it.Timestamp.Day.ToString()):(it.Timestamp.Day.ToString()) as Day,
it.Timestamp.Hour&lt;10? ("0"+it.Timestamp.Hour.ToString()):(it.Timestamp.Hour.ToString()) as Hour,
it.Timestamp.Minute&lt;10? ("0"+it.Timestamp.Minute.ToString()):(it.Timestamp.Minute.ToString()) as Minute,
it.Timestamp.Second&lt;10? ("0"+it.Timestamp.Second.ToString()):(it.Timestamp.Second.ToString()) as Second
)</scr:Expression>
      </Expression>
      <Expression xsi:type="BehaviorSubject">
        <Name>Metadata</Name>
      </Expression>
      <Expression xsi:type="ExternalizedMapping">
        <Property Name="InitialDelayReplay" Category="Exp Timings" />
        <Property Name="TrialDuration" DisplayName="TrialDuration" Description="Duration of 1 depth" Category="Exp Timings" />
        <Property Name="InterTrialDelay" Category="Exp Timings" />
        <Property Name="RepeatNumber" DisplayName="RepeatNumber" Description="Number of repeating all depth values" Category="Exp Timings" />
        <Property Name="DepthCount" Category="Exp Timings" />
      </Expression>
      <Expression xsi:type="GroupWorkflow">
        <Name>BasicSettings</Name>
        <Description />
        <Workflow>
          <Nodes>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="InitialDelayReplay" />
              <Property Name="TrialDuration" />
              <Property Name="InterTrialDelay" />
              <Property Name="RepeatNumber" />
              <Property Name="DepthCount" />
            </Expression>
            <Expression xsi:type="GroupWorkflow">
              <Name>ExpTimings</Name>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Value" DisplayName="InitialDelayReplay" Category="Timings" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="FloatProperty">
                      <Value>30</Value>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Multiply">
                    <Operand xsi:type="FloatProperty">
                      <Value>1E+07</Value>
                    </Operand>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>InitialDelayReplay</Name>
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Value" DisplayName="TrialDuration" Description="Duration of 1 trial (1 fixed depth)" Category="Timings" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="FloatProperty">
                      <Value>10</Value>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Multiply">
                    <Operand xsi:type="FloatProperty">
                      <Value>1E+07</Value>
                    </Operand>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>TrialDuration</Name>
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Value" DisplayName="RepeatNumber" Description="Number of repeat of all the depth values" Category="Timings" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="IntProperty">
                      <Value>100</Value>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>RepeatNumber</Name>
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Value" DisplayName="InterTrialDelay" Description="Interval between 2 trials" Category="Timings" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="FloatProperty">
                      <Value>10</Value>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Multiply">
                    <Operand xsi:type="FloatProperty">
                      <Value>1E+07</Value>
                    </Operand>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>InterTrialDelay</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Zip" />
                  </Expression>
                  <Expression xsi:type="Add" />
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Value" DisplayName="DepthCount" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="IntProperty">
                      <Value>8</Value>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>DepthCount</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Zip" />
                  </Expression>
                  <Expression xsi:type="Multiply" />
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Zip" />
                  </Expression>
                  <Expression xsi:type="Multiply" />
                  <Expression xsi:type="BehaviorSubject">
                    <Name>CloseLoopDuration</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Zip" />
                  </Expression>
                  <Expression xsi:type="Add" />
                  <Expression xsi:type="BehaviorSubject">
                    <Name>OpenLoopStartTime</Name>
                  </Expression>
                  <Expression xsi:type="WorkflowOutput" />
                </Nodes>
                <Edges>
                  <Edge From="0" To="1" Label="Source1" />
                  <Edge From="1" To="2" Label="Source1" />
                  <Edge From="2" To="3" Label="Source1" />
                  <Edge From="3" To="25" Label="Source2" />
                  <Edge From="4" To="5" Label="Source1" />
                  <Edge From="5" To="6" Label="Source1" />
                  <Edge From="6" To="7" Label="Source1" />
                  <Edge From="7" To="15" Label="Source1" />
                  <Edge From="8" To="9" Label="Source1" />
                  <Edge From="9" To="10" Label="Source1" />
                  <Edge From="10" To="20" Label="Source1" />
                  <Edge From="11" To="12" Label="Source1" />
                  <Edge From="12" To="13" Label="Source1" />
                  <Edge From="13" To="14" Label="Source1" />
                  <Edge From="14" To="15" Label="Source2" />
                  <Edge From="15" To="16" Label="Source1" />
                  <Edge From="16" To="22" Label="Source1" />
                  <Edge From="17" To="18" Label="Source1" />
                  <Edge From="18" To="19" Label="Source1" />
                  <Edge From="19" To="20" Label="Source2" />
                  <Edge From="20" To="21" Label="Source1" />
                  <Edge From="21" To="22" Label="Source2" />
                  <Edge From="22" To="23" Label="Source1" />
                  <Edge From="23" To="24" Label="Source1" />
                  <Edge From="24" To="25" Label="Source1" />
                  <Edge From="25" To="26" Label="Source1" />
                  <Edge From="26" To="27" Label="Source1" />
                  <Edge From="27" To="28" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="WhichExp" />
            </Expression>
            <Expression xsi:type="GroupWorkflow">
              <Name>ChooseExperiment</Name>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Value" DisplayName="WhichExp" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="StringProperty">
                      <Value>SpheresPermTubeReward</Value>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Take">
                      <rx:Count>1</rx:Count>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="AsyncSubject">
                    <Name>WhichExp</Name>
                  </Expression>
                </Nodes>
                <Edges>
                  <Edge From="0" To="1" Label="Source1" />
                  <Edge From="1" To="2" Label="Source1" />
                  <Edge From="2" To="3" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="GroupWorkflow">
              <Name>SetFileSaving</Name>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>Metadata</Name>
                  </Expression>
                  <Expression xsi:type="Format">
                    <Format>{0}\{1}</Format>
                    <Selector>RootDirectory,Animal</Selector>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>SaveGeneralPrefix</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>Metadata</Name>
                  </Expression>
                  <Expression xsi:type="Format">
                    <Format>{0}{1}{2}</Format>
                    <Selector>Year,Month,Day</Selector>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>SaveDate</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>Metadata</Name>
                  </Expression>
                  <Expression xsi:type="Format">
                    <Format>{0}{1}{2}</Format>
                    <Selector>Hour,Minute,Second</Selector>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>SaveTimestamp</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>WhichExp</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Zip" />
                  </Expression>
                  <Expression xsi:type="Format">
                    <Format>{0}\S{1}\R{2}_{3}\</Format>
                    <Selector>Item1,Item2,Item3,Item4</Selector>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>RootName</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>SaveTimestamp</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>SaveDate</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>Metadata</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>WhichExp</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Zip" />
                  </Expression>
                  <Expression xsi:type="Format">
                    <Format>{0}\S{1}\R{2}_{3}</Format>
                    <Selector>Item1.Animal,Item2,Item3,Item4</Selector>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>SaveCameraFilePath</Name>
                  </Expression>
                  <Expression xsi:type="osc:SendMessage">
                    <osc:Connection>UdpSend_beh</osc:Connection>
                    <osc:Address>/beh_fname</osc:Address>
                  </Expression>
                </Nodes>
                <Edges>
                  <Edge From="0" To="1" Label="Source1" />
                  <Edge From="1" To="2" Label="Source1" />
                  <Edge From="2" To="10" Label="Source1" />
                  <Edge From="3" To="4" Label="Source1" />
                  <Edge From="4" To="5" Label="Source1" />
                  <Edge From="5" To="10" Label="Source2" />
                  <Edge From="6" To="7" Label="Source1" />
                  <Edge From="7" To="8" Label="Source1" />
                  <Edge From="8" To="10" Label="Source3" />
                  <Edge From="9" To="10" Label="Source4" />
                  <Edge From="10" To="11" Label="Source1" />
                  <Edge From="11" To="12" Label="Source1" />
                  <Edge From="13" To="17" Label="Source3" />
                  <Edge From="14" To="17" Label="Source2" />
                  <Edge From="15" To="17" Label="Source1" />
                  <Edge From="16" To="17" Label="Source4" />
                  <Edge From="17" To="18" Label="Source1" />
                  <Edge From="18" To="19" Label="Source1" />
                  <Edge From="19" To="20" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
          </Nodes>
          <Edges>
            <Edge From="0" To="1" Label="Source1" />
            <Edge From="2" To="3" Label="Source1" />
          </Edges>
        </Workflow>
      </Expression>
      <Expression xsi:type="GroupWorkflow">
        <Name>SetRandomSeed</Name>
        <Workflow>
          <Nodes>
            <Expression xsi:type="SubscribeSubject">
              <Name>Metadata</Name>
            </Expression>
            <Expression xsi:type="MemberSelector">
              <Selector>Year,Month,Day</Selector>
            </Expression>
            <Expression xsi:type="Format">
              <Format>{1}{2}</Format>
              <Selector>Item1,Item2,Item3</Selector>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="p1:Str2Int" />
            </Expression>
            <Expression xsi:type="AsyncSubject">
              <Name>RandomSeed</Name>
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>RandomSeed</Name>
            </Expression>
            <Expression xsi:type="PropertyMapping">
              <PropertyMappings>
                <Property Name="Seed" />
              </PropertyMappings>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="num:CreateRandom">
                <num:Seed>123123123</num:Seed>
              </Combinator>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:Take">
                <rx:Count>1</rx:Count>
              </Combinator>
            </Expression>
            <Expression xsi:type="AsyncSubject">
              <Name>Seed</Name>
            </Expression>
          </Nodes>
          <Edges>
            <Edge From="0" To="1" Label="Source1" />
            <Edge From="1" To="2" Label="Source1" />
            <Edge From="2" To="3" Label="Source1" />
            <Edge From="3" To="4" Label="Source1" />
            <Edge From="5" To="6" Label="Source1" />
            <Edge From="6" To="7" Label="Source1" />
            <Edge From="7" To="8" Label="Source1" />
            <Edge From="8" To="9" Label="Source1" />
          </Edges>
        </Workflow>
      </Expression>
      <Expression xsi:type="GroupWorkflow">
        <Name>SetHarpSavePath</Name>
        <Workflow>
          <Nodes>
            <Expression xsi:type="SubscribeSubject">
              <Name>RootName</Name>
            </Expression>
            <Expression xsi:type="Format">
              <Format>{0}\harpmessage.bin</Format>
              <Selector>it</Selector>
            </Expression>
            <Expression xsi:type="WorkflowOutput" />
          </Nodes>
          <Edges>
            <Edge From="0" To="1" Label="Source1" />
            <Edge From="1" To="2" Label="Source1" />
          </Edges>
        </Workflow>
      </Expression>
      <Expression xsi:type="PropertyMapping">
        <PropertyMappings>
          <Property Name="HarpSavePath" />
        </PropertyMappings>
      </Expression>
      <Expression xsi:type="GroupWorkflow">
        <Name>harp_hardware</Name>
        <Workflow>
          <Nodes>
            <Expression xsi:type="IncludeWorkflow" Path="Bonsai.Harp:CommandSubject.bonsai">
              <Name>Command</Name>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="harp:Device">
                <harp:DeviceState>Active</harp:DeviceState>
                <harp:DumpRegisters>true</harp:DumpRegisters>
                <harp:LedState>On</harp:LedState>
                <harp:VisualIndicators>On</harp:VisualIndicators>
                <harp:Heartbeat>Disable</harp:Heartbeat>
                <harp:IgnoreErrors>false</harp:IgnoreErrors>
                <harp:PortName>COM3</harp:PortName>
              </Combinator>
            </Expression>
            <Expression xsi:type="MemberSelector">
              <Selector>MessageBytes</Selector>
            </Expression>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="Path" DisplayName="HarpSavePath" Category="Logging" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="dsp:MatrixWriter">
                <dsp:Path>D:\data\Test\S20240821\R140249_SpheresPermTubeReward\\harpmessage.bin</dsp:Path>
                <dsp:Suffix>None</dsp:Suffix>
                <dsp:Overwrite>false</dsp:Overwrite>
                <dsp:Layout>ColumnMajor</dsp:Layout>
              </Combinator>
            </Expression>
            <Expression xsi:type="IncludeWorkflow" Path="Bonsai.Harp:MulticastTimestamp.bonsai">
              <Name>Timestamp</Name>
            </Expression>
            <Expression xsi:type="p2:BehaviorEvent">
              <p2:Type>Input</p2:Type>
              <p2:Mask>Port1</p2:Mask>
            </Expression>
            <Expression xsi:type="PublishSubject">
              <Name>LickDetection</Name>
            </Expression>
            <Expression xsi:type="p2:BehaviorEvent">
              <p2:Type>RegisterAnalogInput</p2:Type>
              <p2:Mask>Port2</p2:Mask>
            </Expression>
            <Expression xsi:type="MemberSelector">
              <Selector>Value</Selector>
            </Expression>
            <Expression xsi:type="BehaviorSubject">
              <Name>photodiode</Name>
            </Expression>
            <Expression xsi:type="p2:BehaviorEvent">
              <p2:Type>QuadratureCounter</p2:Type>
              <p2:Mask>Port2</p2:Mask>
            </Expression>
            <Expression xsi:type="GroupWorkflow">
              <Name>CalculateDistance</Name>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="WorkflowInput">
                    <Name>Source1</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Skip">
                      <rx:Count>1</rx:Count>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Buffer">
                      <rx:Count>2</rx:Count>
                      <rx:Skip>1</rx:Skip>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Name>diffence</scr:Name>
                    <scr:Expression>it[0]-it[1]</scr:Expression>
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Name>CutArtefact</scr:Name>
                    <scr:Expression>new(
(it &gt; 60000)? (it-65536) : ((it&lt;-60000)? (it+65536) : it) as step
) </scr:Expression>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>step</Selector>
                  </Expression>
                  <Expression xsi:type="rx:Accumulate" />
                  <Expression xsi:type="GroupWorkflow">
                    <Name>README&gt;&gt;</Name>
                    <Description>Change the order in "difference" when putting rotary encoder at different side</Description>
                    <Workflow>
                      <Nodes>
                        <Expression xsi:type="WorkflowInput">
                          <Name>Source1</Name>
                        </Expression>
                        <Expression xsi:type="WorkflowOutput" />
                      </Nodes>
                      <Edges>
                        <Edge From="0" To="1" Label="Source1" />
                      </Edges>
                    </Workflow>
                  </Expression>
                  <Expression xsi:type="WorkflowOutput" />
                </Nodes>
                <Edges>
                  <Edge From="0" To="1" Label="Source1" />
                  <Edge From="1" To="2" Label="Source1" />
                  <Edge From="2" To="3" Label="Source1" />
                  <Edge From="3" To="4" Label="Source1" />
                  <Edge From="4" To="5" Label="Source1" />
                  <Edge From="5" To="6" Label="Source1" />
                  <Edge From="6" To="7" Label="Source1" />
                  <Edge From="7" To="8" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="GroupWorkflow">
              <Name>Convert to cm</Name>
              <Description>Convert to cm</Description>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Value" DisplayName="EncoderCPR" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="FloatProperty">
                      <Value>4096</Value>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Value" DisplayName="WheelDiameter" Description="in cm" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="FloatProperty">
                      <Value>20</Value>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="WorkflowInput">
                    <Name>Source1</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:CombineLatest" />
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Expression>Item1 * (2*Math.PI*(Item3/2)) / Item2</scr:Expression>
                  </Expression>
                  <Expression xsi:type="WorkflowOutput" />
                </Nodes>
                <Edges>
                  <Edge From="0" To="1" Label="Source1" />
                  <Edge From="1" To="5" Label="Source2" />
                  <Edge From="2" To="3" Label="Source1" />
                  <Edge From="3" To="5" Label="Source3" />
                  <Edge From="4" To="5" Label="Source1" />
                  <Edge From="5" To="6" Label="Source1" />
                  <Edge From="6" To="7" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="BehaviorSubject">
              <Name>Mouse Distance</Name>
            </Expression>
            <Expression xsi:type="p2:BehaviorEvent">
              <p2:Type>Input</p2:Type>
              <p2:Mask>Port0</p2:Mask>
            </Expression>
            <Expression xsi:type="PublishSubject">
              <Name>SIFrameTrigger</Name>
            </Expression>
            <Expression xsi:type="BehaviorSubject" TypeArguments="sys:Int32">
              <Name>RewardDuration</Name>
            </Expression>
            <Expression xsi:type="Disable">
              <Builder xsi:type="Combinator">
                <Combinator xsi:type="IntProperty">
                  <Value>250</Value>
                </Combinator>
              </Builder>
            </Expression>
            <Expression xsi:type="p2:BehaviorCommand">
              <p2:Type>PulsePeriod</p2:Type>
              <p2:Mask>Poke2Valve</p2:Mask>
            </Expression>
            <Expression xsi:type="MulticastSubject">
              <Name>Command</Name>
            </Expression>
            <Expression xsi:type="PublishSubject" TypeArguments="sys:Boolean">
              <Name>Reward</Name>
            </Expression>
            <Expression xsi:type="Disable">
              <Builder xsi:type="Combinator">
                <Combinator xsi:type="BooleanProperty">
                  <Value>false</Value>
                </Combinator>
              </Builder>
            </Expression>
            <Expression xsi:type="p2:BehaviorCommand">
              <p2:Type>ToggleOutput</p2:Type>
              <p2:Mask>Poke2Valve</p2:Mask>
            </Expression>
            <Expression xsi:type="MulticastSubject">
              <Name>Command</Name>
            </Expression>
            <Expression xsi:type="IncludeWorkflow" Path="Bonsai.Harp:TimestampSubject.bonsai">
              <Name>Timestamp</Name>
            </Expression>
            <Expression xsi:type="PublishSubject" TypeArguments="sys:Boolean">
              <Name>DO0</Name>
            </Expression>
            <Expression xsi:type="Disable">
              <Builder xsi:type="Combinator">
                <Combinator xsi:type="BooleanProperty">
                  <Value>false</Value>
                </Combinator>
              </Builder>
            </Expression>
            <Expression xsi:type="p2:BehaviorCommand">
              <p2:Type>ToggleOutput</p2:Type>
              <p2:Mask>Digital0</p2:Mask>
            </Expression>
            <Expression xsi:type="MulticastSubject">
              <Name>Command</Name>
            </Expression>
          </Nodes>
          <Edges>
            <Edge From="0" To="1" Label="Source1" />
            <Edge From="1" To="2" Label="Source1" />
            <Edge From="1" To="5" Label="Source1" />
            <Edge From="1" To="6" Label="Source1" />
            <Edge From="1" To="8" Label="Source1" />
            <Edge From="1" To="11" Label="Source1" />
            <Edge From="1" To="15" Label="Source1" />
            <Edge From="2" To="4" Label="Source2" />
            <Edge From="3" To="4" Label="Source1" />
            <Edge From="6" To="7" Label="Source1" />
            <Edge From="8" To="9" Label="Source1" />
            <Edge From="9" To="10" Label="Source1" />
            <Edge From="11" To="12" Label="Source1" />
            <Edge From="12" To="13" Label="Source1" />
            <Edge From="13" To="14" Label="Source1" />
            <Edge From="15" To="16" Label="Source1" />
            <Edge From="17" To="18" Label="Source1" />
            <Edge From="18" To="19" Label="Source1" />
            <Edge From="19" To="20" Label="Source1" />
            <Edge From="21" To="22" Label="Source1" />
            <Edge From="22" To="23" Label="Source1" />
            <Edge From="23" To="24" Label="Source1" />
            <Edge From="26" To="27" Label="Source1" />
            <Edge From="27" To="28" Label="Source1" />
            <Edge From="28" To="29" Label="Source1" />
          </Edges>
        </Workflow>
      </Expression>
      <Expression xsi:type="GroupWorkflow">
        <Name>DoEverything</Name>
        <Workflow>
          <Nodes>
            <Expression xsi:type="GroupWorkflow">
              <Name>InitBonvision3D</Name>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="WindowState" />
                    <Property Name="DisplayDevice" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:CreateWindow">
                      <gl:Width>640</gl:Width>
                      <gl:Height>480</gl:Height>
                      <gl:VSync>Off</gl:VSync>
                      <gl:SwapSync>false</gl:SwapSync>
                      <gl:ClearColor>Gray</gl:ClearColor>
                      <gl:ClearMask>DepthBufferBit ColorBufferBit</gl:ClearMask>
                      <gl:CursorVisible>true</gl:CursorVisible>
                      <gl:Location xsi:nil="true" />
                      <gl:WindowBorder>Resizable</gl:WindowBorder>
                      <gl:WindowState>Fullscreen</gl:WindowState>
                      <gl:DisplayDevice>Primary</gl:DisplayDevice>
                      <gl:TargetRenderFrequency>140</gl:TargetRenderFrequency>
                      <gl:TargetUpdateFrequency xsi:nil="true" />
                      <gl:RenderState />
                      <gl:GraphicsMode>
                        <gl:ColorFormat>
                          <gl:Red>8</gl:Red>
                          <gl:Green>8</gl:Green>
                          <gl:Blue>8</gl:Blue>
                          <gl:Alpha>8</gl:Alpha>
                        </gl:ColorFormat>
                        <gl:Depth>16</gl:Depth>
                        <gl:Stencil>0</gl:Stencil>
                        <gl:Samples>0</gl:Samples>
                        <gl:AccumulatorFormat>
                          <gl:Red>0</gl:Red>
                          <gl:Green>0</gl:Green>
                          <gl:Blue>0</gl:Blue>
                          <gl:Alpha>0</gl:Alpha>
                        </gl:AccumulatorFormat>
                        <gl:Buffers>2</gl:Buffers>
                        <gl:Stereo>false</gl:Stereo>
                      </gl:GraphicsMode>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.BonVisionResources.bonsai" />
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:ShaderResources">
                      <gl:Shaders />
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:MeshResources">
                      <gl:Meshes>
                        <gl:MeshConfiguration xsi:type="gl:TexturedModel">
                          <gl:Name>sphere</gl:Name>
                          <gl:FileName>..\..\Objects\sphere.obj</gl:FileName>
                        </gl:MeshConfiguration>
                      </gl:Meshes>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:TextureResources">
                      <gl:Textures>
                        <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                          <gl:Name>fwn1</gl:Name>
                          <gl:Width xsi:nil="true" />
                          <gl:Height xsi:nil="true" />
                          <gl:InternalFormat>Rgba</gl:InternalFormat>
                          <gl:WrapS>Repeat</gl:WrapS>
                          <gl:WrapT>Repeat</gl:WrapT>
                          <gl:MinFilter>Linear</gl:MinFilter>
                          <gl:MagFilter>Linear</gl:MagFilter>
                          <gl:FileName>Textures\fwn1.jpg</gl:FileName>
                          <gl:ColorType>Unchanged</gl:ColorType>
                          <gl:FlipMode>Vertical</gl:FlipMode>
                        </gl:TextureConfiguration>
                        <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                          <gl:Name>fwn2</gl:Name>
                          <gl:Width xsi:nil="true" />
                          <gl:Height xsi:nil="true" />
                          <gl:InternalFormat>Rgba</gl:InternalFormat>
                          <gl:WrapS>Repeat</gl:WrapS>
                          <gl:WrapT>Repeat</gl:WrapT>
                          <gl:MinFilter>Linear</gl:MinFilter>
                          <gl:MagFilter>Linear</gl:MagFilter>
                          <gl:FileName>Textures\fwn2.jpg</gl:FileName>
                          <gl:ColorType>Unchanged</gl:ColorType>
                          <gl:FlipMode>Vertical</gl:FlipMode>
                        </gl:TextureConfiguration>
                        <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                          <gl:Name>fwn3</gl:Name>
                          <gl:Width xsi:nil="true" />
                          <gl:Height xsi:nil="true" />
                          <gl:InternalFormat>Rgba</gl:InternalFormat>
                          <gl:WrapS>Repeat</gl:WrapS>
                          <gl:WrapT>Repeat</gl:WrapT>
                          <gl:MinFilter>Linear</gl:MinFilter>
                          <gl:MagFilter>Linear</gl:MagFilter>
                          <gl:FileName>Textures\fwn3.jpg</gl:FileName>
                          <gl:ColorType>Unchanged</gl:ColorType>
                          <gl:FlipMode>Vertical</gl:FlipMode>
                        </gl:TextureConfiguration>
                        <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                          <gl:Name>fwn4</gl:Name>
                          <gl:Width xsi:nil="true" />
                          <gl:Height xsi:nil="true" />
                          <gl:InternalFormat>Rgba</gl:InternalFormat>
                          <gl:WrapS>Repeat</gl:WrapS>
                          <gl:WrapT>Repeat</gl:WrapT>
                          <gl:MinFilter>Linear</gl:MinFilter>
                          <gl:MagFilter>Linear</gl:MagFilter>
                          <gl:FileName>Textures\fwn4.jpg</gl:FileName>
                          <gl:ColorType>Unchanged</gl:ColorType>
                          <gl:FlipMode>Vertical</gl:FlipMode>
                        </gl:TextureConfiguration>
                        <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                          <gl:Name>grayEnd</gl:Name>
                          <gl:Width xsi:nil="true" />
                          <gl:Height xsi:nil="true" />
                          <gl:InternalFormat>Rgba</gl:InternalFormat>
                          <gl:WrapS>Repeat</gl:WrapS>
                          <gl:WrapT>Repeat</gl:WrapT>
                          <gl:MinFilter>Linear</gl:MinFilter>
                          <gl:MagFilter>Linear</gl:MagFilter>
                          <gl:FileName>Textures\grayEnd.jpg</gl:FileName>
                          <gl:ColorType>Unchanged</gl:ColorType>
                          <gl:FlipMode>Vertical</gl:FlipMode>
                        </gl:TextureConfiguration>
                        <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                          <gl:Name>horGrat</gl:Name>
                          <gl:Width xsi:nil="true" />
                          <gl:Height xsi:nil="true" />
                          <gl:InternalFormat>Rgba</gl:InternalFormat>
                          <gl:WrapS>Repeat</gl:WrapS>
                          <gl:WrapT>Repeat</gl:WrapT>
                          <gl:MinFilter>Linear</gl:MinFilter>
                          <gl:MagFilter>Linear</gl:MagFilter>
                          <gl:FileName>Textures\horGrat.jpg</gl:FileName>
                          <gl:ColorType>Unchanged</gl:ColorType>
                          <gl:FlipMode>Vertical</gl:FlipMode>
                        </gl:TextureConfiguration>
                        <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                          <gl:Name>plaid</gl:Name>
                          <gl:Width xsi:nil="true" />
                          <gl:Height xsi:nil="true" />
                          <gl:InternalFormat>Rgba</gl:InternalFormat>
                          <gl:WrapS>Repeat</gl:WrapS>
                          <gl:WrapT>Repeat</gl:WrapT>
                          <gl:MinFilter>Linear</gl:MinFilter>
                          <gl:MagFilter>Linear</gl:MagFilter>
                          <gl:FileName>Textures\plaid.jpg</gl:FileName>
                          <gl:ColorType>Unchanged</gl:ColorType>
                          <gl:FlipMode>Vertical</gl:FlipMode>
                        </gl:TextureConfiguration>
                        <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                          <gl:Name>vertGrat</gl:Name>
                          <gl:Width xsi:nil="true" />
                          <gl:Height xsi:nil="true" />
                          <gl:InternalFormat>Rgba</gl:InternalFormat>
                          <gl:WrapS>Repeat</gl:WrapS>
                          <gl:WrapT>Repeat</gl:WrapT>
                          <gl:MinFilter>Linear</gl:MinFilter>
                          <gl:MagFilter>Linear</gl:MagFilter>
                          <gl:FileName>Textures\vertGrat.jpg</gl:FileName>
                          <gl:ColorType>Unchanged</gl:ColorType>
                          <gl:FlipMode>Vertical</gl:FlipMode>
                        </gl:TextureConfiguration>
                        <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                          <gl:Name>wider_plaid</gl:Name>
                          <gl:Width xsi:nil="true" />
                          <gl:Height xsi:nil="true" />
                          <gl:InternalFormat>Rgba</gl:InternalFormat>
                          <gl:WrapS>Repeat</gl:WrapS>
                          <gl:WrapT>Repeat</gl:WrapT>
                          <gl:MinFilter>Linear</gl:MinFilter>
                          <gl:MagFilter>Linear</gl:MagFilter>
                          <gl:FileName>Textures\wider_plaid.png</gl:FileName>
                          <gl:ColorType>Unchanged</gl:ColorType>
                          <gl:FlipMode>Vertical</gl:FlipMode>
                        </gl:TextureConfiguration>
                        <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                          <gl:Name>longer_plaid</gl:Name>
                          <gl:Width xsi:nil="true" />
                          <gl:Height xsi:nil="true" />
                          <gl:InternalFormat>Rgba</gl:InternalFormat>
                          <gl:WrapS>Repeat</gl:WrapS>
                          <gl:WrapT>Repeat</gl:WrapT>
                          <gl:MinFilter>Linear</gl:MinFilter>
                          <gl:MagFilter>Linear</gl:MagFilter>
                          <gl:FileName>Textures\longer_plaid.png</gl:FileName>
                          <gl:ColorType>Unchanged</gl:ColorType>
                          <gl:FlipMode>Vertical</gl:FlipMode>
                        </gl:TextureConfiguration>
                        <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                          <gl:Name>highf_plaid</gl:Name>
                          <gl:Width xsi:nil="true" />
                          <gl:Height xsi:nil="true" />
                          <gl:InternalFormat>Rgba</gl:InternalFormat>
                          <gl:WrapS>Repeat</gl:WrapS>
                          <gl:WrapT>Repeat</gl:WrapT>
                          <gl:MinFilter>Linear</gl:MinFilter>
                          <gl:MagFilter>Linear</gl:MagFilter>
                          <gl:FileName>Textures\highf_plaid.png</gl:FileName>
                          <gl:ColorType>Unchanged</gl:ColorType>
                          <gl:FlipMode>Vertical</gl:FlipMode>
                        </gl:TextureConfiguration>
                        <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                          <gl:Name>highf_Y_plaid</gl:Name>
                          <gl:Width xsi:nil="true" />
                          <gl:Height xsi:nil="true" />
                          <gl:InternalFormat>Rgba</gl:InternalFormat>
                          <gl:WrapS>Repeat</gl:WrapS>
                          <gl:WrapT>Repeat</gl:WrapT>
                          <gl:MinFilter>Linear</gl:MinFilter>
                          <gl:MagFilter>Linear</gl:MagFilter>
                          <gl:FileName>Textures\highf_Y_plaid.jpg</gl:FileName>
                          <gl:ColorType>Unchanged</gl:ColorType>
                          <gl:FlipMode>Vertical</gl:FlipMode>
                        </gl:TextureConfiguration>
                        <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                          <gl:Name>highf_X_plaid</gl:Name>
                          <gl:Width xsi:nil="true" />
                          <gl:Height xsi:nil="true" />
                          <gl:InternalFormat>Rgba</gl:InternalFormat>
                          <gl:WrapS>Repeat</gl:WrapS>
                          <gl:WrapT>Repeat</gl:WrapT>
                          <gl:MinFilter>Linear</gl:MinFilter>
                          <gl:MagFilter>Linear</gl:MagFilter>
                          <gl:FileName>Textures\highf_X_plaid.jpg</gl:FileName>
                          <gl:ColorType>Unchanged</gl:ColorType>
                          <gl:FlipMode>Vertical</gl:FlipMode>
                        </gl:TextureConfiguration>
                      </gl:Textures>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="res:LoadResources" />
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>Mouse Distance</Name>
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="ClearColor" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:RenderFrame" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:ElementIndex" />
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Index</Selector>
                  </Expression>
                  <Expression xsi:type="PublishSubject">
                    <Name>FrameIndex</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>Mouse Distance</Name>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>EyeDistance</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:CombineLatest" />
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Expression>new(
Item1 as MouseZ,
Item2 as EyeZ)</scr:Expression>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:WithLatestFrom" />
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>sequence</Name>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Count</Selector>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:WithLatestFrom" />
                  </Expression>
                  <Expression xsi:type="Mod" />
                  <Expression xsi:type="PublishSubject">
                    <Name>SequenceIndex</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>sequence</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:WithLatestFrom" />
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Name>Rename</scr:Name>
                    <scr:Expression>new(
it.item2[it.item1] as PhotoQuadColor,
it.Item1 as SequenceIndex
)</scr:Expression>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>PhotoquadLog</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>FrameIndex</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>PhotoquadLog</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Zip" />
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Name>Rename</scr:Name>
                    <scr:Expression>new(
Item1.Item1 as FrameObject,
Item1.Item2.MouseZ as MouseZ,
Item1.Item2.EyeZ as EyeZ,
Item2.PhotoQuadColor as PhotoQuadColor,
Item2.SequenceIndex as SequenceIndex,
Item3 as FrameIndex)</scr:Expression>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>FrameZ</Name>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>EyeZ</Selector>
                  </Expression>
                  <Expression xsi:type="InputMapping">
                    <PropertyMappings>
                      <Property Name="Z" Selector="it" />
                    </PropertyMappings>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:CreateVector3">
                      <gl:X>0</gl:X>
                      <gl:Y>0</gl:Y>
                      <gl:Z>0</gl:Z>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="GroupWorkflow">
                    <Name>SetViewports</Name>
                    <Workflow>
                      <Nodes>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="ClearColor" />
                        </Expression>
                        <Expression xsi:type="WorkflowInput">
                          <Name>Source1</Name>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:UpdateViewportState">
                            <gl:X>0</gl:X>
                            <gl:Y>0</gl:Y>
                            <gl:Width>1</gl:Width>
                            <gl:Height>1</gl:Height>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="InputMapping">
                          <PropertyMappings>
                            <Property Name="Eye" Selector="it" />
                          </PropertyMappings>
                        </Expression>
                        <Expression xsi:type="IncludeWorkflow" Path="BonVision:Environment.CubemapView.bonsai">
                          <Eye>
                            <X>0</X>
                            <Y>0</Y>
                            <Z>0</Z>
                          </Eye>
                          <NearClip>0.001</NearClip>
                          <FarClip>1000000</FarClip>
                          <Light>
                            <X>0</X>
                            <Y>0</Y>
                            <Z>0</Z>
                          </Light>
                        </Expression>
                        <Expression xsi:type="PublishSubject">
                          <Name>Draw</Name>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:RenderCubemap">
                            <gl:RenderState />
                            <gl:ClearColor>Gray</gl:ClearColor>
                            <gl:ClearMask>DepthBufferBit ColorBufferBit</gl:ClearMask>
                            <gl:FaceSize xsi:nil="true" />
                            <gl:InternalFormat>Rgb</gl:InternalFormat>
                            <gl:MinFilter>Linear</gl:MinFilter>
                            <gl:MagFilter>Linear</gl:MagFilter>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="IncludeWorkflow" Path="BonVision:Environment.ViewWindow.bonsai">
                          <Width>29.296875</Width>
                          <Height>52.0833321</Height>
                          <Rotation>
                            <X>0.0360390469</X>
                            <Y>-87.6625443</Y>
                            <Z>0.47383610000000004</Z>
                          </Rotation>
                          <Translation>
                            <X>-27</X>
                            <Y>-0.11900000274181366</Y>
                            <Z>0.79100000858306885</Z>
                          </Translation>
                        </Expression>
                        <Expression xsi:type="GroupWorkflow">
                          <Name>GammaCorrection</Name>
                          <Description>Renders the current scene to a texture and applies gamma correction as a post-processing effect.</Description>
                          <Workflow>
                            <Nodes>
                              <Expression xsi:type="WorkflowInput">
                                <Name>Source1</Name>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:UpdateViewportState">
                                  <gl:X>0</gl:X>
                                  <gl:Y>0</gl:Y>
                                  <gl:Width>1</gl:Width>
                                  <gl:Height>1</gl:Height>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="ExternalizedProperty">
                                <MemberName>ClearColor</MemberName>
                                <Name>ClearColor</Name>
                                <Category>Misc</Category>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:RenderTexture">
                                  <gl:RenderState />
                                  <gl:ClearColor>Gray</gl:ClearColor>
                                  <gl:ClearMask>DepthBufferBit ColorBufferBit</gl:ClearMask>
                                  <gl:Width xsi:nil="true" />
                                  <gl:Height xsi:nil="true" />
                                  <gl:InternalFormat>Rgb</gl:InternalFormat>
                                  <gl:WrapS>ClampToEdge</gl:WrapS>
                                  <gl:WrapT>ClampToEdge</gl:WrapT>
                                  <gl:MinFilter>Linear</gl:MinFilter>
                                  <gl:MagFilter>Linear</gl:MagFilter>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:BindTexture">
                                  <gl:TextureSlot>Texture0</gl:TextureSlot>
                                  <gl:ShaderName>Gamma</gl:ShaderName>
                                  <gl:TextureTarget>Texture2D</gl:TextureTarget>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="ExternalizedProperty">
                                <MemberName>Value</MemberName>
                                <Name>GammaLut</Name>
                              </Expression>
                              <Expression xsi:type="PropertySource" TypeArguments="gl:LoadImage,sys:String">
                                <MemberName>FileName</MemberName>
                                <Value>GammaCalibration\calibration_data\RonanCottage_2p\230106\Scr1_gammalut_gray_average_table.bmp</Value>
                              </Expression>
                              <Expression xsi:type="InputMapping">
                                <PropertyMappings>
                                  <Property Name="FileName" />
                                </PropertyMappings>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:LoadImage">
                                  <gl:Width xsi:nil="true" />
                                  <gl:Height xsi:nil="true" />
                                  <gl:InternalFormat>Rgba</gl:InternalFormat>
                                  <gl:WrapS>ClampToEdge</gl:WrapS>
                                  <gl:WrapT>ClampToEdge</gl:WrapT>
                                  <gl:MinFilter>Linear</gl:MinFilter>
                                  <gl:MagFilter>Linear</gl:MagFilter>
                                  <gl:FileName>GammaCalibration\calibration_data\RonanCottage_2p\230106\Scr1_gammalut_gray_average_table.bmp</gl:FileName>
                                  <gl:ColorType>Unchanged</gl:ColorType>
                                  <gl:FlipMode>Vertical</gl:FlipMode>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:WithLatestFrom" />
                              </Expression>
                              <Expression xsi:type="MemberSelector">
                                <Selector>Item2</Selector>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:BindTexture">
                                  <gl:TextureSlot>Texture1</gl:TextureSlot>
                                  <gl:ShaderName>Gamma</gl:ShaderName>
                                  <gl:TextureTarget>Texture2D</gl:TextureTarget>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:DrawMesh">
                                  <gl:ShaderName>Gamma</gl:ShaderName>
                                  <gl:MeshName>ViewportQuad</gl:MeshName>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="WorkflowOutput" />
                            </Nodes>
                            <Edges>
                              <Edge From="0" To="1" Label="Source1" />
                              <Edge From="1" To="3" Label="Source1" />
                              <Edge From="2" To="3" Label="Source2" />
                              <Edge From="3" To="4" Label="Source1" />
                              <Edge From="4" To="9" Label="Source1" />
                              <Edge From="5" To="6" Label="Source1" />
                              <Edge From="6" To="7" Label="Source1" />
                              <Edge From="7" To="8" Label="Source1" />
                              <Edge From="8" To="9" Label="Source2" />
                              <Edge From="9" To="10" Label="Source1" />
                              <Edge From="10" To="11" Label="Source1" />
                              <Edge From="11" To="12" Label="Source1" />
                              <Edge From="12" To="13" Label="Source1" />
                            </Edges>
                          </Workflow>
                        </Expression>
                        <Expression xsi:type="IncludeWorkflow" Path="BonVision:Environment.DrawViewport.bonsai">
                          <X>0</X>
                          <Y>0</Y>
                          <Width>0.25</Width>
                          <Height>1</Height>
                        </Expression>
                        <Expression xsi:type="IncludeWorkflow" Path="BonVision:Environment.ViewWindow.bonsai">
                          <Width>29.296875</Width>
                          <Height>52.0833321</Height>
                          <Rotation>
                            <X>0.103132404</X>
                            <Y>-27.1009026</Y>
                            <Z>1.071431</Z>
                          </Rotation>
                          <Translation>
                            <X>-13.300000190734863</X>
                            <Y>0.29100000858306885</Y>
                            <Z>23.5</Z>
                          </Translation>
                        </Expression>
                        <Expression xsi:type="GroupWorkflow">
                          <Name>GammaCorrection</Name>
                          <Description>Renders the current scene to a texture and applies gamma correction as a post-processing effect.</Description>
                          <Workflow>
                            <Nodes>
                              <Expression xsi:type="WorkflowInput">
                                <Name>Source1</Name>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:UpdateViewportState">
                                  <gl:X>0</gl:X>
                                  <gl:Y>0</gl:Y>
                                  <gl:Width>1</gl:Width>
                                  <gl:Height>1</gl:Height>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="ExternalizedProperty">
                                <MemberName>ClearColor</MemberName>
                                <Name>ClearColor</Name>
                                <Category>Misc</Category>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:RenderTexture">
                                  <gl:RenderState />
                                  <gl:ClearColor>Gray</gl:ClearColor>
                                  <gl:ClearMask>DepthBufferBit ColorBufferBit</gl:ClearMask>
                                  <gl:Width xsi:nil="true" />
                                  <gl:Height xsi:nil="true" />
                                  <gl:InternalFormat>Rgb</gl:InternalFormat>
                                  <gl:WrapS>ClampToEdge</gl:WrapS>
                                  <gl:WrapT>ClampToEdge</gl:WrapT>
                                  <gl:MinFilter>Linear</gl:MinFilter>
                                  <gl:MagFilter>Linear</gl:MagFilter>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:BindTexture">
                                  <gl:TextureSlot>Texture0</gl:TextureSlot>
                                  <gl:ShaderName>Gamma</gl:ShaderName>
                                  <gl:TextureTarget>Texture2D</gl:TextureTarget>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="ExternalizedProperty">
                                <MemberName>Value</MemberName>
                                <Name>GammaLut</Name>
                              </Expression>
                              <Expression xsi:type="PropertySource" TypeArguments="gl:LoadImage,sys:String">
                                <MemberName>FileName</MemberName>
                                <Value>GammaCalibration\calibration_data\RonanCottage_2p\230106\Scr2_gammalut_gray_average_table.bmp</Value>
                              </Expression>
                              <Expression xsi:type="InputMapping">
                                <PropertyMappings>
                                  <Property Name="FileName" />
                                </PropertyMappings>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:LoadImage">
                                  <gl:Width xsi:nil="true" />
                                  <gl:Height xsi:nil="true" />
                                  <gl:InternalFormat>Rgba</gl:InternalFormat>
                                  <gl:WrapS>ClampToEdge</gl:WrapS>
                                  <gl:WrapT>ClampToEdge</gl:WrapT>
                                  <gl:MinFilter>Linear</gl:MinFilter>
                                  <gl:MagFilter>Linear</gl:MagFilter>
                                  <gl:FileName>GammaCalibration\calibration_data\RonanCottage_2p\230106\Scr2_gammalut_gray_average_table.bmp</gl:FileName>
                                  <gl:ColorType>Unchanged</gl:ColorType>
                                  <gl:FlipMode>Vertical</gl:FlipMode>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:WithLatestFrom" />
                              </Expression>
                              <Expression xsi:type="MemberSelector">
                                <Selector>Item2</Selector>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:BindTexture">
                                  <gl:TextureSlot>Texture1</gl:TextureSlot>
                                  <gl:ShaderName>Gamma</gl:ShaderName>
                                  <gl:TextureTarget>Texture2D</gl:TextureTarget>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:DrawMesh">
                                  <gl:ShaderName>Gamma</gl:ShaderName>
                                  <gl:MeshName>ViewportQuad</gl:MeshName>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="WorkflowOutput" />
                            </Nodes>
                            <Edges>
                              <Edge From="0" To="1" Label="Source1" />
                              <Edge From="1" To="3" Label="Source1" />
                              <Edge From="2" To="3" Label="Source2" />
                              <Edge From="3" To="4" Label="Source1" />
                              <Edge From="4" To="9" Label="Source1" />
                              <Edge From="5" To="6" Label="Source1" />
                              <Edge From="6" To="7" Label="Source1" />
                              <Edge From="7" To="8" Label="Source1" />
                              <Edge From="8" To="9" Label="Source2" />
                              <Edge From="9" To="10" Label="Source1" />
                              <Edge From="10" To="11" Label="Source1" />
                              <Edge From="11" To="12" Label="Source1" />
                              <Edge From="12" To="13" Label="Source1" />
                            </Edges>
                          </Workflow>
                        </Expression>
                        <Expression xsi:type="IncludeWorkflow" Path="BonVision:Environment.DrawViewport.bonsai">
                          <X>0.25</X>
                          <Y>0</Y>
                          <Width>0.25</Width>
                          <Height>1</Height>
                        </Expression>
                        <Expression xsi:type="IncludeWorkflow" Path="BonVision:Environment.ViewWindow.bonsai">
                          <Width>29.296875</Width>
                          <Height>52.0833321</Height>
                          <Rotation>
                            <X>0.8307888</X>
                            <Y>24.29341</Y>
                            <Z>0.476700872</Z>
                          </Rotation>
                          <Translation>
                            <X>16.200000762939453</X>
                            <Y>0.51899999380111694</Y>
                            <Z>21.299999237060547</Z>
                          </Translation>
                        </Expression>
                        <Expression xsi:type="GroupWorkflow">
                          <Name>GammaCorrection</Name>
                          <Description>Renders the current scene to a texture and applies gamma correction as a post-processing effect.</Description>
                          <Workflow>
                            <Nodes>
                              <Expression xsi:type="WorkflowInput">
                                <Name>Source1</Name>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:UpdateViewportState">
                                  <gl:X>0</gl:X>
                                  <gl:Y>0</gl:Y>
                                  <gl:Width>1</gl:Width>
                                  <gl:Height>1</gl:Height>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="ExternalizedProperty">
                                <MemberName>ClearColor</MemberName>
                                <Name>ClearColor</Name>
                                <Category>Misc</Category>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:RenderTexture">
                                  <gl:RenderState />
                                  <gl:ClearColor>Gray</gl:ClearColor>
                                  <gl:ClearMask>DepthBufferBit ColorBufferBit</gl:ClearMask>
                                  <gl:Width xsi:nil="true" />
                                  <gl:Height xsi:nil="true" />
                                  <gl:InternalFormat>Rgb</gl:InternalFormat>
                                  <gl:WrapS>ClampToEdge</gl:WrapS>
                                  <gl:WrapT>ClampToEdge</gl:WrapT>
                                  <gl:MinFilter>Linear</gl:MinFilter>
                                  <gl:MagFilter>Linear</gl:MagFilter>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:BindTexture">
                                  <gl:TextureSlot>Texture0</gl:TextureSlot>
                                  <gl:ShaderName>Gamma</gl:ShaderName>
                                  <gl:TextureTarget>Texture2D</gl:TextureTarget>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="ExternalizedProperty">
                                <MemberName>Value</MemberName>
                                <Name>GammaLut</Name>
                              </Expression>
                              <Expression xsi:type="PropertySource" TypeArguments="gl:LoadImage,sys:String">
                                <MemberName>FileName</MemberName>
                                <Value>GammaCalibration\calibration_data\RonanCottage_2p\230106\Scr3_gammalut_gray_average_table.bmp</Value>
                              </Expression>
                              <Expression xsi:type="InputMapping">
                                <PropertyMappings>
                                  <Property Name="FileName" />
                                </PropertyMappings>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:LoadImage">
                                  <gl:Width xsi:nil="true" />
                                  <gl:Height xsi:nil="true" />
                                  <gl:InternalFormat>Rgba</gl:InternalFormat>
                                  <gl:WrapS>ClampToEdge</gl:WrapS>
                                  <gl:WrapT>ClampToEdge</gl:WrapT>
                                  <gl:MinFilter>Linear</gl:MinFilter>
                                  <gl:MagFilter>Linear</gl:MagFilter>
                                  <gl:FileName>GammaCalibration\calibration_data\RonanCottage_2p\230106\Scr3_gammalut_gray_average_table.bmp</gl:FileName>
                                  <gl:ColorType>Unchanged</gl:ColorType>
                                  <gl:FlipMode>Vertical</gl:FlipMode>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:WithLatestFrom" />
                              </Expression>
                              <Expression xsi:type="MemberSelector">
                                <Selector>Item2</Selector>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:BindTexture">
                                  <gl:TextureSlot>Texture1</gl:TextureSlot>
                                  <gl:ShaderName>Gamma</gl:ShaderName>
                                  <gl:TextureTarget>Texture2D</gl:TextureTarget>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:DrawMesh">
                                  <gl:ShaderName>Gamma</gl:ShaderName>
                                  <gl:MeshName>ViewportQuad</gl:MeshName>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="WorkflowOutput" />
                            </Nodes>
                            <Edges>
                              <Edge From="0" To="1" Label="Source1" />
                              <Edge From="1" To="3" Label="Source1" />
                              <Edge From="2" To="3" Label="Source2" />
                              <Edge From="3" To="4" Label="Source1" />
                              <Edge From="4" To="9" Label="Source1" />
                              <Edge From="5" To="6" Label="Source1" />
                              <Edge From="6" To="7" Label="Source1" />
                              <Edge From="7" To="8" Label="Source1" />
                              <Edge From="8" To="9" Label="Source2" />
                              <Edge From="9" To="10" Label="Source1" />
                              <Edge From="10" To="11" Label="Source1" />
                              <Edge From="11" To="12" Label="Source1" />
                              <Edge From="12" To="13" Label="Source1" />
                            </Edges>
                          </Workflow>
                        </Expression>
                        <Expression xsi:type="IncludeWorkflow" Path="BonVision:Environment.DrawViewport.bonsai">
                          <X>0.5</X>
                          <Y>0</Y>
                          <Width>0.25</Width>
                          <Height>1</Height>
                        </Expression>
                        <Expression xsi:type="IncludeWorkflow" Path="BonVision:Environment.ViewWindow.bonsai">
                          <Width>29.296875</Width>
                          <Height>52.0833321</Height>
                          <Rotation>
                            <X>0.46982540000000006</X>
                            <Y>91.10029</Y>
                            <Z>-0.10943494</Z>
                          </Rotation>
                          <Translation>
                            <X>29.5</X>
                            <Y>0.41800001263618469</Y>
                            <Z>-0.65100002288818359</Z>
                          </Translation>
                        </Expression>
                        <Expression xsi:type="GroupWorkflow">
                          <Name>GammaCorrection</Name>
                          <Description>Renders the current scene to a texture and applies gamma correction as a post-processing effect.</Description>
                          <Workflow>
                            <Nodes>
                              <Expression xsi:type="WorkflowInput">
                                <Name>Source1</Name>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:UpdateViewportState">
                                  <gl:X>0</gl:X>
                                  <gl:Y>0</gl:Y>
                                  <gl:Width>1</gl:Width>
                                  <gl:Height>1</gl:Height>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="ExternalizedProperty">
                                <MemberName>ClearColor</MemberName>
                                <Name>ClearColor</Name>
                                <Category>Misc</Category>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:RenderTexture">
                                  <gl:RenderState />
                                  <gl:ClearColor>Gray</gl:ClearColor>
                                  <gl:ClearMask>DepthBufferBit ColorBufferBit</gl:ClearMask>
                                  <gl:Width xsi:nil="true" />
                                  <gl:Height xsi:nil="true" />
                                  <gl:InternalFormat>Rgb</gl:InternalFormat>
                                  <gl:WrapS>ClampToEdge</gl:WrapS>
                                  <gl:WrapT>ClampToEdge</gl:WrapT>
                                  <gl:MinFilter>Linear</gl:MinFilter>
                                  <gl:MagFilter>Linear</gl:MagFilter>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:BindTexture">
                                  <gl:TextureSlot>Texture0</gl:TextureSlot>
                                  <gl:ShaderName>Gamma</gl:ShaderName>
                                  <gl:TextureTarget>Texture2D</gl:TextureTarget>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="ExternalizedProperty">
                                <MemberName>Value</MemberName>
                                <Name>GammaLut</Name>
                              </Expression>
                              <Expression xsi:type="PropertySource" TypeArguments="gl:LoadImage,sys:String">
                                <MemberName>FileName</MemberName>
                                <Value>GammaCalibration\calibration_data\RonanCottage_2p\230106\Scr4_gammalut_gray_average_table.bmp</Value>
                              </Expression>
                              <Expression xsi:type="InputMapping">
                                <PropertyMappings>
                                  <Property Name="FileName" />
                                </PropertyMappings>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:LoadImage">
                                  <gl:Width xsi:nil="true" />
                                  <gl:Height xsi:nil="true" />
                                  <gl:InternalFormat>Rgba</gl:InternalFormat>
                                  <gl:WrapS>ClampToEdge</gl:WrapS>
                                  <gl:WrapT>ClampToEdge</gl:WrapT>
                                  <gl:MinFilter>Linear</gl:MinFilter>
                                  <gl:MagFilter>Linear</gl:MagFilter>
                                  <gl:FileName>GammaCalibration\calibration_data\RonanCottage_2p\230106\Scr4_gammalut_gray_average_table.bmp</gl:FileName>
                                  <gl:ColorType>Unchanged</gl:ColorType>
                                  <gl:FlipMode>Vertical</gl:FlipMode>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:WithLatestFrom" />
                              </Expression>
                              <Expression xsi:type="MemberSelector">
                                <Selector>Item2</Selector>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:BindTexture">
                                  <gl:TextureSlot>Texture1</gl:TextureSlot>
                                  <gl:ShaderName>Gamma</gl:ShaderName>
                                  <gl:TextureTarget>Texture2D</gl:TextureTarget>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:DrawMesh">
                                  <gl:ShaderName>Gamma</gl:ShaderName>
                                  <gl:MeshName>ViewportQuad</gl:MeshName>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="WorkflowOutput" />
                            </Nodes>
                            <Edges>
                              <Edge From="0" To="1" Label="Source1" />
                              <Edge From="1" To="3" Label="Source1" />
                              <Edge From="2" To="3" Label="Source2" />
                              <Edge From="3" To="4" Label="Source1" />
                              <Edge From="4" To="9" Label="Source1" />
                              <Edge From="5" To="6" Label="Source1" />
                              <Edge From="6" To="7" Label="Source1" />
                              <Edge From="7" To="8" Label="Source1" />
                              <Edge From="8" To="9" Label="Source2" />
                              <Edge From="9" To="10" Label="Source1" />
                              <Edge From="10" To="11" Label="Source1" />
                              <Edge From="11" To="12" Label="Source1" />
                              <Edge From="12" To="13" Label="Source1" />
                            </Edges>
                          </Workflow>
                        </Expression>
                        <Expression xsi:type="IncludeWorkflow" Path="BonVision:Environment.DrawViewport.bonsai">
                          <X>0.75</X>
                          <Y>0</Y>
                          <Width>0.25</Width>
                          <Height>1</Height>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="rx:Zip" />
                        </Expression>
                        <Expression xsi:type="WorkflowOutput" />
                      </Nodes>
                      <Edges>
                        <Edge From="0" To="6" Label="Source2" />
                        <Edge From="1" To="2" Label="Source1" />
                        <Edge From="2" To="3" Label="Source1" />
                        <Edge From="3" To="4" Label="Source1" />
                        <Edge From="4" To="5" Label="Source1" />
                        <Edge From="5" To="6" Label="Source1" />
                        <Edge From="6" To="7" Label="Source1" />
                        <Edge From="6" To="10" Label="Source1" />
                        <Edge From="6" To="13" Label="Source1" />
                        <Edge From="6" To="16" Label="Source1" />
                        <Edge From="7" To="8" Label="Source1" />
                        <Edge From="8" To="9" Label="Source1" />
                        <Edge From="9" To="19" Label="Source1" />
                        <Edge From="10" To="11" Label="Source1" />
                        <Edge From="11" To="12" Label="Source1" />
                        <Edge From="12" To="19" Label="Source2" />
                        <Edge From="13" To="14" Label="Source1" />
                        <Edge From="14" To="15" Label="Source1" />
                        <Edge From="15" To="19" Label="Source3" />
                        <Edge From="16" To="17" Label="Source1" />
                        <Edge From="17" To="18" Label="Source1" />
                        <Edge From="18" To="19" Label="Source4" />
                        <Edge From="19" To="20" Label="Source1" />
                      </Edges>
                    </Workflow>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>EyeZ</Selector>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>EyeZ</Name>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>MouseZ</Selector>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>MouseZ</Name>
                  </Expression>
                </Nodes>
                <Edges>
                  <Edge From="0" To="1" Label="Source1" />
                  <Edge From="1" To="2" Label="Source1" />
                  <Edge From="2" To="3" Label="Source1" />
                  <Edge From="3" To="4" Label="Source1" />
                  <Edge From="4" To="5" Label="Source1" />
                  <Edge From="5" To="6" Label="Source1" />
                  <Edge From="7" To="15" Label="Source1" />
                  <Edge From="8" To="35" Label="Source2" />
                  <Edge From="9" To="17" Label="Source1" />
                  <Edge From="9" To="10" Label="Source1" />
                  <Edge From="10" To="11" Label="Source1" />
                  <Edge From="11" To="12" Label="Source1" />
                  <Edge From="12" To="20" Label="Source1" />
                  <Edge From="13" To="14" Label="Source1" />
                  <Edge From="14" To="15" Label="Source2" />
                  <Edge From="15" To="16" Label="Source1" />
                  <Edge From="16" To="17" Label="Source2" />
                  <Edge From="17" To="29" Label="Source1" />
                  <Edge From="18" To="19" Label="Source1" />
                  <Edge From="19" To="20" Label="Source2" />
                  <Edge From="20" To="21" Label="Source1" />
                  <Edge From="21" To="22" Label="Source1" />
                  <Edge From="22" To="24" Label="Source1" />
                  <Edge From="23" To="24" Label="Source2" />
                  <Edge From="24" To="25" Label="Source1" />
                  <Edge From="25" To="26" Label="Source1" />
                  <Edge From="27" To="29" Label="Source3" />
                  <Edge From="28" To="29" Label="Source2" />
                  <Edge From="29" To="30" Label="Source1" />
                  <Edge From="30" To="31" Label="Source1" />
                  <Edge From="31" To="32" Label="Source1" />
                  <Edge From="31" To="36" Label="Source1" />
                  <Edge From="31" To="38" Label="Source1" />
                  <Edge From="32" To="33" Label="Source1" />
                  <Edge From="33" To="34" Label="Source1" />
                  <Edge From="34" To="35" Label="Source1" />
                  <Edge From="36" To="37" Label="Source1" />
                  <Edge From="38" To="39" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="GroupWorkflow">
              <Name>GlobalTimer</Name>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:RenderFrame" />
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>TimeStep</Selector>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>ElapsedTime</Selector>
                  </Expression>
                  <Expression xsi:type="rx:Accumulate" />
                  <Expression xsi:type="BehaviorSubject">
                    <Name>GlobalElapsedTime</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:ElementIndex" />
                  </Expression>
                  <Expression xsi:type="PublishSubject">
                    <Name>Frames</Name>
                  </Expression>
                  <Expression xsi:type="WorkflowOutput" />
                </Nodes>
                <Edges>
                  <Edge From="0" To="1" Label="Source1" />
                  <Edge From="1" To="2" Label="Source1" />
                  <Edge From="2" To="3" Label="Source1" />
                  <Edge From="3" To="4" Label="Source1" />
                  <Edge From="4" To="5" Label="Source1" />
                  <Edge From="5" To="6" Label="Source1" />
                  <Edge From="6" To="7" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="GroupWorkflow">
              <Name>PhotodiodePlane MultiColor</Name>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>Draw</Name>
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="ScaleX" />
                    <Property Name="ScaleY" />
                    <Property Name="ScaleZ" />
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Value" DisplayName="PhotoquadX" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="FloatProperty">
                      <Value>-155</Value>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="num:DegreeToRadian" />
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Value" DisplayName="PhotoquadY" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="FloatProperty">
                      <Value>-40</Value>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="num:DegreeToRadian" />
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Value" DisplayName="PhotoquadZ" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="FloatProperty">
                      <Value>1</Value>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Zip" />
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Name>SphericalCoordinates</scr:Name>
                    <scr:Expression>new(
Item3 * Math.Cos(Item2) * Math.Cos(Item1) as X,
Item3 * Math.Sin(Item2) as Y,
Item3 * Math.Cos(Item2) * Math.Sin(Item1) as Z0
)</scr:Expression>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>X</Selector>
                  </Expression>
                  <Expression xsi:type="PropertyMapping">
                    <PropertyMappings>
                      <Property Name="TranslationX" />
                    </PropertyMappings>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Y</Selector>
                  </Expression>
                  <Expression xsi:type="PropertyMapping">
                    <PropertyMappings>
                      <Property Name="TranslationY" />
                    </PropertyMappings>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Z0</Selector>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>EyeZ</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:CombineLatest" />
                  </Expression>
                  <Expression xsi:type="Add" />
                  <Expression xsi:type="PropertyMapping">
                    <PropertyMappings>
                      <Property Name="TranslationZ" />
                    </PropertyMappings>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>FrameZ</Name>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>PhotoQuadColor</Selector>
                  </Expression>
                  <Expression xsi:type="PropertyMapping">
                    <PropertyMappings>
                      <Property Name="Ambient" />
                    </PropertyMappings>
                  </Expression>
                  <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.DrawModel.bonsai">
                    <TranslationX>-0.694272041</TranslationX>
                    <TranslationY>-0.642787635</TranslationY>
                    <TranslationZ>-0.323744357</TranslationZ>
                    <ScaleX>0.1</ScaleX>
                    <ScaleY>0.1</ScaleY>
                    <ScaleZ>0.1</ScaleZ>
                    <MeshName>Plane</MeshName>
                    <Ambient>
                      <X>1</X>
                      <Y>1</Y>
                      <Z>1</Z>
                    </Ambient>
                    <Diffuse>
                      <X>0</X>
                      <Y>0</Y>
                      <Z>0</Z>
                    </Diffuse>
                    <Specular>
                      <X>0</X>
                      <Y>0</Y>
                      <Z>0</Z>
                    </Specular>
                    <SpecularExponent>10</SpecularExponent>
                    <RotationZ>0</RotationZ>
                    <RotationY>90</RotationY>
                    <RotationX>0</RotationX>
                  </Expression>
                  <Expression xsi:type="WorkflowOutput" />
                </Nodes>
                <Edges>
                  <Edge From="0" To="24" Label="Source1" />
                  <Edge From="1" To="24" Label="Source6" />
                  <Edge From="2" To="3" Label="Source1" />
                  <Edge From="3" To="4" Label="Source1" />
                  <Edge From="4" To="10" Label="Source1" />
                  <Edge From="5" To="6" Label="Source1" />
                  <Edge From="6" To="7" Label="Source1" />
                  <Edge From="7" To="10" Label="Source2" />
                  <Edge From="8" To="9" Label="Source1" />
                  <Edge From="9" To="10" Label="Source3" />
                  <Edge From="10" To="11" Label="Source1" />
                  <Edge From="11" To="12" Label="Source1" />
                  <Edge From="11" To="14" Label="Source1" />
                  <Edge From="11" To="16" Label="Source1" />
                  <Edge From="12" To="13" Label="Source1" />
                  <Edge From="13" To="24" Label="Source3" />
                  <Edge From="14" To="15" Label="Source1" />
                  <Edge From="15" To="24" Label="Source4" />
                  <Edge From="16" To="18" Label="Source1" />
                  <Edge From="17" To="18" Label="Source2" />
                  <Edge From="18" To="19" Label="Source1" />
                  <Edge From="19" To="20" Label="Source1" />
                  <Edge From="20" To="24" Label="Source5" />
                  <Edge From="21" To="22" Label="Source1" />
                  <Edge From="22" To="23" Label="Source1" />
                  <Edge From="23" To="24" Label="Source2" />
                  <Edge From="24" To="25" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="GroupWorkflow">
              <Name>FrameLogger</Name>
              <Description>Frame &amp; Photodiode logger</Description>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>FrameZ</Name>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>FrameObject.TimeStep</Selector>
                  </Expression>
                  <Expression xsi:type="rx:Accumulate" />
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:ElementIndex" />
                  </Expression>
                  <Expression xsi:type="IncludeWorkflow" Path="Bonsai.Harp:WithLatestTimestamp.bonsai">
                    <Name>Timestamp</Name>
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Name>Rename</scr:Name>
                    <scr:Expression>new(
Timestamp as HarpTime,
Value.Value.ElapsedTime as ElapsedTime,
Value.Value.ElapsedRealTime as ElapsedRealTime)
</scr:Expression>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>ElapsedTime</Selector>
                  </Expression>
                  <Expression xsi:type="PublishSubject">
                    <Name>ElapsedTime</Name>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>ElapsedRealTime</Selector>
                  </Expression>
                  <Expression xsi:type="PublishSubject">
                    <Name>ElapsedRealTime</Name>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="MemberSelector">
                      <Selector>Index</Selector>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Zip" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:UpdateFrame" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:ElementIndex" />
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Name>Rename</scr:Name>
                    <scr:Expression>new(Index as UpdateFrameIndex)
</scr:Expression>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>UpdateFrameIndex</Selector>
                  </Expression>
                  <Expression xsi:type="PublishSubject">
                    <Name>UpdateFrameIndex</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>RootName</Name>
                  </Expression>
                  <Expression xsi:type="Format">
                    <Format>{0}\FrameLog.csv</Format>
                    <Selector>it</Selector>
                  </Expression>
                  <Expression xsi:type="PropertyMapping">
                    <PropertyMappings>
                      <Property Name="FileName" />
                    </PropertyMappings>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>photodiode</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:WithLatestFrom" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:WithLatestFrom" />
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Name>Rename</scr:Name>
                    <scr:Expression>new(
Item1.Item1.Item1.HarpTime as HarpTime,
Item1.Item1.Item2.FrameIndex as FrameIndex,
Item1.Item1.Item1.ElapsedTime as ElapsedTime,
Item1.Item1.Item1.ElapsedRealTime as ElapsedRealTime,
Item1.Item1.Item2.MouseZ as MouseZ,
Item1.Item1.Item2.EyeZ as EyeZ,
Item1.Item1.Item2.PhotoQuadColor as PhotoQuadColor,
Item1.Item1.Item2.SequenceIndex as SequenceIndex,
Item1.Item2 as PhotodiodeSignal,
Item2.UpdateFrameIndex as UpdateFrameIndex
)</scr:Expression>
                  </Expression>
                  <Expression xsi:type="io:CsvWriter">
                    <io:FileName>D:\data\Test\S20240821\R140249_SpheresPermTubeReward\\FrameLog.csv</io:FileName>
                    <io:Delimiter>,</io:Delimiter>
                    <io:Append>true</io:Append>
                    <io:Overwrite>false</io:Overwrite>
                    <io:Suffix>None</io:Suffix>
                    <io:IncludeHeader>true</io:IncludeHeader>
                  </Expression>
                </Nodes>
                <Edges>
                  <Edge From="0" To="1" Label="Source1" />
                  <Edge From="0" To="11" Label="Source2" />
                  <Edge From="1" To="2" Label="Source1" />
                  <Edge From="2" To="3" Label="Source1" />
                  <Edge From="3" To="4" Label="Source1" />
                  <Edge From="3" To="10" Label="Source1" />
                  <Edge From="4" To="5" Label="Source1" />
                  <Edge From="5" To="11" Label="Source1" />
                  <Edge From="5" To="6" Label="Source1" />
                  <Edge From="5" To="8" Label="Source1" />
                  <Edge From="6" To="7" Label="Source1" />
                  <Edge From="8" To="9" Label="Source1" />
                  <Edge From="11" To="21" Label="Source1" />
                  <Edge From="12" To="13" Label="Source1" />
                  <Edge From="13" To="14" Label="Source1" />
                  <Edge From="14" To="22" Label="Source2" />
                  <Edge From="14" To="15" Label="Source1" />
                  <Edge From="15" To="16" Label="Source1" />
                  <Edge From="17" To="18" Label="Source1" />
                  <Edge From="18" To="19" Label="Source1" />
                  <Edge From="19" To="24" Label="Source2" />
                  <Edge From="20" To="21" Label="Source2" />
                  <Edge From="21" To="22" Label="Source1" />
                  <Edge From="22" To="23" Label="Source1" />
                  <Edge From="23" To="24" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="GroupWorkflow">
              <Name>CopyFiles</Name>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Timer">
                      <rx:DueTime>PT1S</rx:DueTime>
                      <rx:Period>PT0S</rx:Period>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>RootName</Name>
                  </Expression>
                  <Expression xsi:type="Format">
                    <Format>{0}\SphereTube_fixed_spc.bonsai</Format>
                    <Selector>it</Selector>
                  </Expression>
                  <Expression xsi:type="PropertyMapping">
                    <PropertyMappings>
                      <Property Name="DestinationPath" />
                    </PropertyMappings>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="p1:CopyFile">
                      <p1:SourcePath>SphereTube_simplified.bonsai</p1:SourcePath>
                      <p1:DestinationPath>D:\data\Test\S20240821\R140249_SpheresPermTubeReward\\SphereTube_simplified_more_depths.bonsai</p1:DestinationPath>
                      <p1:Overwrite>false</p1:Overwrite>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="GroupWorkflow">
                    <Name>SphereTubeCopy</Name>
                    <Workflow>
                      <Nodes>
                        <Expression xsi:type="WorkflowInput">
                          <Name>Source1</Name>
                        </Expression>
                        <Expression xsi:type="WorkflowOutput" />
                      </Nodes>
                      <Edges>
                        <Edge From="0" To="1" Label="Source1" />
                      </Edges>
                    </Workflow>
                  </Expression>
                  <Expression xsi:type="WorkflowOutput" />
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Timer">
                      <rx:DueTime>PT1S</rx:DueTime>
                      <rx:Period>PT0S</rx:Period>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>RootName</Name>
                  </Expression>
                  <Expression xsi:type="Format">
                    <Format>{0}\random_sequence_5values_alternate.csv</Format>
                    <Selector>it</Selector>
                  </Expression>
                  <Expression xsi:type="PropertyMapping">
                    <PropertyMappings>
                      <Property Name="DestinationPath" />
                    </PropertyMappings>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="p1:CopyFile">
                      <p1:SourcePath>Extensions\random_sequence_5values_alternate.csv</p1:SourcePath>
                      <p1:DestinationPath>D:\data\Test\S20240821\R140249_SpheresPermTubeReward\\random_sequence_5values_alternate.csv</p1:DestinationPath>
                      <p1:Overwrite>false</p1:Overwrite>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="GroupWorkflow">
                    <Name>SequenceCopy</Name>
                    <Workflow>
                      <Nodes>
                        <Expression xsi:type="WorkflowInput">
                          <Name>Source1</Name>
                        </Expression>
                        <Expression xsi:type="WorkflowOutput" />
                      </Nodes>
                      <Edges>
                        <Edge From="0" To="1" Label="Source1" />
                      </Edges>
                    </Workflow>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Timer">
                      <rx:DueTime>PT1S</rx:DueTime>
                      <rx:Period>PT0S</rx:Period>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>RootName</Name>
                  </Expression>
                  <Expression xsi:type="Format">
                    <Format>{0}\TubeMapping_NewZ.cs</Format>
                    <Selector>it</Selector>
                  </Expression>
                  <Expression xsi:type="PropertyMapping">
                    <PropertyMappings>
                      <Property Name="DestinationPath" />
                    </PropertyMappings>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="p1:CopyFile">
                      <p1:SourcePath>Extensions\TubeMapping_NewZ.cs</p1:SourcePath>
                      <p1:DestinationPath>D:\data\Test\S20240821\R140249_SpheresPermTubeReward\\TubeMapping_NewZ.cs</p1:DestinationPath>
                      <p1:Overwrite>false</p1:Overwrite>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="GroupWorkflow">
                    <Name>TubeMappingCopy</Name>
                    <Workflow>
                      <Nodes>
                        <Expression xsi:type="WorkflowInput">
                          <Name>Source1</Name>
                        </Expression>
                        <Expression xsi:type="WorkflowOutput" />
                      </Nodes>
                      <Edges>
                        <Edge From="0" To="1" Label="Source1" />
                      </Edges>
                    </Workflow>
                  </Expression>
                </Nodes>
                <Edges>
                  <Edge From="0" To="4" Label="Source1" />
                  <Edge From="1" To="2" Label="Source1" />
                  <Edge From="2" To="3" Label="Source1" />
                  <Edge From="3" To="4" Label="Source2" />
                  <Edge From="4" To="5" Label="Source1" />
                  <Edge From="5" To="6" Label="Source1" />
                  <Edge From="7" To="11" Label="Source1" />
                  <Edge From="8" To="9" Label="Source1" />
                  <Edge From="9" To="10" Label="Source1" />
                  <Edge From="10" To="11" Label="Source2" />
                  <Edge From="11" To="12" Label="Source1" />
                  <Edge From="13" To="17" Label="Source1" />
                  <Edge From="14" To="15" Label="Source1" />
                  <Edge From="15" To="16" Label="Source1" />
                  <Edge From="16" To="17" Label="Source2" />
                  <Edge From="17" To="18" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="GroupWorkflow">
              <Name>Floor</Name>
              <Description />
              <Workflow>
                <Nodes>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Value" DisplayName="FloorLength" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="FloatProperty">
                      <Value>200</Value>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>FloorLength</Name>
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Value" DisplayName="TextureName" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="StringProperty">
                      <Value>highf_Y_plaid</Value>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="PropertyMapping">
                    <PropertyMappings>
                      <Property Name="TextureName" />
                    </PropertyMappings>
                  </Expression>
                  <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.ParameterRange.bonsai">
                    <RangeMin>1</RangeMin>
                    <RangeMax>3</RangeMax>
                    <Count>3</Count>
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="FloorWidth" />
                    <Property Name="FloorHeight" />
                  </Expression>
                  <Expression xsi:type="CreateObservable">
                    <Name>CreateFloors</Name>
                    <Description />
                    <Workflow>
                      <Nodes>
                        <Expression xsi:type="WorkflowInput">
                          <Name>Source1</Name>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject">
                          <Name>FloorNumber</Name>
                        </Expression>
                        <Expression xsi:type="Subtract">
                          <Operand xsi:type="IntProperty">
                            <Value>2</Value>
                          </Operand>
                        </Expression>
                        <Expression xsi:type="SubscribeSubject">
                          <Name>FloorLength</Name>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="rx:Zip" />
                        </Expression>
                        <Expression xsi:type="Multiply" />
                        <Expression xsi:type="BehaviorSubject">
                          <Name>Floor Initial Z</Name>
                        </Expression>
                        <Expression xsi:type="SubscribeSubject">
                          <Name>Draw</Name>
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="TextureName" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:BindTexture">
                            <gl:TextureSlot>Texture0</gl:TextureSlot>
                            <gl:ShaderName>TexturedModel</gl:ShaderName>
                            <gl:TextureName>highf_Y_plaid</gl:TextureName>
                            <gl:TextureTarget>Texture2D</gl:TextureTarget>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="SubscribeSubject">
                          <Name>MouseZ</Name>
                        </Expression>
                        <Expression xsi:type="SubscribeSubject">
                          <Name>FloorLength</Name>
                        </Expression>
                        <Expression xsi:type="SubscribeSubject">
                          <Name>FloorNumber</Name>
                        </Expression>
                        <Expression xsi:type="SubscribeSubject">
                          <Name>Floor Initial Z</Name>
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="Value" DisplayName="FloorWidth" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="FloatProperty">
                            <Value>5</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="Value" DisplayName="FloorHeight" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="FloatProperty">
                            <Value>-2.5</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="rx:CombineLatest" />
                        </Expression>
                        <Expression xsi:type="scr:ExpressionTransform">
                          <scr:Expression>new(
(Math.Floor((Item1/Item3+3-Item2)/3))*(Item3*3)+Item4 as TranslationZ,
Item3 as FloorLength,
Item5 as FloorWidth,
Item6 as FloorHeight
)</scr:Expression>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="rx:WithLatestFrom" />
                        </Expression>
                        <Expression xsi:type="InputMapping">
                          <PropertyMappings>
                            <Property Name="TranslationZ" Selector="Item2.TranslationZ" />
                            <Property Name="ScaleY" Selector="Item2.FloorLength" />
                            <Property Name="ScaleX" Selector="Item2.FloorWidth" />
                            <Property Name="TranslationY" Selector="Item2.FloorHeight" />
                          </PropertyMappings>
                          <Selector>Item1</Selector>
                        </Expression>
                        <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.DrawTexturedModel.bonsai">
                          <TranslationX>0</TranslationX>
                          <TranslationY>-0.5</TranslationY>
                          <TranslationZ>200</TranslationZ>
                          <ScaleX>5</ScaleX>
                          <ScaleY>200</ScaleY>
                          <ScaleZ>0</ScaleZ>
                          <MeshName>Plane</MeshName>
                          <Ambient>
                            <X>0.5</X>
                            <Y>0.5</Y>
                            <Z>0.5</Z>
                          </Ambient>
                          <Diffuse>
                            <X>1</X>
                            <Y>1</Y>
                            <Z>1</Z>
                          </Diffuse>
                          <Specular>
                            <X>1</X>
                            <Y>1</Y>
                            <Z>1</Z>
                          </Specular>
                          <SpecularExponent>10</SpecularExponent>
                          <RotationZ>0</RotationZ>
                          <RotationY>0</RotationY>
                          <RotationX>-90</RotationX>
                        </Expression>
                        <Expression xsi:type="WorkflowOutput" />
                      </Nodes>
                      <Edges>
                        <Edge From="0" To="1" Label="Source1" />
                        <Edge From="1" To="2" Label="Source1" />
                        <Edge From="2" To="4" Label="Source1" />
                        <Edge From="3" To="4" Label="Source2" />
                        <Edge From="4" To="5" Label="Source1" />
                        <Edge From="5" To="6" Label="Source1" />
                        <Edge From="7" To="9" Label="Source1" />
                        <Edge From="8" To="9" Label="Source2" />
                        <Edge From="9" To="20" Label="Source1" />
                        <Edge From="10" To="18" Label="Source1" />
                        <Edge From="11" To="18" Label="Source3" />
                        <Edge From="12" To="18" Label="Source2" />
                        <Edge From="13" To="18" Label="Source4" />
                        <Edge From="14" To="15" Label="Source1" />
                        <Edge From="15" To="18" Label="Source5" />
                        <Edge From="16" To="17" Label="Source1" />
                        <Edge From="17" To="18" Label="Source6" />
                        <Edge From="18" To="19" Label="Source1" />
                        <Edge From="19" To="20" Label="Source2" />
                        <Edge From="20" To="21" Label="Source1" />
                        <Edge From="21" To="22" Label="Source1" />
                        <Edge From="22" To="23" Label="Source1" />
                      </Edges>
                    </Workflow>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Merge" />
                  </Expression>
                </Nodes>
                <Edges>
                  <Edge From="0" To="1" Label="Source1" />
                  <Edge From="1" To="2" Label="Source1" />
                  <Edge From="3" To="4" Label="Source1" />
                  <Edge From="4" To="5" Label="Source1" />
                  <Edge From="5" To="8" Label="Source2" />
                  <Edge From="6" To="8" Label="Source1" />
                  <Edge From="7" To="8" Label="Source3" />
                  <Edge From="8" To="9" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="IncludeWorkflow" Path="Extensions\ManualReward.bonsai">
              <RewardDuration>500</RewardDuration>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="BooleanProperty">
                <Value>false</Value>
              </Combinator>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="wie:KeyDown">
                <wie:Filter>MButton D Control Alt</wie:Filter>
                <wie:SuppressRepetitions>true</wie:SuppressRepetitions>
              </Combinator>
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>SaveTimestamp</Name>
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>SaveDate</Name>
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>Metadata</Name>
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>WhichExp</Name>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:Zip" />
            </Expression>
            <Expression xsi:type="Format">
              <Format>{0}\S{1}\R{2}_{3}</Format>
              <Selector>Item1.Animal,Item2,Item3,Item4</Selector>
            </Expression>
            <Expression xsi:type="osc:SendMessage">
              <osc:Connection>UdpSend</osc:Connection>
              <osc:Address>/si_fname</osc:Address>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:Zip" />
            </Expression>
            <Expression xsi:type="SelectMany">
              <Name>Spheres Close &amp; Open</Name>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="WorkflowInput">
                    <Name>Source1</Name>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>StartTrigger</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="BooleanProperty">
                      <Value>false</Value>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>NewSphereTrigger</Name>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="MulticastSubject">
                      <Name>Reward</Name>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="ThetaMin" />
                    <Property Name="ThetaMax" />
                    <Property Name="TakeThetaNum" />
                    <Property Name="RadiusMax" />
                    <Property Name="RadiusMin" />
                    <Property Name="RadiusLogBase" />
                    <Property Name="ZoScaleK" />
                    <Property Name="TubeLenth" />
                    <Property Name="TubeSpacing" />
                    <Property Name="InvisibleAngle" />
                    <Property Name="ExtraSpheresBehind" Category="ZoPosition" />
                    <Property Name="ZoMin" Category="ZoPosition" />
                    <Property Name="ThetaMinLim" Category="ThetaPosition" />
                    <Property Name="ThetaMaxLim" Category="ThetaPosition" />
                    <Property Name="FadeTime" />
                    <Property Name="RewardProb" />
                  </Expression>
                  <Expression xsi:type="GroupWorkflow">
                    <Name>ParamSettings</Name>
                    <Workflow>
                      <Nodes>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="Value" DisplayName="ExtraSpheresBehind" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="IntProperty">
                            <Value>5</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject">
                          <Name>ExtraSpheresBehind</Name>
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="Value" DisplayName="ThetaMin" Category="ThetaPosition" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="FloatProperty">
                            <Value>-40</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject">
                          <Name>ThetaMin</Name>
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="Value" DisplayName="ThetaMax" Category="ThetaPosition" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="FloatProperty">
                            <Value>220</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject">
                          <Name>ThetaMax</Name>
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="Value" DisplayName="ThetaMinLim" Category="ThetaPosition" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="FloatProperty">
                            <Value>40</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject">
                          <Name>ThetaMinLim</Name>
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="Value" DisplayName="ThetaMaxLim" Category="ThetaPosition" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="FloatProperty">
                            <Value>140</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject">
                          <Name>ThetaMaxLim</Name>
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="Value" DisplayName="TakeThetaNum" Category="ThetaPosition" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="IntProperty">
                            <Value>1</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject">
                          <Name>TakeThetaNum</Name>
                        </Expression>
                        <Expression xsi:type="Disable">
                          <Builder xsi:type="SubscribeSubject">
                            <Name>ExtraSpheresBehind</Name>
                          </Builder>
                        </Expression>
                        <Expression xsi:type="Disable">
                          <Builder xsi:type="SubscribeSubject">
                            <Name>TubeSpacing</Name>
                          </Builder>
                        </Expression>
                        <Expression xsi:type="Disable">
                          <Builder xsi:type="Combinator">
                            <Combinator xsi:type="rx:CombineLatest" />
                          </Builder>
                        </Expression>
                        <Expression xsi:type="Disable">
                          <Builder xsi:type="Multiply" />
                        </Expression>
                        <Expression xsi:type="Disable">
                          <Builder xsi:type="Negate" />
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="Value" DisplayName="ZoMin" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="FloatProperty">
                            <Value>0</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject">
                          <Name>ZoMin</Name>
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="Value" DisplayName="TubeLenth" Category="ZoPosition" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="FloatProperty">
                            <Value>600</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject">
                          <Name>TubeLength</Name>
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="Value" DisplayName="RadiusMax" Category="RadiusPosition" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="FloatProperty">
                            <Value>640</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject">
                          <Name>RadiusMax</Name>
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="Value" DisplayName="RadiusLogBase" Category="RadiusPosition" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="FloatProperty">
                            <Value>10</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject">
                          <Name>RadiusLogBase</Name>
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="Value" DisplayName="TubeSpacing" Category="ZoPosition" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="FloatProperty">
                            <Value>3</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject">
                          <Name>TubeSpacing</Name>
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="Value" DisplayName="ZoScaleK" Category="ZoPosition" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="FloatProperty">
                            <Value>20</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject">
                          <Name>ZoScaleK</Name>
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="Value" DisplayName="InvisibleAngle" Category="ZoPosition" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="FloatProperty">
                            <Value>20</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject">
                          <Name>InvisibleAngle</Name>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="num:DegreeToRadian" />
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="Value" DisplayName="RadiusMin" Category="RadiusPosition" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="FloatProperty">
                            <Value>5</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject">
                          <Name>RadiusMin</Name>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="rx:Zip" />
                        </Expression>
                        <Expression xsi:type="scr:ExpressionTransform">
                          <scr:Expression>Math.Floor(Item1/Math.Tan(Item2)/(Item3*Item1/item4))</scr:Expression>
                        </Expression>
                        <Expression xsi:type="Add">
                          <Operand xsi:type="DoubleProperty">
                            <Value>1</Value>
                          </Operand>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject">
                          <Name>SphereNumPerMoment</Name>
                        </Expression>
                        <Expression xsi:type="Disable">
                          <Builder xsi:type="ExternalizedMapping">
                            <Property Name="Value" DisplayName="ExtraSpheresFront" />
                          </Builder>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="IntProperty">
                            <Value>0</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="rx:CombineLatest" />
                        </Expression>
                        <Expression xsi:type="Add" />
                        <Expression xsi:type="BehaviorSubject">
                          <Name>ExtraSpheresFront</Name>
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="Value" DisplayName="FadeTime" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="FloatProperty">
                            <Value>0.3</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject">
                          <Name>FadeTime</Name>
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="Value" DisplayName="RewardProb" Category="Reward" />
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="FloatProperty">
                            <Value>0.7</Value>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject">
                          <Name>RewardProb</Name>
                        </Expression>
                      </Nodes>
                      <Edges>
                        <Edge From="0" To="1" Label="Source1" />
                        <Edge From="1" To="2" Label="Source1" />
                        <Edge From="3" To="4" Label="Source1" />
                        <Edge From="4" To="5" Label="Source1" />
                        <Edge From="6" To="7" Label="Source1" />
                        <Edge From="7" To="8" Label="Source1" />
                        <Edge From="9" To="10" Label="Source1" />
                        <Edge From="10" To="11" Label="Source1" />
                        <Edge From="12" To="13" Label="Source1" />
                        <Edge From="13" To="14" Label="Source1" />
                        <Edge From="15" To="16" Label="Source1" />
                        <Edge From="16" To="17" Label="Source1" />
                        <Edge From="18" To="20" Label="Source1" />
                        <Edge From="19" To="20" Label="Source2" />
                        <Edge From="20" To="21" Label="Source1" />
                        <Edge From="21" To="22" Label="Source1" />
                        <Edge From="22" To="24" Label="Source1" />
                        <Edge From="23" To="24" Label="Source2" />
                        <Edge From="24" To="25" Label="Source1" />
                        <Edge From="26" To="27" Label="Source1" />
                        <Edge From="27" To="28" Label="Source1" />
                        <Edge From="29" To="30" Label="Source1" />
                        <Edge From="30" To="31" Label="Source1" />
                        <Edge From="32" To="33" Label="Source1" />
                        <Edge From="33" To="34" Label="Source1" />
                        <Edge From="35" To="36" Label="Source1" />
                        <Edge From="36" To="37" Label="Source1" />
                        <Edge From="37" To="48" Label="Source3" />
                        <Edge From="38" To="39" Label="Source1" />
                        <Edge From="39" To="40" Label="Source1" />
                        <Edge From="40" To="48" Label="Source4" />
                        <Edge From="41" To="42" Label="Source1" />
                        <Edge From="42" To="43" Label="Source1" />
                        <Edge From="43" To="44" Label="Source1" />
                        <Edge From="44" To="48" Label="Source2" />
                        <Edge From="45" To="46" Label="Source1" />
                        <Edge From="46" To="47" Label="Source1" />
                        <Edge From="47" To="48" Label="Source1" />
                        <Edge From="48" To="49" Label="Source1" />
                        <Edge From="49" To="50" Label="Source1" />
                        <Edge From="50" To="51" Label="Source1" />
                        <Edge From="51" To="54" Label="Source2" />
                        <Edge From="52" To="53" Label="Source1" />
                        <Edge From="53" To="54" Label="Source1" />
                        <Edge From="54" To="55" Label="Source1" />
                        <Edge From="55" To="56" Label="Source1" />
                        <Edge From="57" To="58" Label="Source1" />
                        <Edge From="58" To="59" Label="Source1" />
                        <Edge From="60" To="61" Label="Source1" />
                        <Edge From="61" To="62" Label="Source1" />
                      </Edges>
                    </Workflow>
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="DueTime" DisplayName="InitialDelay" Category="Timings" />
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Size" />
                    <Property Name="NewSphereTriggerThreshold" />
                    <Property Name="RewardDelay" Category="Reward" />
                    <Property Name="BackgroundColor" />
                    <Property Name="TargetAmb" />
                  </Expression>
                  <Expression xsi:type="GroupWorkflow">
                    <Name>SpheresClose</Name>
                    <Description>Depth is in log10 space.</Description>
                    <Workflow>
                      <Nodes>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="Size" />
                          <Property Name="DistanceBehind" Category="TrialCondition" />
                          <Property Name="NewSphereTriggerThreshold" />
                          <Property Name="RewardDelay" />
                        </Expression>
                        <Expression xsi:type="GroupWorkflow">
                          <Name>ManageSphereParams</Name>
                          <Workflow>
                            <Nodes>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>RepeatNumber</Name>
                              </Expression>
                              <Expression xsi:type="PropertyMapping">
                                <PropertyMappings>
                                  <Property Name="Count" />
                                </PropertyMappings>
                              </Expression>
                              <Expression xsi:type="GroupWorkflow">
                                <Name>RadiusRange</Name>
                                <Workflow>
                                  <Nodes>
                                    <Expression xsi:type="SubscribeSubject">
                                      <Name>DepthCount</Name>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="IntProperty">
                                        <Value>8</Value>
                                      </Combinator>
                                    </Expression>
                                    <Expression xsi:type="SubscribeSubject">
                                      <Name>RadiusMin</Name>
                                    </Expression>
                                    <Expression xsi:type="SubscribeSubject">
                                      <Name>RadiusMax</Name>
                                    </Expression>
                                    <Expression xsi:type="SubscribeSubject">
                                      <Name>RadiusLogBase</Name>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:Zip" />
                                    </Expression>
                                    <Expression xsi:type="scr:ExpressionTransform">
                                      <scr:Name>Log</scr:Name>
                                      <scr:Expression>new(
Math.Log(Item1,Item4) as Min,
Math.Log(Item2,Item4) as Max,
Item3 as Count
)</scr:Expression>
                                    </Expression>
                                    <Expression xsi:type="MemberSelector">
                                      <Selector>Min</Selector>
                                    </Expression>
                                    <Expression xsi:type="PropertyMapping">
                                      <PropertyMappings>
                                        <Property Name="RangeMin" />
                                      </PropertyMappings>
                                    </Expression>
                                    <Expression xsi:type="MemberSelector">
                                      <Selector>Max</Selector>
                                    </Expression>
                                    <Expression xsi:type="PropertyMapping">
                                      <PropertyMappings>
                                        <Property Name="RangeMax" />
                                      </PropertyMappings>
                                    </Expression>
                                    <Expression xsi:type="MemberSelector">
                                      <Selector>Count</Selector>
                                    </Expression>
                                    <Expression xsi:type="PropertyMapping">
                                      <PropertyMappings>
                                        <Property Name="Count" />
                                      </PropertyMappings>
                                    </Expression>
                                    <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.ParameterRange.bonsai">
                                      <RangeMin>0.69897000433601875</RangeMin>
                                      <RangeMax>2.8061799739838866</RangeMax>
                                      <Count>8</Count>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:WithLatestFrom" />
                                    </Expression>
                                    <Expression xsi:type="scr:ExpressionTransform">
                                      <scr:Name>Power</scr:Name>
                                      <scr:Expression>Math.Pow(Item2,Item1)</scr:Expression>
                                    </Expression>
                                    <Expression xsi:type="SubscribeSubject">
                                      <Name>Seed</Name>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="num:Permutation" />
                                    </Expression>
                                    <Expression xsi:type="WorkflowOutput" />
                                  </Nodes>
                                  <Edges>
                                    <Edge From="0" To="1" Label="Source1" />
                                    <Edge From="1" To="5" Label="Source3" />
                                    <Edge From="2" To="5" Label="Source1" />
                                    <Edge From="3" To="5" Label="Source2" />
                                    <Edge From="4" To="5" Label="Source4" />
                                    <Edge From="4" To="14" Label="Source2" />
                                    <Edge From="5" To="6" Label="Source1" />
                                    <Edge From="6" To="7" Label="Source1" />
                                    <Edge From="6" To="9" Label="Source1" />
                                    <Edge From="6" To="11" Label="Source1" />
                                    <Edge From="7" To="8" Label="Source1" />
                                    <Edge From="8" To="13" Label="Source1" />
                                    <Edge From="9" To="10" Label="Source1" />
                                    <Edge From="10" To="13" Label="Source2" />
                                    <Edge From="11" To="12" Label="Source1" />
                                    <Edge From="12" To="13" Label="Source3" />
                                    <Edge From="13" To="14" Label="Source1" />
                                    <Edge From="14" To="15" Label="Source1" />
                                    <Edge From="15" To="17" Label="Source1" />
                                    <Edge From="16" To="17" Label="Source2" />
                                    <Edge From="17" To="18" Label="Source1" />
                                  </Edges>
                                </Workflow>
                              </Expression>
                              <Expression xsi:type="ExternalizedMapping">
                                <Property Name="DistanceBehind" />
                                <Property Name="NewSphereTriggerThreshold" />
                                <Property Name="RewardDelay" />
                              </Expression>
                              <Expression xsi:type="CreateObservable">
                                <Name>Theta &amp; Zo Range</Name>
                                <Workflow>
                                  <Nodes>
                                    <Expression xsi:type="WorkflowInput">
                                      <Name>Source1</Name>
                                    </Expression>
                                    <Expression xsi:type="MulticastSubject">
                                      <Name>ThisDepth</Name>
                                    </Expression>
                                    <Expression xsi:type="MulticastSubject">
                                      <Name>StartTriggerOut</Name>
                                    </Expression>
                                    <Expression xsi:type="GroupWorkflow">
                                      <Name>Total SphereNum PerTube</Name>
                                      <Workflow>
                                        <Nodes>
                                          <Expression xsi:type="GroupWorkflow">
                                            <Name>Same Physical TubeLength</Name>
                                            <Workflow>
                                              <Nodes>
                                                <Expression xsi:type="SubscribeSubject">
                                                  <Name>ThisDepth</Name>
                                                </Expression>
                                                <Expression xsi:type="SubscribeSubject">
                                                  <Name>TubeSpacing</Name>
                                                </Expression>
                                                <Expression xsi:type="SubscribeSubject">
                                                  <Name>TubeLength</Name>
                                                </Expression>
                                                <Expression xsi:type="SubscribeSubject">
                                                  <Name>ZoScaleK</Name>
                                                </Expression>
                                                <Expression xsi:type="Combinator">
                                                  <Combinator xsi:type="rx:CombineLatest" />
                                                </Expression>
                                                <Expression xsi:type="scr:ExpressionTransform">
                                                  <scr:Expression>Item2*Item1/Item3</scr:Expression>
                                                </Expression>
                                                <Expression xsi:type="MulticastSubject">
                                                  <Name>ZoSpacing</Name>
                                                </Expression>
                                                <Expression xsi:type="Combinator">
                                                  <Combinator xsi:type="rx:Zip" />
                                                </Expression>
                                                <Expression xsi:type="scr:ExpressionTransform">
                                                  <scr:Expression>Math.Round(Item1/Item2)</scr:Expression>
                                                </Expression>
                                                <Expression xsi:type="BehaviorSubject">
                                                  <Name>TakeZoNum</Name>
                                                </Expression>
                                                <Expression xsi:type="WorkflowOutput" />
                                              </Nodes>
                                              <Edges>
                                                <Edge From="0" To="4" Label="Source1" />
                                                <Edge From="1" To="4" Label="Source2" />
                                                <Edge From="2" To="7" Label="Source1" />
                                                <Edge From="3" To="4" Label="Source3" />
                                                <Edge From="4" To="5" Label="Source1" />
                                                <Edge From="5" To="6" Label="Source1" />
                                                <Edge From="6" To="7" Label="Source2" />
                                                <Edge From="7" To="8" Label="Source1" />
                                                <Edge From="8" To="9" Label="Source1" />
                                                <Edge From="9" To="10" Label="Source1" />
                                              </Edges>
                                            </Workflow>
                                          </Expression>
                                          <Expression xsi:type="WorkflowOutput" />
                                          <Expression xsi:type="Disable">
                                            <Builder xsi:type="GroupWorkflow">
                                              <Name>Same Projected TubeLength</Name>
                                              <Workflow>
                                                <Nodes>
                                                  <Expression xsi:type="SubscribeSubject">
                                                    <Name>ThisDepth</Name>
                                                  </Expression>
                                                  <Expression xsi:type="SubscribeSubject">
                                                    <Name>TubeSpacing</Name>
                                                  </Expression>
                                                  <Expression xsi:type="SubscribeSubject">
                                                    <Name>TubeLength</Name>
                                                  </Expression>
                                                  <Expression xsi:type="SubscribeSubject">
                                                    <Name>ThisDepth</Name>
                                                  </Expression>
                                                  <Expression xsi:type="SubscribeSubject">
                                                    <Name>ZoScaleK</Name>
                                                  </Expression>
                                                  <Expression xsi:type="Combinator">
                                                    <Combinator xsi:type="rx:CombineLatest" />
                                                  </Expression>
                                                  <Expression xsi:type="scr:ExpressionTransform">
                                                    <scr:Expression>Item1 * Item2 / Item3</scr:Expression>
                                                  </Expression>
                                                  <Expression xsi:type="SubscribeSubject">
                                                    <Name>ZoScaleK</Name>
                                                  </Expression>
                                                  <Expression xsi:type="Combinator">
                                                    <Combinator xsi:type="rx:CombineLatest" />
                                                  </Expression>
                                                  <Expression xsi:type="scr:ExpressionTransform">
                                                    <scr:Expression>Item2*Item1/Item3</scr:Expression>
                                                  </Expression>
                                                  <Expression xsi:type="MulticastSubject">
                                                    <Name>ZoSpacing</Name>
                                                  </Expression>
                                                  <Expression xsi:type="Combinator">
                                                    <Combinator xsi:type="rx:Zip" />
                                                  </Expression>
                                                  <Expression xsi:type="scr:ExpressionTransform">
                                                    <scr:Expression>Math.Round(Item1/Item2)</scr:Expression>
                                                  </Expression>
                                                  <Expression xsi:type="BehaviorSubject">
                                                    <Name>TakeZoNum</Name>
                                                  </Expression>
                                                  <Expression xsi:type="WorkflowOutput" />
                                                </Nodes>
                                                <Edges>
                                                  <Edge From="0" To="8" Label="Source1" />
                                                  <Edge From="1" To="8" Label="Source2" />
                                                  <Edge From="2" To="5" Label="Source1" />
                                                  <Edge From="3" To="5" Label="Source2" />
                                                  <Edge From="4" To="5" Label="Source3" />
                                                  <Edge From="5" To="6" Label="Source1" />
                                                  <Edge From="6" To="11" Label="Source1" />
                                                  <Edge From="7" To="8" Label="Source3" />
                                                  <Edge From="8" To="9" Label="Source1" />
                                                  <Edge From="9" To="10" Label="Source1" />
                                                  <Edge From="10" To="11" Label="Source2" />
                                                  <Edge From="11" To="12" Label="Source1" />
                                                  <Edge From="12" To="13" Label="Source1" />
                                                  <Edge From="13" To="14" Label="Source1" />
                                                </Edges>
                                              </Workflow>
                                            </Builder>
                                          </Expression>
                                          <Expression xsi:type="BehaviorSubject" TypeArguments="sys:Double">
                                            <Name>ZoSpacing</Name>
                                          </Expression>
                                        </Nodes>
                                        <Edges>
                                          <Edge From="0" To="1" Label="Source1" />
                                        </Edges>
                                      </Workflow>
                                    </Expression>
                                    <Expression xsi:type="PropertyMapping">
                                      <PropertyMappings>
                                        <Property Name="Count" />
                                      </PropertyMappings>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:Range">
                                        <rx:Start>0</rx:Start>
                                        <rx:Count>25</rx:Count>
                                      </Combinator>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="BooleanProperty">
                                        <Value>false</Value>
                                      </Combinator>
                                    </Expression>
                                    <Expression xsi:type="Disable">
                                      <Builder xsi:type="SubscribeSubject">
                                        <Name>NewSphereTrigger</Name>
                                      </Builder>
                                    </Expression>
                                    <Expression xsi:type="Disable">
                                      <Builder xsi:type="Combinator">
                                        <Combinator xsi:type="rx:Merge" />
                                      </Builder>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:ElementIndex" />
                                    </Expression>
                                    <Expression xsi:type="MemberSelector">
                                      <Selector>Index</Selector>
                                    </Expression>
                                    <Expression xsi:type="SelectMany">
                                      <Workflow>
                                        <Nodes>
                                          <Expression xsi:type="WorkflowInput">
                                            <Name>Source1</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Take">
                                              <rx:Count>1</rx:Count>
                                            </Combinator>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ZoSpacing</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:CombineLatest" />
                                          </Expression>
                                          <Expression xsi:type="Multiply" />
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>TrialMouseZ</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:CombineLatest" />
                                          </Expression>
                                          <Expression xsi:type="scr:ExpressionCondition">
                                            <scr:Expression>(Item2 &gt;= Item1)</scr:Expression>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Take">
                                              <rx:Count>1</rx:Count>
                                            </Combinator>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="BooleanProperty">
                                              <Value>false</Value>
                                            </Combinator>
                                          </Expression>
                                          <Expression xsi:type="MulticastSubject">
                                            <Name>NewSphereTrigger</Name>
                                          </Expression>
                                          <Expression xsi:type="WorkflowOutput" />
                                        </Nodes>
                                        <Edges>
                                          <Edge From="0" To="1" Label="Source1" />
                                          <Edge From="1" To="3" Label="Source1" />
                                          <Edge From="2" To="3" Label="Source2" />
                                          <Edge From="3" To="4" Label="Source1" />
                                          <Edge From="4" To="6" Label="Source1" />
                                          <Edge From="5" To="6" Label="Source2" />
                                          <Edge From="6" To="7" Label="Source1" />
                                          <Edge From="7" To="8" Label="Source1" />
                                          <Edge From="8" To="9" Label="Source1" />
                                          <Edge From="9" To="10" Label="Source1" />
                                          <Edge From="10" To="11" Label="Source1" />
                                        </Edges>
                                      </Workflow>
                                    </Expression>
                                    <Expression xsi:type="SubscribeSubject">
                                      <Name>EndThisTrial</Name>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:TakeUntil" />
                                    </Expression>
                                    <Expression xsi:type="SubscribeSubject">
                                      <Name>TubeLength</Name>
                                    </Expression>
                                    <Expression xsi:type="BehaviorSubject">
                                      <Name>ZoMax</Name>
                                    </Expression>
                                    <Expression xsi:type="SubscribeSubject">
                                      <Name>InterTrialDelay</Name>
                                    </Expression>
                                    <Expression xsi:type="BehaviorSubject" TypeArguments="sys:Double">
                                      <Name>Depth</Name>
                                    </Expression>
                                    <Expression xsi:type="GroupWorkflow">
                                      <Name>ZoRange</Name>
                                      <Workflow>
                                        <Nodes>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>MouseZ</Name>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>TakeZoNum</Name>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ZoMin</Name>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ZoSpacing</Name>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>SphereNumPerMoment</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Zip" />
                                          </Expression>
                                          <Expression xsi:type="Multiply" />
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Zip" />
                                          </Expression>
                                          <Expression xsi:type="Add" />
                                          <Expression xsi:type="BehaviorSubject">
                                            <Name>NewlyGeneratedSpheres ZoMin</Name>
                                          </Expression>
                                          <Expression xsi:type="PropertyMapping">
                                            <PropertyMappings>
                                              <Property Name="RangeMin" />
                                            </PropertyMappings>
                                          </Expression>
                                          <Expression xsi:type="PropertyMapping">
                                            <PropertyMappings>
                                              <Property Name="RangeMax" />
                                            </PropertyMappings>
                                          </Expression>
                                          <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.ParameterRange.bonsai">
                                            <RangeMin>455.99999999999977</RangeMin>
                                            <RangeMax>455.99999999999977</RangeMax>
                                            <Count>2</Count>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>SphereNumPerMoment</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Zip" />
                                          </Expression>
                                          <Expression xsi:type="Subtract" />
                                          <Expression xsi:type="Add">
                                            <Operand xsi:type="IntProperty">
                                              <Value>1</Value>
                                            </Operand>
                                          </Expression>
                                          <Expression xsi:type="Disable">
                                            <Builder xsi:type="GroupWorkflow">
                                              <Name>Same Projected Tube Length</Name>
                                              <Workflow>
                                                <Nodes>
                                                  <Expression xsi:type="SubscribeSubject">
                                                    <Name>TubeLength</Name>
                                                  </Expression>
                                                  <Expression xsi:type="SubscribeSubject">
                                                    <Name>ThisDepth</Name>
                                                  </Expression>
                                                  <Expression xsi:type="SubscribeSubject">
                                                    <Name>ZoScaleK</Name>
                                                  </Expression>
                                                  <Expression xsi:type="Combinator">
                                                    <Combinator xsi:type="rx:CombineLatest" />
                                                  </Expression>
                                                  <Expression xsi:type="scr:ExpressionTransform">
                                                    <scr:Expression>Item1 * Item2 / Item3</scr:Expression>
                                                  </Expression>
                                                  <Expression xsi:type="WorkflowOutput" />
                                                </Nodes>
                                                <Edges>
                                                  <Edge From="0" To="3" Label="Source1" />
                                                  <Edge From="1" To="3" Label="Source2" />
                                                  <Edge From="2" To="3" Label="Source3" />
                                                  <Edge From="3" To="4" Label="Source1" />
                                                  <Edge From="4" To="5" Label="Source1" />
                                                </Edges>
                                              </Workflow>
                                            </Builder>
                                          </Expression>
                                          <Expression xsi:type="Disable">
                                            <Builder xsi:type="PropertyMapping">
                                              <PropertyMappings>
                                                <Property Name="RangeMax" />
                                              </PropertyMappings>
                                            </Builder>
                                          </Expression>
                                          <Expression xsi:type="GroupWorkflow">
                                            <Name>Same Physical Tube Length</Name>
                                            <Workflow>
                                              <Nodes>
                                                <Expression xsi:type="SubscribeSubject">
                                                  <Name>TubeLength</Name>
                                                </Expression>
                                                <Expression xsi:type="SubscribeSubject">
                                                  <Name>ExtraSpheresFront</Name>
                                                </Expression>
                                                <Expression xsi:type="SubscribeSubject">
                                                  <Name>ZoSpacing</Name>
                                                </Expression>
                                                <Expression xsi:type="Combinator">
                                                  <Combinator xsi:type="rx:Zip" />
                                                </Expression>
                                                <Expression xsi:type="Multiply" />
                                                <Expression xsi:type="Combinator">
                                                  <Combinator xsi:type="rx:Zip" />
                                                </Expression>
                                                <Expression xsi:type="Add" />
                                                <Expression xsi:type="WorkflowOutput" />
                                              </Nodes>
                                              <Edges>
                                                <Edge From="0" To="5" Label="Source1" />
                                                <Edge From="1" To="3" Label="Source1" />
                                                <Edge From="2" To="3" Label="Source2" />
                                                <Edge From="3" To="4" Label="Source1" />
                                                <Edge From="4" To="5" Label="Source2" />
                                                <Edge From="5" To="6" Label="Source1" />
                                                <Edge From="6" To="7" Label="Source1" />
                                              </Edges>
                                            </Workflow>
                                          </Expression>
                                          <Expression xsi:type="PropertyMapping">
                                            <PropertyMappings>
                                              <Property Name="RangeMax" />
                                            </PropertyMappings>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>NewlyGeneratedSpheres ZoMin</Name>
                                          </Expression>
                                          <Expression xsi:type="PropertyMapping">
                                            <PropertyMappings>
                                              <Property Name="RangeMin" />
                                            </PropertyMappings>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ExtraSpheresFront</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Zip" />
                                          </Expression>
                                          <Expression xsi:type="Add" />
                                          <Expression xsi:type="PropertyMapping">
                                            <PropertyMappings>
                                              <Property Name="Count" />
                                            </PropertyMappings>
                                          </Expression>
                                          <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.ParameterRange.bonsai">
                                            <RangeMin>455.99999999999977</RangeMin>
                                            <RangeMax>1055.9999999999998</RangeMax>
                                            <Count>26</Count>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Concat" />
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Skip">
                                              <rx:Count>1</rx:Count>
                                            </Combinator>
                                          </Expression>
                                          <Expression xsi:type="Disable">
                                            <Builder xsi:type="MulticastSubject">
                                              <Name>TrialStartTrigger</Name>
                                            </Builder>
                                          </Expression>
                                          <Expression xsi:type="WorkflowOutput" />
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Max" />
                                          </Expression>
                                          <Expression xsi:type="AsyncSubject">
                                            <Name>MaxZo</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:WithLatestFrom" />
                                          </Expression>
                                        </Nodes>
                                        <Edges>
                                          <Edge From="0" To="34" Label="Source2" />
                                          <Edge From="1" To="14" Label="Source1" />
                                          <Edge From="2" To="7" Label="Source1" />
                                          <Edge From="3" To="5" Label="Source1" />
                                          <Edge From="4" To="5" Label="Source2" />
                                          <Edge From="5" To="6" Label="Source1" />
                                          <Edge From="6" To="7" Label="Source2" />
                                          <Edge From="7" To="8" Label="Source1" />
                                          <Edge From="8" To="9" Label="Source1" />
                                          <Edge From="9" To="10" Label="Source1" />
                                          <Edge From="9" To="11" Label="Source1" />
                                          <Edge From="10" To="12" Label="Source1" />
                                          <Edge From="11" To="12" Label="Source2" />
                                          <Edge From="12" To="28" Label="Source1" />
                                          <Edge From="13" To="14" Label="Source2" />
                                          <Edge From="14" To="15" Label="Source1" />
                                          <Edge From="15" To="16" Label="Source1" />
                                          <Edge From="16" To="24" Label="Source1" />
                                          <Edge From="17" To="18" Label="Source1" />
                                          <Edge From="18" To="27" Label="Source2" />
                                          <Edge From="19" To="20" Label="Source1" />
                                          <Edge From="20" To="27" Label="Source3" />
                                          <Edge From="21" To="22" Label="Source1" />
                                          <Edge From="22" To="27" Label="Source1" />
                                          <Edge From="23" To="24" Label="Source2" />
                                          <Edge From="24" To="25" Label="Source1" />
                                          <Edge From="25" To="26" Label="Source1" />
                                          <Edge From="26" To="27" Label="Source4" />
                                          <Edge From="27" To="28" Label="Source2" />
                                          <Edge From="28" To="29" Label="Source1" />
                                          <Edge From="29" To="30" Label="Source1" />
                                          <Edge From="30" To="31" Label="Source1" />
                                          <Edge From="30" To="32" Label="Source1" />
                                          <Edge From="30" To="34" Label="Source1" />
                                          <Edge From="32" To="33" Label="Source1" />
                                        </Edges>
                                      </Workflow>
                                    </Expression>
                                    <Expression xsi:type="CreateObservable">
                                      <Name>ThetaRange</Name>
                                      <Workflow>
                                        <Nodes>
                                          <Expression xsi:type="WorkflowInput">
                                            <Name>Source1</Name>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>TakeThetaNum</Name>
                                          </Expression>
                                          <Expression xsi:type="PropertyMapping">
                                            <PropertyMappings>
                                              <Property Name="Count" />
                                            </PropertyMappings>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ThetaMin</Name>
                                          </Expression>
                                          <Expression xsi:type="PropertyMapping">
                                            <PropertyMappings>
                                              <Property Name="Lower" />
                                            </PropertyMappings>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ThetaMinLim</Name>
                                          </Expression>
                                          <Expression xsi:type="PropertyMapping">
                                            <PropertyMappings>
                                              <Property Name="Upper" />
                                            </PropertyMappings>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="p3:CreateContinuousUniform">
                                              <p3:Lower>-40</p3:Lower>
                                              <p3:Upper>40</p3:Upper>
                                            </Combinator>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ThetaMaxLim</Name>
                                          </Expression>
                                          <Expression xsi:type="PropertyMapping">
                                            <PropertyMappings>
                                              <Property Name="Lower" />
                                            </PropertyMappings>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ThetaMax</Name>
                                          </Expression>
                                          <Expression xsi:type="PropertyMapping">
                                            <PropertyMappings>
                                              <Property Name="Upper" />
                                            </PropertyMappings>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="p3:CreateContinuousUniform">
                                              <p3:Lower>140</p3:Lower>
                                              <p3:Upper>220</p3:Upper>
                                            </Combinator>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Concat" />
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="num:Permutation" />
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="p3:SampleMany">
                                              <p3:Count>1</p3:Count>
                                            </Combinator>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:CombineLatest" />
                                          </Expression>
                                          <Expression xsi:type="WorkflowOutput" />
                                        </Nodes>
                                        <Edges>
                                          <Edge From="0" To="16" Label="Source2" />
                                          <Edge From="1" To="2" Label="Source1" />
                                          <Edge From="2" To="15" Label="Source2" />
                                          <Edge From="3" To="4" Label="Source1" />
                                          <Edge From="4" To="7" Label="Source1" />
                                          <Edge From="5" To="6" Label="Source1" />
                                          <Edge From="6" To="7" Label="Source2" />
                                          <Edge From="7" To="13" Label="Source1" />
                                          <Edge From="8" To="9" Label="Source1" />
                                          <Edge From="9" To="12" Label="Source1" />
                                          <Edge From="10" To="11" Label="Source1" />
                                          <Edge From="11" To="12" Label="Source2" />
                                          <Edge From="12" To="13" Label="Source2" />
                                          <Edge From="13" To="14" Label="Source1" />
                                          <Edge From="14" To="15" Label="Source1" />
                                          <Edge From="15" To="16" Label="Source1" />
                                          <Edge From="16" To="17" Label="Source1" />
                                        </Edges>
                                      </Workflow>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:Concat" />
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="BooleanProperty">
                                        <Value>false</Value>
                                      </Combinator>
                                    </Expression>
                                    <Expression xsi:type="PublishSubject" TypeArguments="sys:Boolean">
                                      <Name>EndTrigger</Name>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:Buffer">
                                        <rx:Count>2</rx:Count>
                                        <rx:Skip>1</rx:Skip>
                                      </Combinator>
                                    </Expression>
                                    <Expression xsi:type="scr:ExpressionCondition">
                                      <scr:Expression>((it[1]==True) &amp;&amp; (it[0]==False))</scr:Expression>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:WithLatestFrom" />
                                    </Expression>
                                    <Expression xsi:type="PublishSubject">
                                      <Name>RewardTrigger</Name>
                                    </Expression>
                                    <Expression xsi:type="MulticastSubject">
                                      <Name>EndTriggerOut</Name>
                                    </Expression>
                                    <Expression xsi:type="SubscribeSubject">
                                      <Name>NewSphereTrigger</Name>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:Zip" />
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:Skip">
                                        <rx:Count>1</rx:Count>
                                      </Combinator>
                                    </Expression>
                                    <Expression xsi:type="MemberSelector">
                                      <Selector>Item1</Selector>
                                    </Expression>
                                    <Expression xsi:type="GroupWorkflow">
                                      <Name>ZoRange</Name>
                                      <Workflow>
                                        <Nodes>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ZoMin</Name>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ZoMin</Name>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ZoSpacing</Name>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>SphereNumPerMoment</Name>
                                          </Expression>
                                          <Expression xsi:type="Subtract">
                                            <Operand xsi:type="IntProperty">
                                              <Value>1</Value>
                                            </Operand>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Zip" />
                                          </Expression>
                                          <Expression xsi:type="Multiply" />
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Zip" />
                                          </Expression>
                                          <Expression xsi:type="Add" />
                                          <Expression xsi:type="PropertyMapping">
                                            <PropertyMappings>
                                              <Property Name="RangeMax" />
                                            </PropertyMappings>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>SphereNumPerMoment</Name>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ZoSpacing</Name>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ExtraSpheresBehind</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Zip" />
                                          </Expression>
                                          <Expression xsi:type="Multiply" />
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Zip" />
                                          </Expression>
                                          <Expression xsi:type="Subtract" />
                                          <Expression xsi:type="PropertyMapping">
                                            <PropertyMappings>
                                              <Property Name="RangeMin" />
                                            </PropertyMappings>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ExtraSpheresBehind</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Zip" />
                                          </Expression>
                                          <Expression xsi:type="Add" />
                                          <Expression xsi:type="PropertyMapping">
                                            <PropertyMappings>
                                              <Property Name="Count" />
                                            </PropertyMappings>
                                          </Expression>
                                          <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.ParameterRange.bonsai">
                                            <RangeMin>-119.99999999999994</RangeMin>
                                            <RangeMax>431.99999999999983</RangeMax>
                                            <Count>24</Count>
                                          </Expression>
                                          <Expression xsi:type="MulticastSubject">
                                            <Name>TrialStartTrigger</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:ElementIndex" />
                                          </Expression>
                                          <Expression xsi:type="MemberSelector">
                                            <Selector>Value</Selector>
                                          </Expression>
                                          <Expression xsi:type="WorkflowOutput" />
                                        </Nodes>
                                        <Edges>
                                          <Edge From="0" To="15" Label="Source1" />
                                          <Edge From="1" To="7" Label="Source1" />
                                          <Edge From="2" To="5" Label="Source1" />
                                          <Edge From="3" To="4" Label="Source1" />
                                          <Edge From="4" To="5" Label="Source2" />
                                          <Edge From="5" To="6" Label="Source1" />
                                          <Edge From="6" To="7" Label="Source2" />
                                          <Edge From="7" To="8" Label="Source1" />
                                          <Edge From="8" To="9" Label="Source1" />
                                          <Edge From="9" To="22" Label="Source2" />
                                          <Edge From="10" To="19" Label="Source1" />
                                          <Edge From="11" To="13" Label="Source1" />
                                          <Edge From="12" To="13" Label="Source2" />
                                          <Edge From="13" To="14" Label="Source1" />
                                          <Edge From="14" To="15" Label="Source2" />
                                          <Edge From="15" To="16" Label="Source1" />
                                          <Edge From="16" To="17" Label="Source1" />
                                          <Edge From="17" To="22" Label="Source1" />
                                          <Edge From="18" To="19" Label="Source2" />
                                          <Edge From="19" To="20" Label="Source1" />
                                          <Edge From="20" To="21" Label="Source1" />
                                          <Edge From="21" To="22" Label="Source3" />
                                          <Edge From="22" To="23" Label="Source1" />
                                          <Edge From="22" To="24" Label="Source1" />
                                          <Edge From="24" To="25" Label="Source1" />
                                          <Edge From="25" To="26" Label="Source1" />
                                        </Edges>
                                      </Workflow>
                                    </Expression>
                                    <Expression xsi:type="CreateObservable">
                                      <Name>ThetaRange</Name>
                                      <Workflow>
                                        <Nodes>
                                          <Expression xsi:type="WorkflowInput">
                                            <Name>Source1</Name>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>TakeThetaNum</Name>
                                          </Expression>
                                          <Expression xsi:type="PropertyMapping">
                                            <PropertyMappings>
                                              <Property Name="Count" />
                                            </PropertyMappings>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ThetaMin</Name>
                                          </Expression>
                                          <Expression xsi:type="PropertyMapping">
                                            <PropertyMappings>
                                              <Property Name="Lower" />
                                            </PropertyMappings>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ThetaMinLim</Name>
                                          </Expression>
                                          <Expression xsi:type="PropertyMapping">
                                            <PropertyMappings>
                                              <Property Name="Upper" />
                                            </PropertyMappings>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="p3:CreateContinuousUniform">
                                              <p3:Lower>-40</p3:Lower>
                                              <p3:Upper>40</p3:Upper>
                                            </Combinator>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ThetaMaxLim</Name>
                                          </Expression>
                                          <Expression xsi:type="PropertyMapping">
                                            <PropertyMappings>
                                              <Property Name="Lower" />
                                            </PropertyMappings>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ThetaMax</Name>
                                          </Expression>
                                          <Expression xsi:type="PropertyMapping">
                                            <PropertyMappings>
                                              <Property Name="Upper" />
                                            </PropertyMappings>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="p3:CreateContinuousUniform">
                                              <p3:Lower>140</p3:Lower>
                                              <p3:Upper>220</p3:Upper>
                                            </Combinator>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Concat" />
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="num:Permutation" />
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="p3:SampleMany">
                                              <p3:Count>1</p3:Count>
                                            </Combinator>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:CombineLatest" />
                                          </Expression>
                                          <Expression xsi:type="WorkflowOutput" />
                                        </Nodes>
                                        <Edges>
                                          <Edge From="0" To="16" Label="Source2" />
                                          <Edge From="1" To="2" Label="Source1" />
                                          <Edge From="2" To="15" Label="Source2" />
                                          <Edge From="3" To="4" Label="Source1" />
                                          <Edge From="4" To="7" Label="Source1" />
                                          <Edge From="5" To="6" Label="Source1" />
                                          <Edge From="6" To="7" Label="Source2" />
                                          <Edge From="7" To="13" Label="Source1" />
                                          <Edge From="8" To="9" Label="Source1" />
                                          <Edge From="9" To="12" Label="Source1" />
                                          <Edge From="10" To="11" Label="Source1" />
                                          <Edge From="11" To="12" Label="Source2" />
                                          <Edge From="12" To="13" Label="Source2" />
                                          <Edge From="13" To="14" Label="Source1" />
                                          <Edge From="14" To="15" Label="Source1" />
                                          <Edge From="15" To="16" Label="Source1" />
                                          <Edge From="16" To="17" Label="Source1" />
                                        </Edges>
                                      </Workflow>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:Concat" />
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:Merge" />
                                    </Expression>
                                    <Expression xsi:type="SubscribeSubject">
                                      <Name>ThisDepth</Name>
                                    </Expression>
                                    <Expression xsi:type="MulticastSubject">
                                      <Name>Depth</Name>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:Merge" />
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:CombineLatest" />
                                    </Expression>
                                    <Expression xsi:type="MemberSelector">
                                      <Selector>Item1.Item1</Selector>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="num:DegreeToRadian" />
                                    </Expression>
                                    <Expression xsi:type="MemberSelector">
                                      <Selector>Item1.Item2</Selector>
                                    </Expression>
                                    <Expression xsi:type="MemberSelector">
                                      <Selector>Item2</Selector>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:Zip" />
                                    </Expression>
                                    <Expression xsi:type="MulticastSubject">
                                      <Name>SpherePos</Name>
                                    </Expression>
                                    <Expression xsi:type="SubscribeSubject">
                                      <Name>FadeTime</Name>
                                    </Expression>
                                    <Expression xsi:type="Multiply">
                                      <Operand xsi:type="FloatProperty">
                                        <Value>1E+07</Value>
                                      </Operand>
                                    </Expression>
                                    <Expression xsi:type="PropertyMapping">
                                      <PropertyMappings>
                                        <Property Name="DueTime" />
                                      </PropertyMappings>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:Delay">
                                        <rx:DueTime>PT0.3S</rx:DueTime>
                                      </Combinator>
                                    </Expression>
                                    <Expression xsi:type="PublishSubject">
                                      <Name>EndThisTrial</Name>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:TakeUntil" />
                                    </Expression>
                                    <Expression xsi:type="SubscribeSubject">
                                      <Name>FadeTime</Name>
                                    </Expression>
                                    <Expression xsi:type="Multiply">
                                      <Operand xsi:type="FloatProperty">
                                        <Value>1E+07</Value>
                                      </Operand>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:Zip" />
                                    </Expression>
                                    <Expression xsi:type="Subtract" />
                                    <Expression xsi:type="PropertyMapping">
                                      <PropertyMappings>
                                        <Property Name="DueTime" />
                                      </PropertyMappings>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:Delay">
                                        <rx:DueTime>PT9.7S</rx:DueTime>
                                      </Combinator>
                                    </Expression>
                                    <Expression xsi:type="WorkflowOutput" />
                                    <Expression xsi:type="ExternalizedMapping">
                                      <Property Name="DistanceBehind" />
                                    </Expression>
                                    <Expression xsi:type="GroupWorkflow">
                                      <Name>EndTrialCondition</Name>
                                      <Workflow>
                                        <Nodes>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>MaxZo</Name>
                                          </Expression>
                                          <Expression xsi:type="ExternalizedMapping">
                                            <Property Name="DistanceBehind" />
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>TrialInitialMouseZ</Name>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ExtraSpheresFront</Name>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>ZoSpacing</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Zip" />
                                          </Expression>
                                          <Expression xsi:type="Multiply" />
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Zip" />
                                          </Expression>
                                          <Expression xsi:type="Subtract" />
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:WithLatestFrom" />
                                          </Expression>
                                          <Expression xsi:type="Add" />
                                          <Expression xsi:type="Condition">
                                            <Workflow>
                                              <Nodes>
                                                <Expression xsi:type="Disable">
                                                  <Builder xsi:type="WorkflowInput">
                                                    <Name>Source1</Name>
                                                  </Builder>
                                                </Expression>
                                                <Expression xsi:type="Disable">
                                                  <Builder xsi:type="SubscribeSubject">
                                                    <Name>MouseZ</Name>
                                                  </Builder>
                                                </Expression>
                                                <Expression xsi:type="ExternalizedMapping">
                                                  <Property Name="Value" DisplayName="DistanceBehind" />
                                                </Expression>
                                                <Expression xsi:type="Disable">
                                                  <Builder xsi:type="Subtract">
                                                    <Operand xsi:type="DoubleProperty">
                                                      <Value>0</Value>
                                                    </Operand>
                                                  </Builder>
                                                </Expression>
                                                <Expression xsi:type="Disable">
                                                  <Builder xsi:type="Combinator">
                                                    <Combinator xsi:type="rx:CombineLatest" />
                                                  </Builder>
                                                </Expression>
                                                <Expression xsi:type="Disable">
                                                  <Builder xsi:type="LessThan" />
                                                </Expression>
                                                <Expression xsi:type="Disable">
                                                  <Builder xsi:type="MulticastSubject">
                                                    <Name>EndTrigger</Name>
                                                  </Builder>
                                                </Expression>
                                                <Expression xsi:type="Disable">
                                                  <Builder xsi:type="WorkflowOutput" />
                                                </Expression>
                                                <Expression xsi:type="SubscribeSubject">
                                                  <Name>TrialMouseZ</Name>
                                                </Expression>
                                                <Expression xsi:type="SubscribeSubject">
                                                  <Name>TubeLength</Name>
                                                </Expression>
                                                <Expression xsi:type="Combinator">
                                                  <Combinator xsi:type="rx:CombineLatest" />
                                                </Expression>
                                                <Expression xsi:type="GreaterThan" />
                                                <Expression xsi:type="MulticastSubject">
                                                  <Name>EndTrigger</Name>
                                                </Expression>
                                                <Expression xsi:type="WorkflowOutput" />
                                              </Nodes>
                                              <Edges>
                                                <Edge From="0" To="4" Label="Source1" />
                                                <Edge From="1" To="3" Label="Source1" />
                                                <Edge From="2" To="3" Label="Source2" />
                                                <Edge From="3" To="4" Label="Source2" />
                                                <Edge From="4" To="5" Label="Source1" />
                                                <Edge From="5" To="6" Label="Source1" />
                                                <Edge From="6" To="7" Label="Source1" />
                                                <Edge From="8" To="10" Label="Source1" />
                                                <Edge From="9" To="10" Label="Source2" />
                                                <Edge From="10" To="11" Label="Source1" />
                                                <Edge From="11" To="12" Label="Source1" />
                                                <Edge From="12" To="13" Label="Source1" />
                                              </Edges>
                                            </Workflow>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="BooleanProperty">
                                              <Value>true</Value>
                                            </Combinator>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>EndThisTrial</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:WithLatestFrom" />
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="FloatProperty">
                                              <Value>-9999</Value>
                                            </Combinator>
                                          </Expression>
                                          <Expression xsi:type="MulticastSubject">
                                            <Name>Depth</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="BooleanProperty">
                                              <Value>true</Value>
                                            </Combinator>
                                          </Expression>
                                        </Nodes>
                                        <Edges>
                                          <Edge From="0" To="7" Label="Source1" />
                                          <Edge From="1" To="11" Label="Source2" />
                                          <Edge From="2" To="9" Label="Source2" />
                                          <Edge From="3" To="5" Label="Source1" />
                                          <Edge From="4" To="5" Label="Source2" />
                                          <Edge From="5" To="6" Label="Source1" />
                                          <Edge From="6" To="7" Label="Source2" />
                                          <Edge From="7" To="8" Label="Source1" />
                                          <Edge From="8" To="9" Label="Source1" />
                                          <Edge From="9" To="10" Label="Source1" />
                                          <Edge From="10" To="11" Label="Source1" />
                                          <Edge From="12" To="14" Label="Source2" />
                                          <Edge From="13" To="14" Label="Source1" />
                                          <Edge From="14" To="15" Label="Source1" />
                                          <Edge From="15" To="16" Label="Source1" />
                                          <Edge From="16" To="17" Label="Source1" />
                                        </Edges>
                                      </Workflow>
                                    </Expression>
                                    <Expression xsi:type="GroupWorkflow">
                                      <Name>MouseZs</Name>
                                      <Workflow>
                                        <Nodes>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>GlobalElapsedTime</Name>
                                          </Expression>
                                          <Expression xsi:type="BehaviorSubject" TypeArguments="sys:Double">
                                            <Name>TrialStartTrigger</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Sample" />
                                          </Expression>
                                          <Expression xsi:type="MulticastSubject">
                                            <Name>TrialStartTime</Name>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>MouseZ</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Sample" />
                                          </Expression>
                                          <Expression xsi:type="MulticastSubject">
                                            <Name>TrialInitialMouseZ</Name>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>MouseZ</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:WithLatestFrom" />
                                          </Expression>
                                          <Expression xsi:type="Subtract" />
                                          <Expression xsi:type="BehaviorSubject">
                                            <Name>TrialMouseZ</Name>
                                          </Expression>
                                          <Expression xsi:type="Disable">
                                            <Builder xsi:type="Combinator">
                                              <Combinator xsi:type="BooleanProperty">
                                                <Value>false</Value>
                                              </Combinator>
                                            </Builder>
                                          </Expression>
                                          <Expression xsi:type="Disable">
                                            <Builder xsi:type="BehaviorSubject">
                                              <Name>NewSphereTrigger</Name>
                                            </Builder>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>GlobalElapsedTime</Name>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>Mouse Distance</Name>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>Mouse Distance</Name>
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>TrialStartTrigger</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Sample" />
                                          </Expression>
                                          <Expression xsi:type="MulticastSubject">
                                            <Name>TrialStartTime</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Sample" />
                                          </Expression>
                                          <Expression xsi:type="MulticastSubject">
                                            <Name>TrialInitialMouseZ</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:WithLatestFrom" />
                                          </Expression>
                                          <Expression xsi:type="Subtract" />
                                          <Expression xsi:type="BehaviorSubject">
                                            <Name>TrialMouseDistance</Name>
                                          </Expression>
                                          <Expression xsi:type="Disable">
                                            <Builder xsi:type="Combinator">
                                              <Combinator xsi:type="BooleanProperty">
                                                <Value>false</Value>
                                              </Combinator>
                                            </Builder>
                                          </Expression>
                                          <Expression xsi:type="Disable">
                                            <Builder xsi:type="BehaviorSubject">
                                              <Name>NewSphereTrigger</Name>
                                            </Builder>
                                          </Expression>
                                        </Nodes>
                                        <Edges>
                                          <Edge From="0" To="2" Label="Source1" />
                                          <Edge From="1" To="2" Label="Source2" />
                                          <Edge From="2" To="3" Label="Source1" />
                                          <Edge From="3" To="5" Label="Source2" />
                                          <Edge From="3" To="11" Label="Source1" />
                                          <Edge From="4" To="5" Label="Source1" />
                                          <Edge From="5" To="6" Label="Source1" />
                                          <Edge From="6" To="8" Label="Source2" />
                                          <Edge From="7" To="8" Label="Source1" />
                                          <Edge From="8" To="9" Label="Source1" />
                                          <Edge From="9" To="10" Label="Source1" />
                                          <Edge From="11" To="12" Label="Source1" />
                                          <Edge From="13" To="17" Label="Source1" />
                                          <Edge From="14" To="19" Label="Source1" />
                                          <Edge From="15" To="21" Label="Source1" />
                                          <Edge From="16" To="17" Label="Source2" />
                                          <Edge From="17" To="18" Label="Source1" />
                                          <Edge From="18" To="19" Label="Source2" />
                                          <Edge From="18" To="24" Label="Source1" />
                                          <Edge From="19" To="20" Label="Source1" />
                                          <Edge From="20" To="21" Label="Source2" />
                                          <Edge From="21" To="22" Label="Source1" />
                                          <Edge From="22" To="23" Label="Source1" />
                                          <Edge From="24" To="25" Label="Source1" />
                                        </Edges>
                                      </Workflow>
                                    </Expression>
                                    <Expression xsi:type="ExternalizedMapping">
                                      <Property Name="NewSphereTriggerThreshold" />
                                    </Expression>
                                    <Expression xsi:type="Disable">
                                      <Builder xsi:type="GroupWorkflow">
                                        <Name>Generate NewSphereTrigger</Name>
                                        <Workflow>
                                          <Nodes>
                                            <Expression xsi:type="ExternalizedMapping">
                                              <Property Name="Value" DisplayName="NewSphereTriggerThreshold" />
                                            </Expression>
                                            <Expression xsi:type="Combinator">
                                              <Combinator xsi:type="FloatProperty">
                                                <Value>0.001</Value>
                                              </Combinator>
                                            </Expression>
                                            <Expression xsi:type="SubscribeSubject">
                                              <Name>MouseZ</Name>
                                            </Expression>
                                            <Expression xsi:type="BehaviorSubject" TypeArguments="sys:Double">
                                              <Name>ZoSpacing</Name>
                                            </Expression>
                                            <Expression xsi:type="SubscribeSubject">
                                              <Name>NewSphereTrigger</Name>
                                            </Expression>
                                            <Expression xsi:type="SubscribeSubject">
                                              <Name>ZoSpacing</Name>
                                            </Expression>
                                            <Expression xsi:type="SubscribeSubject">
                                              <Name>Mouse Distance</Name>
                                            </Expression>
                                            <Expression xsi:type="SubscribeSubject">
                                              <Name>Mouse Distance</Name>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="SubscribeSubject">
                                                <Name>MouseZ</Name>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="SubscribeSubject">
                                                <Name>TrialMouseDistance</Name>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="Combinator">
                                                <Combinator xsi:type="rx:CombineLatest" />
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="Subtract">
                                                <Operand xsi:type="DoubleProperty">
                                                  <Value>0</Value>
                                                </Operand>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="SubscribeSubject">
                                                <Name>MouseZ</Name>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="SubscribeSubject">
                                                <Name>TrialMouseDistance</Name>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="Combinator">
                                                <Combinator xsi:type="rx:CombineLatest" />
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="Subtract">
                                                <Operand xsi:type="DoubleProperty">
                                                  <Value>0</Value>
                                                </Operand>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Combinator">
                                              <Combinator xsi:type="rx:Sample" />
                                            </Expression>
                                            <Expression xsi:type="Combinator">
                                              <Combinator xsi:type="rx:CombineLatest" />
                                            </Expression>
                                            <Expression xsi:type="scr:ExpressionTransform">
                                              <scr:Expression>new(
Item1/Item2 as TriggerNo,
Item2 as ZoSpacing
)</scr:Expression>
                                            </Expression>
                                            <Expression xsi:type="MemberSelector">
                                              <Selector>TriggerNo</Selector>
                                            </Expression>
                                            <Expression xsi:type="Combinator">
                                              <Combinator xsi:type="num:Floor" />
                                            </Expression>
                                            <Expression xsi:type="Combinator">
                                              <Combinator xsi:type="p1:Double2Int" />
                                            </Expression>
                                            <Expression xsi:type="MemberSelector">
                                              <Selector>ZoSpacing</Selector>
                                            </Expression>
                                            <Expression xsi:type="Combinator">
                                              <Combinator xsi:type="rx:CombineLatest" />
                                            </Expression>
                                            <Expression xsi:type="scr:ExpressionTransform">
                                              <scr:Expression>Item1 * Item2</scr:Expression>
                                            </Expression>
                                            <Expression xsi:type="Combinator">
                                              <Combinator xsi:type="rx:WithLatestFrom" />
                                            </Expression>
                                            <Expression xsi:type="Subtract" />
                                            <Expression xsi:type="Combinator">
                                              <Combinator xsi:type="rx:Buffer">
                                                <rx:Count>2</rx:Count>
                                                <rx:Skip>1</rx:Skip>
                                              </Combinator>
                                            </Expression>
                                            <Expression xsi:type="Combinator">
                                              <Combinator xsi:type="rx:CombineLatest" />
                                            </Expression>
                                            <Expression xsi:type="scr:ExpressionCondition">
                                              <scr:Expression>(Item1[1]&gt;=(Item2-Item3))&amp;&amp;(Item1[1]&gt;(Math.Floor(Item1[1]/Item2)*Item2+Item3))&amp;&amp;(Item1[0]&lt;(Math.Floor(Item1[1]/Item2)*Item2+Item3))</scr:Expression>
                                            </Expression>
                                            <Expression xsi:type="Combinator">
                                              <Combinator xsi:type="BooleanProperty">
                                                <Value>false</Value>
                                              </Combinator>
                                            </Expression>
                                            <Expression xsi:type="MulticastSubject">
                                              <Name>NewSphereTrigger</Name>
                                            </Expression>
                                            <Expression xsi:type="Combinator">
                                              <Combinator xsi:type="rx:Sample" />
                                            </Expression>
                                            <Expression xsi:type="PublishSubject">
                                              <Name>TriggerMouseZ</Name>
                                            </Expression>
                                            <Expression xsi:type="WorkflowOutput" />
                                            <Expression xsi:type="scr:ExpressionTransform">
                                              <scr:Expression>new(
it[0] as TriggerMouseZbefore,
it[1] as TriggerMouseZafter)</scr:Expression>
                                            </Expression>
                                            <Expression xsi:type="PublishSubject">
                                              <Name>TriggerAdjacentMouseZ</Name>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="SubscribeSubject">
                                                <Name>MouseZ</Name>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="SubscribeSubject">
                                                <Name>MouseZ</Name>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="ExternalizedMapping">
                                                <Property Name="Value" DisplayName="NewSphereTriggerThreshold" />
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="Combinator">
                                                <Combinator xsi:type="FloatProperty">
                                                  <Value>0.001</Value>
                                                </Combinator>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="SubscribeSubject">
                                                <Name>MouseZ</Name>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="BehaviorSubject" TypeArguments="sys:Double">
                                                <Name>ZoSpacing</Name>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="SubscribeSubject">
                                                <Name>NewSphereTrigger</Name>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="Combinator">
                                                <Combinator xsi:type="rx:Sample" />
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="SubscribeSubject">
                                                <Name>ZoSpacing</Name>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="Combinator">
                                                <Combinator xsi:type="rx:CombineLatest" />
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="scr:ExpressionTransform">
                                                <scr:Expression>new(
Item1/Item2 as TriggerNo,
Item2 as ZoSpacing
)</scr:Expression>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="MemberSelector">
                                                <Selector>TriggerNo</Selector>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="Combinator">
                                                <Combinator xsi:type="num:Floor" />
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="Combinator">
                                                <Combinator xsi:type="p1:Double2Int" />
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="MemberSelector">
                                                <Selector>ZoSpacing</Selector>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="Combinator">
                                                <Combinator xsi:type="rx:CombineLatest" />
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="scr:ExpressionTransform">
                                                <scr:Expression>Item1 * Item2</scr:Expression>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="Combinator">
                                                <Combinator xsi:type="rx:WithLatestFrom" />
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="Subtract" />
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="Combinator">
                                                <Combinator xsi:type="rx:Buffer">
                                                  <rx:Count>2</rx:Count>
                                                  <rx:Skip>1</rx:Skip>
                                                </Combinator>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="Combinator">
                                                <Combinator xsi:type="rx:CombineLatest" />
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="scr:ExpressionCondition">
                                                <scr:Expression>(Item1[1]&gt;=0)&amp;&amp;(Item1[0]&lt;0)</scr:Expression>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="Combinator">
                                                <Combinator xsi:type="BooleanProperty">
                                                  <Value>false</Value>
                                                </Combinator>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="MulticastSubject">
                                                <Name>NewSphereTrigger</Name>
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="Combinator">
                                                <Combinator xsi:type="rx:Sample" />
                                              </Builder>
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="WorkflowOutput" />
                                            </Expression>
                                            <Expression xsi:type="Disable">
                                              <Builder xsi:type="scr:ExpressionTransform">
                                                <scr:Expression>new(
it[0] as Item1,
it[1] as Item2)</scr:Expression>
                                              </Builder>
                                            </Expression>
                                          </Nodes>
                                          <Edges>
                                            <Edge From="0" To="1" Label="Source1" />
                                            <Edge From="1" To="28" Label="Source3" />
                                            <Edge From="2" To="32" Label="Source1" />
                                            <Edge From="3" To="28" Label="Source2" />
                                            <Edge From="4" To="16" Label="Source2" />
                                            <Edge From="5" To="17" Label="Source2" />
                                            <Edge From="6" To="10" Label="Source1" />
                                            <Edge From="7" To="8" Label="Source1" />
                                            <Edge From="8" To="14" Label="Source1" />
                                            <Edge From="9" To="10" Label="Source2" />
                                            <Edge From="10" To="11" Label="Source1" />
                                            <Edge From="11" To="12" Label="Source1" />
                                            <Edge From="12" To="25" Label="Source1" />
                                            <Edge From="13" To="14" Label="Source2" />
                                            <Edge From="14" To="15" Label="Source1" />
                                            <Edge From="15" To="16" Label="Source1" />
                                            <Edge From="16" To="17" Label="Source1" />
                                            <Edge From="17" To="18" Label="Source1" />
                                            <Edge From="18" To="19" Label="Source1" />
                                            <Edge From="18" To="22" Label="Source1" />
                                            <Edge From="19" To="20" Label="Source1" />
                                            <Edge From="20" To="21" Label="Source1" />
                                            <Edge From="21" To="23" Label="Source1" />
                                            <Edge From="22" To="23" Label="Source2" />
                                            <Edge From="23" To="24" Label="Source1" />
                                            <Edge From="24" To="25" Label="Source2" />
                                            <Edge From="25" To="26" Label="Source1" />
                                            <Edge From="26" To="27" Label="Source1" />
                                            <Edge From="27" To="28" Label="Source1" />
                                            <Edge From="27" To="35" Label="Source1" />
                                            <Edge From="28" To="29" Label="Source1" />
                                            <Edge From="29" To="30" Label="Source1" />
                                            <Edge From="30" To="31" Label="Source1" />
                                            <Edge From="31" To="32" Label="Source2" />
                                            <Edge From="32" To="33" Label="Source1" />
                                            <Edge From="33" To="34" Label="Source1" />
                                            <Edge From="35" To="36" Label="Source1" />
                                            <Edge From="37" To="44" Label="Source1" />
                                            <Edge From="38" To="54" Label="Source1" />
                                            <Edge From="39" To="40" Label="Source1" />
                                            <Edge From="40" To="57" Label="Source3" />
                                            <Edge From="41" To="61" Label="Source1" />
                                            <Edge From="42" To="57" Label="Source2" />
                                            <Edge From="43" To="44" Label="Source2" />
                                            <Edge From="44" To="46" Label="Source1" />
                                            <Edge From="45" To="46" Label="Source2" />
                                            <Edge From="46" To="47" Label="Source1" />
                                            <Edge From="47" To="48" Label="Source1" />
                                            <Edge From="47" To="51" Label="Source1" />
                                            <Edge From="48" To="49" Label="Source1" />
                                            <Edge From="49" To="50" Label="Source1" />
                                            <Edge From="50" To="52" Label="Source1" />
                                            <Edge From="51" To="52" Label="Source2" />
                                            <Edge From="52" To="53" Label="Source1" />
                                            <Edge From="53" To="54" Label="Source2" />
                                            <Edge From="54" To="55" Label="Source1" />
                                            <Edge From="55" To="56" Label="Source1" />
                                            <Edge From="56" To="57" Label="Source1" />
                                            <Edge From="56" To="63" Label="Source1" />
                                            <Edge From="57" To="58" Label="Source1" />
                                            <Edge From="58" To="59" Label="Source1" />
                                            <Edge From="59" To="60" Label="Source1" />
                                            <Edge From="60" To="61" Label="Source2" />
                                            <Edge From="61" To="62" Label="Source1" />
                                          </Edges>
                                        </Workflow>
                                      </Builder>
                                    </Expression>
                                    <Expression xsi:type="ExternalizedMapping">
                                      <Property Name="RewardDelay" />
                                    </Expression>
                                    <Expression xsi:type="GroupWorkflow">
                                      <Name>BlankPeriod Reward</Name>
                                      <Workflow>
                                        <Nodes>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="BooleanProperty">
                                              <Value>true</Value>
                                            </Combinator>
                                          </Expression>
                                          <Expression xsi:type="ExternalizedMapping">
                                            <Property Name="DueTime" DisplayName="RewardDelay" />
                                          </Expression>
                                          <Expression xsi:type="SubscribeSubject">
                                            <Name>RewardTrigger</Name>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:WithLatestFrom" />
                                          </Expression>
                                          <Expression xsi:type="MemberSelector">
                                            <Selector>Item2</Selector>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Delay">
                                              <rx:DueTime>PT2S</rx:DueTime>
                                            </Combinator>
                                          </Expression>
                                          <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.ParameterRange.bonsai">
                                            <RangeMin>0</RangeMin>
                                            <RangeMax>1</RangeMax>
                                            <Count>1000</Count>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="num:Permutation" />
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="rx:Zip" />
                                          </Expression>
                                          <Expression xsi:type="MemberSelector">
                                            <Selector>Item1</Selector>
                                          </Expression>
                                          <Expression xsi:type="Condition">
                                            <Workflow>
                                              <Nodes>
                                                <Expression xsi:type="WorkflowInput">
                                                  <Name>Source1</Name>
                                                </Expression>
                                                <Expression xsi:type="SubscribeSubject">
                                                  <Name>RewardProb</Name>
                                                </Expression>
                                                <Expression xsi:type="PropertyMapping">
                                                  <PropertyMappings>
                                                    <Property Name="Value" />
                                                  </PropertyMappings>
                                                </Expression>
                                                <Expression xsi:type="LessThanOrEqual">
                                                  <Operand xsi:type="DoubleProperty">
                                                    <Value>0.699999988079071</Value>
                                                  </Operand>
                                                </Expression>
                                                <Expression xsi:type="WorkflowOutput" />
                                              </Nodes>
                                              <Edges>
                                                <Edge From="0" To="3" Label="Source1" />
                                                <Edge From="1" To="2" Label="Source1" />
                                                <Edge From="2" To="3" Label="Source2" />
                                                <Edge From="3" To="4" Label="Source1" />
                                              </Edges>
                                            </Workflow>
                                          </Expression>
                                          <Expression xsi:type="Combinator">
                                            <Combinator xsi:type="BooleanProperty">
                                              <Value>true</Value>
                                            </Combinator>
                                          </Expression>
                                          <Expression xsi:type="MulticastSubject">
                                            <Name>Reward</Name>
                                          </Expression>
                                          <Expression xsi:type="MulticastSubject">
                                            <Name>RewardLog</Name>
                                          </Expression>
                                          <Expression xsi:type="WorkflowOutput" />
                                        </Nodes>
                                        <Edges>
                                          <Edge From="0" To="3" Label="Source2" />
                                          <Edge From="1" To="5" Label="Source2" />
                                          <Edge From="2" To="3" Label="Source1" />
                                          <Edge From="3" To="4" Label="Source1" />
                                          <Edge From="4" To="5" Label="Source1" />
                                          <Edge From="5" To="8" Label="Source2" />
                                          <Edge From="6" To="7" Label="Source1" />
                                          <Edge From="7" To="8" Label="Source1" />
                                          <Edge From="8" To="9" Label="Source1" />
                                          <Edge From="9" To="10" Label="Source1" />
                                          <Edge From="10" To="11" Label="Source1" />
                                          <Edge From="11" To="12" Label="Source1" />
                                          <Edge From="12" To="13" Label="Source1" />
                                          <Edge From="13" To="14" Label="Source1" />
                                        </Edges>
                                      </Workflow>
                                    </Expression>
                                    <Expression xsi:type="Disable">
                                      <Builder xsi:type="SubscribeSubject">
                                        <Name>TriggerAdjacentMouseZ</Name>
                                      </Builder>
                                    </Expression>
                                    <Expression xsi:type="Disable">
                                      <Builder xsi:type="SubscribeSubject">
                                        <Name>TriggerMouseZ</Name>
                                      </Builder>
                                    </Expression>
                                    <Expression xsi:type="Disable">
                                      <Builder xsi:type="Combinator">
                                        <Combinator xsi:type="rx:WithLatestFrom" />
                                      </Builder>
                                    </Expression>
                                    <Expression xsi:type="Disable">
                                      <Builder xsi:type="SubscribeSubject">
                                        <Name>RootName</Name>
                                      </Builder>
                                    </Expression>
                                    <Expression xsi:type="Disable">
                                      <Builder xsi:type="Format">
                                        <Format>{0}\Trigger.csv</Format>
                                        <Selector>it</Selector>
                                      </Builder>
                                    </Expression>
                                    <Expression xsi:type="Disable">
                                      <Builder xsi:type="PropertyMapping">
                                        <PropertyMappings>
                                          <Property Name="FileName" />
                                        </PropertyMappings>
                                      </Builder>
                                    </Expression>
                                    <Expression xsi:type="Disable">
                                      <Builder xsi:type="io:CsvWriter">
                                        <io:FileName>D:\data\Test\S20240422\R132028_SpheresPermTubeReward\\Trigger.csv</io:FileName>
                                        <io:Append>false</io:Append>
                                        <io:Overwrite>false</io:Overwrite>
                                        <io:Suffix>None</io:Suffix>
                                        <io:IncludeHeader>false</io:IncludeHeader>
                                      </Builder>
                                    </Expression>
                                  </Nodes>
                                  <Edges>
                                    <Edge From="0" To="1" Label="Source1" />
                                    <Edge From="1" To="2" Label="Source1" />
                                    <Edge From="3" To="4" Label="Source1" />
                                    <Edge From="4" To="5" Label="Source1" />
                                    <Edge From="5" To="6" Label="Source1" />
                                    <Edge From="6" To="8" Label="Source1" />
                                    <Edge From="7" To="8" Label="Source2" />
                                    <Edge From="8" To="9" Label="Source1" />
                                    <Edge From="9" To="10" Label="Source1" />
                                    <Edge From="10" To="11" Label="Source1" />
                                    <Edge From="11" To="13" Label="Source1" />
                                    <Edge From="12" To="13" Label="Source2" />
                                    <Edge From="14" To="15" Label="Source1" />
                                    <Edge From="16" To="54" Label="Source1" />
                                    <Edge From="17" To="38" Label="Source2" />
                                    <Edge From="18" To="19" Label="Source1" />
                                    <Edge From="19" To="20" Label="Source1" />
                                    <Edge From="20" To="29" Label="Source1" />
                                    <Edge From="21" To="25" Label="Source2" />
                                    <Edge From="22" To="23" Label="Source1" />
                                    <Edge From="23" To="24" Label="Source1" />
                                    <Edge From="24" To="25" Label="Source1" />
                                    <Edge From="25" To="26" Label="Source1" />
                                    <Edge From="26" To="27" Label="Source1" />
                                    <Edge From="27" To="49" Label="Source1" />
                                    <Edge From="28" To="29" Label="Source2" />
                                    <Edge From="29" To="30" Label="Source1" />
                                    <Edge From="30" To="31" Label="Source1" />
                                    <Edge From="31" To="35" Label="Source2" />
                                    <Edge From="32" To="33" Label="Source1" />
                                    <Edge From="33" To="34" Label="Source1" />
                                    <Edge From="34" To="35" Label="Source1" />
                                    <Edge From="35" To="39" Label="Source1" />
                                    <Edge From="36" To="37" Label="Source1" />
                                    <Edge From="37" To="38" Label="Source1" />
                                    <Edge From="38" To="39" Label="Source2" />
                                    <Edge From="39" To="40" Label="Source1" />
                                    <Edge From="39" To="42" Label="Source1" />
                                    <Edge From="39" To="43" Label="Source1" />
                                    <Edge From="40" To="41" Label="Source1" />
                                    <Edge From="41" To="44" Label="Source1" />
                                    <Edge From="42" To="44" Label="Source2" />
                                    <Edge From="43" To="44" Label="Source3" />
                                    <Edge From="44" To="45" Label="Source1" />
                                    <Edge From="45" To="51" Label="Source1" />
                                    <Edge From="46" To="47" Label="Source1" />
                                    <Edge From="47" To="48" Label="Source1" />
                                    <Edge From="48" To="49" Label="Source2" />
                                    <Edge From="49" To="50" Label="Source1" />
                                    <Edge From="50" To="51" Label="Source2" />
                                    <Edge From="51" To="57" Label="Source1" />
                                    <Edge From="52" To="53" Label="Source1" />
                                    <Edge From="53" To="54" Label="Source2" />
                                    <Edge From="54" To="55" Label="Source1" />
                                    <Edge From="55" To="56" Label="Source1" />
                                    <Edge From="56" To="57" Label="Source2" />
                                    <Edge From="57" To="58" Label="Source1" />
                                    <Edge From="59" To="60" Label="Source1" />
                                    <Edge From="62" To="63" Label="Source1" />
                                    <Edge From="64" To="65" Label="Source1" />
                                    <Edge From="66" To="68" Label="Source2" />
                                    <Edge From="67" To="68" Label="Source1" />
                                    <Edge From="68" To="72" Label="Source1" />
                                    <Edge From="69" To="70" Label="Source1" />
                                    <Edge From="70" To="71" Label="Source1" />
                                    <Edge From="71" To="72" Label="Source2" />
                                  </Edges>
                                </Workflow>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:Concat" />
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:RepeatCount">
                                  <rx:Count>100</rx:Count>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="ExternalizedMapping">
                                <Property Name="Value" DisplayName="Size" Category="MiscParams" />
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="FloatProperty">
                                  <Value>0.087</Value>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="BehaviorSubject">
                                <Name>OriginalSize</Name>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:Take">
                                  <rx:Count>1</rx:Count>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="BehaviorSubject" TypeArguments="sys:Tuple(sys:Double,sys:Double,sys:Double)">
                                <Name>SpherePos</Name>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>EyeZ</Name>
                              </Expression>
                              <Expression xsi:type="Disable">
                                <Builder xsi:type="SubscribeSubject">
                                  <Name>NewSphereTrigger</Name>
                                </Builder>
                              </Expression>
                              <Expression xsi:type="BehaviorSubject" TypeArguments="sys:Double">
                                <Name>ThisDepth</Name>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>TubeSpacing</Name>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>ZoScaleK</Name>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:CombineLatest" />
                              </Expression>
                              <Expression xsi:type="scr:ExpressionTransform">
                                <scr:Expression>Item2*Item1/Item3</scr:Expression>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>SphereNumPerMoment</Name>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>FrameZ</Name>
                              </Expression>
                              <Expression xsi:type="MemberSelector">
                                <Selector>FrameObject.TimeStep.ElapsedRealTime</Selector>
                              </Expression>
                              <Expression xsi:type="rx:Accumulate" />
                              <Expression xsi:type="PublishSubject">
                                <Name>ElapsedTime</Name>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:WithLatestFrom" />
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:ElementIndex" />
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>MouseZ</Name>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:CombineLatest" />
                              </Expression>
                              <Expression xsi:type="Disable">
                                <Builder xsi:type="Combinator">
                                  <Combinator xsi:type="rx:Sample" />
                                </Builder>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>TrialInitialMouseZ</Name>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:CombineLatest" />
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:WithLatestFrom" />
                              </Expression>
                              <Expression xsi:type="Disable">
                                <Builder xsi:type="Combinator">
                                  <Combinator xsi:type="p1:TubeMapping_NewZ" />
                                </Builder>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="p1:TubeMapping_NewZ_corrected" />
                              </Expression>
                              <Expression xsi:type="scr:ExpressionTransform">
                                <scr:Expression>new(
Item1 as SphereID,
Item2 as SphereStartTime,
Item3.Item1 as Theta,
Item3.Item2 as Z0,
Item3.Item3 as Radius,
Item4.Item1 as X,
Item4.Item2 as Y,
Item4.Item3 as Z0,
Item4.Item4 as Z,
Item4.Item5 as EyeZ,
Item4.Item6 as MouseZ,
Item5.Item1 as OriginalSize,
Item5.Item2 as Size)</scr:Expression>
                              </Expression>
                              <Expression xsi:type="BehaviorSubject">
                                <Name>SphereNewParams</Name>
                              </Expression>
                              <Expression xsi:type="BehaviorSubject" TypeArguments="sys:Double">
                                <Name>TrialInitialMouseZ</Name>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="FloatProperty">
                                  <Value>0</Value>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="BehaviorSubject" TypeArguments="sys:Double">
                                <Name>TrialStartTime</Name>
                              </Expression>
                              <Expression xsi:type="BehaviorSubject">
                                <Name>TrialStartTimeSub</Name>
                              </Expression>
                            </Nodes>
                            <Edges>
                              <Edge From="0" To="1" Label="Source1" />
                              <Edge From="1" To="6" Label="Source2" />
                              <Edge From="2" To="4" Label="Source1" />
                              <Edge From="3" To="4" Label="Source2" />
                              <Edge From="4" To="5" Label="Source1" />
                              <Edge From="5" To="6" Label="Source1" />
                              <Edge From="7" To="8" Label="Source1" />
                              <Edge From="8" To="9" Label="Source1" />
                              <Edge From="9" To="10" Label="Source1" />
                              <Edge From="10" To="30" Label="Source2" />
                              <Edge From="11" To="24" Label="Source1" />
                              <Edge From="12" To="27" Label="Source1" />
                              <Edge From="13" To="28" Label="Source2" />
                              <Edge From="14" To="17" Label="Source1" />
                              <Edge From="15" To="17" Label="Source2" />
                              <Edge From="16" To="17" Label="Source3" />
                              <Edge From="17" To="18" Label="Source1" />
                              <Edge From="18" To="30" Label="Source3" />
                              <Edge From="19" To="30" Label="Source4" />
                              <Edge From="20" To="21" Label="Source1" />
                              <Edge From="21" To="22" Label="Source1" />
                              <Edge From="22" To="23" Label="Source1" />
                              <Edge From="23" To="24" Label="Source2" />
                              <Edge From="24" To="25" Label="Source1" />
                              <Edge From="25" To="30" Label="Source1" />
                              <Edge From="26" To="27" Label="Source2" />
                              <Edge From="27" To="28" Label="Source1" />
                              <Edge From="28" To="31" Label="Source2" />
                              <Edge From="29" To="30" Label="Source5" />
                              <Edge From="30" To="31" Label="Source1" />
                              <Edge From="31" To="32" Label="Source1" />
                              <Edge From="32" To="33" Label="Source1" />
                              <Edge From="33" To="34" Label="Source1" />
                              <Edge From="34" To="35" Label="Source1" />
                              <Edge From="36" To="37" Label="Source1" />
                              <Edge From="38" To="39" Label="Source1" />
                            </Edges>
                          </Workflow>
                        </Expression>
                        <Expression xsi:type="SubscribeSubject">
                          <Name>SphereNumPerMoment</Name>
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="BackgroundColor" />
                          <Property Name="TargetAmb" />
                        </Expression>
                        <Expression xsi:type="SubscribeSubject">
                          <Name>ExtraSpheresBehind</Name>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="rx:Zip" />
                        </Expression>
                        <Expression xsi:type="Add" />
                        <Expression xsi:type="PropertyMapping">
                          <PropertyMappings>
                            <Property Name="Count" />
                          </PropertyMappings>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="rx:Range">
                            <rx:Start>0</rx:Start>
                            <rx:Count>24</rx:Count>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="CreateObservable">
                          <Name>CreateSpheres</Name>
                          <Workflow>
                            <Nodes>
                              <Expression xsi:type="WorkflowInput">
                                <Name>Source1</Name>
                              </Expression>
                              <Expression xsi:type="AsyncSubject">
                                <Name>SphereIndex</Name>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>Draw</Name>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>SphereNewParams</Name>
                              </Expression>
                              <Expression xsi:type="Condition">
                                <Workflow>
                                  <Nodes>
                                    <Expression xsi:type="WorkflowInput">
                                      <Name>Source1</Name>
                                    </Expression>
                                    <Expression xsi:type="MemberSelector">
                                      <Selector>SphereID</Selector>
                                    </Expression>
                                    <Expression xsi:type="SubscribeSubject">
                                      <Name>SphereIndex</Name>
                                    </Expression>
                                    <Expression xsi:type="SubscribeSubject">
                                      <Name>SphereNumPerMoment</Name>
                                    </Expression>
                                    <Expression xsi:type="SubscribeSubject">
                                      <Name>ExtraSpheresBehind</Name>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:Zip" />
                                    </Expression>
                                    <Expression xsi:type="Add" />
                                    <Expression xsi:type="PropertyMapping">
                                      <PropertyMappings>
                                        <Property Name="Value" />
                                      </PropertyMappings>
                                    </Expression>
                                    <Expression xsi:type="Mod">
                                      <Operand xsi:type="IntProperty">
                                        <Value>24</Value>
                                      </Operand>
                                    </Expression>
                                    <Expression xsi:type="MulticastSubject">
                                      <Name>SphereOriginalID</Name>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:WithLatestFrom" />
                                    </Expression>
                                    <Expression xsi:type="MemberSelector">
                                      <Selector>Radius</Selector>
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="rx:WithLatestFrom" />
                                    </Expression>
                                    <Expression xsi:type="Combinator">
                                      <Combinator xsi:type="p1:SphereIdxCondition" />
                                    </Expression>
                                    <Expression xsi:type="WorkflowOutput" />
                                  </Nodes>
                                  <Edges>
                                    <Edge From="0" To="1" Label="Source1" />
                                    <Edge From="0" To="11" Label="Source1" />
                                    <Edge From="1" To="8" Label="Source1" />
                                    <Edge From="2" To="10" Label="Source2" />
                                    <Edge From="3" To="5" Label="Source1" />
                                    <Edge From="4" To="5" Label="Source2" />
                                    <Edge From="5" To="6" Label="Source1" />
                                    <Edge From="6" To="7" Label="Source1" />
                                    <Edge From="7" To="8" Label="Source2" />
                                    <Edge From="8" To="9" Label="Source1" />
                                    <Edge From="9" To="10" Label="Source1" />
                                    <Edge From="10" To="12" Label="Source1" />
                                    <Edge From="11" To="12" Label="Source2" />
                                    <Edge From="12" To="13" Label="Source1" />
                                    <Edge From="13" To="14" Label="Source1" />
                                  </Edges>
                                </Workflow>
                              </Expression>
                              <Expression xsi:type="MemberSelector">
                                <Selector>SphereID,SphereStartTime</Selector>
                              </Expression>
                              <Expression xsi:type="MemberSelector">
                                <Selector>Theta,Z0,Radius</Selector>
                              </Expression>
                              <Expression xsi:type="MemberSelector">
                                <Selector>X,Y,Z</Selector>
                              </Expression>
                              <Expression xsi:type="MemberSelector">
                                <Selector>EyeZ,MouseZ</Selector>
                              </Expression>
                              <Expression xsi:type="MemberSelector">
                                <Selector>OriginalSize,Size</Selector>
                              </Expression>
                              <Expression xsi:type="ExternalizedMapping">
                                <Property Name="Value" DisplayName="TargetAmb" />
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="FloatProperty">
                                  <Value>0</Value>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="ExternalizedMapping">
                                <Property Name="Value" DisplayName="BackgroundColor" />
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="FloatProperty">
                                  <Value>0.5</Value>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="Disable">
                                <Builder xsi:type="SubscribeSubject">
                                  <Name>SphereNewParams</Name>
                                </Builder>
                              </Expression>
                              <Expression xsi:type="Disable">
                                <Builder xsi:type="Condition">
                                  <Workflow>
                                    <Nodes>
                                      <Expression xsi:type="WorkflowInput">
                                        <Name>Source1</Name>
                                      </Expression>
                                      <Expression xsi:type="MemberSelector">
                                        <Selector>Item1</Selector>
                                      </Expression>
                                      <Expression xsi:type="SubscribeSubject">
                                        <Name>SphereIndex</Name>
                                      </Expression>
                                      <Expression xsi:type="SubscribeSubject">
                                        <Name>SphereNumPerMoment</Name>
                                      </Expression>
                                      <Expression xsi:type="PropertyMapping">
                                        <PropertyMappings>
                                          <Property Name="Value" />
                                        </PropertyMappings>
                                      </Expression>
                                      <Expression xsi:type="Mod">
                                        <Operand xsi:type="IntProperty">
                                          <Value>30</Value>
                                        </Operand>
                                      </Expression>
                                      <Expression xsi:type="Combinator">
                                        <Combinator xsi:type="rx:WithLatestFrom" />
                                      </Expression>
                                      <Expression xsi:type="MemberSelector">
                                        <Selector>Item3.Item3</Selector>
                                      </Expression>
                                      <Expression xsi:type="Combinator">
                                        <Combinator xsi:type="rx:WithLatestFrom" />
                                      </Expression>
                                      <Expression xsi:type="Combinator">
                                        <Combinator xsi:type="p1:SphereIdxCondition" />
                                      </Expression>
                                      <Expression xsi:type="WorkflowOutput" />
                                    </Nodes>
                                    <Edges>
                                      <Edge From="0" To="1" Label="Source1" />
                                      <Edge From="0" To="7" Label="Source1" />
                                      <Edge From="1" To="5" Label="Source1" />
                                      <Edge From="2" To="6" Label="Source2" />
                                      <Edge From="3" To="4" Label="Source1" />
                                      <Edge From="4" To="5" Label="Source2" />
                                      <Edge From="5" To="6" Label="Source1" />
                                      <Edge From="6" To="8" Label="Source1" />
                                      <Edge From="7" To="8" Label="Source2" />
                                      <Edge From="8" To="9" Label="Source1" />
                                      <Edge From="9" To="10" Label="Source1" />
                                    </Edges>
                                  </Workflow>
                                </Builder>
                              </Expression>
                              <Expression xsi:type="Disable">
                                <Builder xsi:type="MemberSelector">
                                  <Selector>Item2</Selector>
                                </Builder>
                              </Expression>
                              <Expression xsi:type="Disable">
                                <Builder xsi:type="SubscribeSubject">
                                  <Name>ElapsedTime</Name>
                                </Builder>
                              </Expression>
                              <Expression xsi:type="Disable">
                                <Builder xsi:type="Combinator">
                                  <Combinator xsi:type="rx:WithLatestFrom" />
                                </Builder>
                              </Expression>
                              <Expression xsi:type="Disable">
                                <Builder xsi:type="Subtract" />
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>GlobalElapsedTime</Name>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>GlobalElapsedTime</Name>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>NewSphereTime</Name>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:Sample" />
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:CombineLatest" />
                              </Expression>
                              <Expression xsi:type="Subtract" />
                              <Expression xsi:type="SubscribeSubject">
                                <Name>GlobalElapsedTime</Name>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>GlobalElapsedTime</Name>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>StartTriggerIn</Name>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:Sample" />
                              </Expression>
                              <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.ParameterRange.bonsai">
                                <RangeMin>0</RangeMin>
                                <RangeMax>0</RangeMax>
                                <Count>2</Count>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:Merge" />
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:CombineLatest" />
                              </Expression>
                              <Expression xsi:type="Subtract" />
                              <Expression xsi:type="SubscribeSubject">
                                <Name>GlobalElapsedTime</Name>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>EndTriggerIn</Name>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:Sample" />
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>GlobalElapsedTime</Name>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>StartTriggerIn</Name>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:Sample" />
                              </Expression>
                              <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.ParameterRange.bonsai">
                                <RangeMin>0</RangeMin>
                                <RangeMax>0</RangeMax>
                                <Count>2</Count>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:Merge" />
                              </Expression>
                              <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.ParameterRange.bonsai">
                                <RangeMin>99999999</RangeMin>
                                <RangeMax>99999999</RangeMax>
                                <Count>2</Count>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:Merge" />
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:CombineLatest" />
                              </Expression>
                              <Expression xsi:type="Subtract" />
                              <Expression xsi:type="SubscribeSubject">
                                <Name>FadeTime</Name>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="FloatProperty">
                                  <Value>0.3</Value>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:CombineLatest" />
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="p1:CreateFadingInOut" />
                              </Expression>
                              <Expression xsi:type="Disable">
                                <Builder xsi:type="Combinator">
                                  <Combinator xsi:type="p1:CreateFadingIn" />
                                </Builder>
                              </Expression>
                              <Expression xsi:type="Disable">
                                <Builder xsi:type="Combinator">
                                  <Combinator xsi:type="p1:CreateFadingNew" />
                                </Builder>
                              </Expression>
                              <Expression xsi:type="BehaviorSubject" TypeArguments="sys:Int32">
                                <Name>SphereOriginalID</Name>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:Zip" />
                              </Expression>
                              <Expression xsi:type="MulticastSubject">
                                <Name>LogSphereParams</Name>
                              </Expression>
                              <Expression xsi:type="scr:ExpressionTransform">
                                <scr:Name>Rename</scr:Name>
                                <scr:Expression>new(
Item6 as SphereOriginalID,
Item1.Item1 as SphereID,
Item1.Item2 as SphereStartTime,
Item2.Item1 as Theta,
Item2.Item2 as Z0,
Item2.Item3 as Radius,
Item3.Item1 as X,
Item3.Item2 as Y,
Item3.Item3 as Z,
Item4.Item1 as EyeZ,
Item4.Item2 as MouseZ,
Item5.Item1 as OriginalSize,
Item5.Item2 as Size
)</scr:Expression>
                              </Expression>
                              <Expression xsi:type="PublishSubject">
                                <Name>NewSphereTime</Name>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:CombineLatest" />
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:WithLatestFrom" />
                              </Expression>
                              <Expression xsi:type="InputMapping">
                                <PropertyMappings>
                                  <Property Name="TranslationY" Selector="Item2.Item1.Y" />
                                  <Property Name="TranslationZ" Selector="Item2.Item1.Z" />
                                  <Property Name="ScaleX" Selector="Item2.Item1.Size" />
                                  <Property Name="ScaleY" Selector="Item2.Item1.Size" />
                                  <Property Name="ScaleZ" Selector="Item2.Item1.Size" />
                                  <Property Name="TranslationX" Selector="Item2.Item1.X" />
                                  <Property Name="Ambient" Selector="Item2.Item2" />
                                </PropertyMappings>
                                <Selector>Item1</Selector>
                              </Expression>
                              <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.DrawModel.bonsai">
                                <TranslationX>159.972488</TranslationX>
                                <TranslationY>2.96722651</TranslationY>
                                <TranslationZ>408</TranslationZ>
                                <ScaleX>13.92</ScaleX>
                                <ScaleY>13.92</ScaleY>
                                <ScaleZ>13.92</ScaleZ>
                                <MeshName>sphere</MeshName>
                                <Ambient>
                                  <X>0</X>
                                  <Y>0</Y>
                                  <Z>0</Z>
                                </Ambient>
                                <Diffuse>
                                  <X>0</X>
                                  <Y>0</Y>
                                  <Z>0</Z>
                                </Diffuse>
                                <Specular>
                                  <X>0</X>
                                  <Y>0</Y>
                                  <Z>0</Z>
                                </Specular>
                                <SpecularExponent>10</SpecularExponent>
                                <RotationZ>0</RotationZ>
                                <RotationY>0</RotationY>
                                <RotationX>0</RotationX>
                              </Expression>
                              <Expression xsi:type="WorkflowOutput" />
                              <Expression xsi:type="MemberSelector">
                                <Selector>Item1.SphereID,Item1.SphereStartTime</Selector>
                              </Expression>
                              <Expression xsi:type="MemberSelector">
                                <Selector>Item1.Theta,Item1.Z0,Item1.Radius</Selector>
                              </Expression>
                              <Expression xsi:type="MemberSelector">
                                <Selector>Item1.X,Item1.Y,Item1.Z</Selector>
                              </Expression>
                              <Expression xsi:type="MemberSelector">
                                <Selector>Item1.EyeZ,Item1.MouseZ</Selector>
                              </Expression>
                              <Expression xsi:type="MemberSelector">
                                <Selector>Item1.OriginalSize,Item1.Size</Selector>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:Zip" />
                              </Expression>
                              <Expression xsi:type="MemberSelector">
                                <Selector>Item2</Selector>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:CombineLatest" />
                              </Expression>
                              <Expression xsi:type="MulticastSubject">
                                <Name>LogSphereAllParams</Name>
                              </Expression>
                            </Nodes>
                            <Edges>
                              <Edge From="0" To="1" Label="Source1" />
                              <Edge From="2" To="58" Label="Source1" />
                              <Edge From="3" To="4" Label="Source1" />
                              <Edge From="4" To="5" Label="Source1" />
                              <Edge From="4" To="6" Label="Source1" />
                              <Edge From="4" To="7" Label="Source1" />
                              <Edge From="4" To="8" Label="Source1" />
                              <Edge From="4" To="9" Label="Source1" />
                              <Edge From="5" To="53" Label="Source1" />
                              <Edge From="6" To="53" Label="Source2" />
                              <Edge From="7" To="53" Label="Source3" />
                              <Edge From="8" To="53" Label="Source4" />
                              <Edge From="9" To="53" Label="Source5" />
                              <Edge From="10" To="11" Label="Source1" />
                              <Edge From="11" To="48" Label="Source4" />
                              <Edge From="12" To="13" Label="Source1" />
                              <Edge From="13" To="48" Label="Source5" />
                              <Edge From="14" To="15" Label="Source1" />
                              <Edge From="15" To="16" Label="Source1" />
                              <Edge From="16" To="18" Label="Source2" />
                              <Edge From="17" To="18" Label="Source1" />
                              <Edge From="18" To="19" Label="Source1" />
                              <Edge From="19" To="48" Label="Source1" />
                              <Edge From="20" To="24" Label="Source1" />
                              <Edge From="21" To="23" Label="Source1" />
                              <Edge From="22" To="23" Label="Source2" />
                              <Edge From="23" To="24" Label="Source2" />
                              <Edge From="24" To="25" Label="Source1" />
                              <Edge From="25" To="48" Label="Source2" />
                              <Edge From="26" To="32" Label="Source1" />
                              <Edge From="27" To="29" Label="Source1" />
                              <Edge From="28" To="29" Label="Source2" />
                              <Edge From="29" To="31" Label="Source1" />
                              <Edge From="30" To="31" Label="Source2" />
                              <Edge From="31" To="32" Label="Source2" />
                              <Edge From="32" To="33" Label="Source1" />
                              <Edge From="33" To="48" Label="Source6" />
                              <Edge From="34" To="36" Label="Source1" />
                              <Edge From="35" To="36" Label="Source2" />
                              <Edge From="36" To="43" Label="Source1" />
                              <Edge From="37" To="39" Label="Source1" />
                              <Edge From="38" To="39" Label="Source2" />
                              <Edge From="39" To="41" Label="Source1" />
                              <Edge From="40" To="41" Label="Source2" />
                              <Edge From="41" To="44" Label="Source2" />
                              <Edge From="42" To="43" Label="Source2" />
                              <Edge From="43" To="44" Label="Source1" />
                              <Edge From="44" To="45" Label="Source1" />
                              <Edge From="45" To="48" Label="Source7" />
                              <Edge From="46" To="47" Label="Source1" />
                              <Edge From="47" To="48" Label="Source3" />
                              <Edge From="48" To="49" Label="Source1" />
                              <Edge From="49" To="50" Label="Source1" />
                              <Edge From="50" To="51" Label="Source1" />
                              <Edge From="51" To="57" Label="Source2" />
                              <Edge From="52" To="53" Label="Source6" />
                              <Edge From="53" To="54" Label="Source1" />
                              <Edge From="54" To="55" Label="Source1" />
                              <Edge From="55" To="56" Label="Source1" />
                              <Edge From="56" To="57" Label="Source1" />
                              <Edge From="57" To="58" Label="Source2" />
                              <Edge From="57" To="62" Label="Source1" />
                              <Edge From="57" To="63" Label="Source1" />
                              <Edge From="57" To="64" Label="Source1" />
                              <Edge From="57" To="65" Label="Source1" />
                              <Edge From="57" To="66" Label="Source1" />
                              <Edge From="57" To="68" Label="Source1" />
                              <Edge From="58" To="59" Label="Source1" />
                              <Edge From="59" To="60" Label="Source1" />
                              <Edge From="60" To="61" Label="Source1" />
                              <Edge From="62" To="67" Label="Source1" />
                              <Edge From="63" To="67" Label="Source2" />
                              <Edge From="64" To="67" Label="Source3" />
                              <Edge From="65" To="67" Label="Source4" />
                              <Edge From="66" To="67" Label="Source5" />
                              <Edge From="67" To="69" Label="Source1" />
                              <Edge From="68" To="69" Label="Source2" />
                              <Edge From="69" To="70" Label="Source1" />
                            </Edges>
                          </Workflow>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="rx:Merge" />
                        </Expression>
                        <Expression xsi:type="GroupWorkflow">
                          <Name>SphereParamsLoggerClose</Name>
                          <Workflow>
                            <Nodes>
                              <Expression xsi:type="BehaviorSubject" TypeArguments="sys:Tuple(sys:Tuple(sys:Int32,sys:Single),sys:Tuple(sys:Single,sys:Single,sys:Single),sys:Tuple(sys:Single,sys:Single,sys:Single),sys:Tuple(sys:Single,sys:Single),sys:Tuple(sys:Single,sys:Single),sys:Int32)">
                                <Name>LogSphereParams</Name>
                              </Expression>
                              <Expression xsi:type="IncludeWorkflow" Path="Bonsai.Harp:WithLatestTimestamp.bonsai">
                                <Name>Timestamp</Name>
                              </Expression>
                              <Expression xsi:type="scr:ExpressionTransform">
                                <scr:Name>Rename</scr:Name>
                                <scr:Expression>new(
Timestamp as HarpTime,
Value.Item1.Item1 as SphereID,
Value.Item1.Item2 as SphereStartTime,
Value.Item2.Item1 as Theta,
Value.Item2.Item2 as Z0,
Value.Item2.Item3 as Radius,
Value.Item3.Item1 as X,
Value.Item3.Item2 as Y,
Value.Item3.Item3 as Z,
Value.Item4.Item1 as EyeZ,
Value.Item4.Item2 as MouseZ,
Value.Item5.Item1 as OriginalSize,
Value.Item5.Item2 as Size
)</scr:Expression>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>RootName</Name>
                              </Expression>
                              <Expression xsi:type="Format">
                                <Format>{0}\NewParams.csv</Format>
                                <Selector>it</Selector>
                              </Expression>
                              <Expression xsi:type="PropertyMapping">
                                <PropertyMappings>
                                  <Property Name="FileName" />
                                </PropertyMappings>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>FrameZ</Name>
                              </Expression>
                              <Expression xsi:type="MemberSelector">
                                <Selector>FrameObject.TimeStep</Selector>
                              </Expression>
                              <Expression xsi:type="rx:Accumulate" />
                              <Expression xsi:type="MemberSelector">
                                <Selector>FrameIndex</Selector>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:Zip" />
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>UpdateFrameIndex</Name>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:WithLatestFrom" />
                              </Expression>
                              <Expression xsi:type="scr:ExpressionTransform">
                                <scr:Name>Rename</scr:Name>
                                <scr:Expression>new(
Item1.Item2 as Frameindex,
Item1.Item1.ElapsedTime as ElapsedTimeSinceSpheres,
Item1.Item1.ElapsedRealTime as ElapsedRealTimeSinceSpheres,
Item2 as UpdateFrameIndex)
</scr:Expression>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:WithLatestFrom" />
                              </Expression>
                              <Expression xsi:type="scr:ExpressionTransform">
                                <scr:Name>Rename</scr:Name>
                                <scr:Expression>new(
Item1.HarpTime as HarpTime,
Item2.Frameindex as Frameindex,
Item2.ElapsedTimeSinceSpheres as ElapsedTimeSinceSpheres,
Item2.ElapsedRealTimeSinceSpheres as ElapsedRealTimeSinceSpheres,
Item2.UpdateFrameIndex as UpdateFrameIndex,
Item1.SphereID as SphereID,
Item1.Theta/Math.PI*180 as Theta,
Item1.Z0 as Z0,
Item1.Radius as Radius,
Item1.X as X,
Item1.Y as Y,
Item1.Z as Z,
Item1.EyeZ as EyeZ,
Item1.MouseZ as MouseZ,
Item1.OriginalSize as OriginalSize,
Item1.Size as Size)</scr:Expression>
                              </Expression>
                              <Expression xsi:type="io:CsvWriter">
                                <io:FileName>D:\data\Test\S20240821\R140249_SpheresPermTubeReward\\NewParams.csv</io:FileName>
                                <io:Append>false</io:Append>
                                <io:Overwrite>false</io:Overwrite>
                                <io:Suffix>None</io:Suffix>
                                <io:IncludeHeader>true</io:IncludeHeader>
                              </Expression>
                              <Expression xsi:type="Disable">
                                <Builder xsi:type="MemberSelector">
                                  <Selector>SphereID</Selector>
                                </Builder>
                              </Expression>
                              <Expression xsi:type="Disable">
                                <Builder xsi:type="MemberSelector">
                                  <Selector>Azimuth</Selector>
                                </Builder>
                              </Expression>
                              <Expression xsi:type="Disable">
                                <Builder xsi:type="MemberSelector">
                                  <Selector>Elevation</Selector>
                                </Builder>
                              </Expression>
                              <Expression xsi:type="Disable">
                                <Builder xsi:type="MemberSelector">
                                  <Selector>Depth</Selector>
                                </Builder>
                              </Expression>
                              <Expression xsi:type="Disable">
                                <Builder xsi:type="MemberSelector">
                                  <Selector>Frame</Selector>
                                </Builder>
                              </Expression>
                              <Expression xsi:type="Disable">
                                <Builder xsi:type="Combinator">
                                  <Combinator xsi:type="rx:Zip" />
                                </Builder>
                              </Expression>
                              <Expression xsi:type="Disable">
                                <Builder xsi:type="scr:ExpressionTransform">
                                  <scr:Expression>new(
Item5 as Frame,
Item1 as SphereID,
Item2 as Azimuth,
Item3 as Elevation,
Item4 as Depth
)</scr:Expression>
                                </Builder>
                              </Expression>
                              <Expression xsi:type="Disable">
                                <Builder xsi:type="ReplaySubject">
                                  <Name>SphereParamsReplay</Name>
                                  <BufferSize xsi:nil="true" />
                                </Builder>
                              </Expression>
                              <Expression xsi:type="BehaviorSubject" TypeArguments="sys:Tuple(sys:Tuple(sys:Tuple(sys:Int32,sys:Single),sys:Tuple(sys:Single,sys:Single,sys:Single),sys:Tuple(sys:Single,sys:Single,sys:Single),sys:Tuple(sys:Single,sys:Single),sys:Tuple(sys:Single,sys:Single)),sys:Single)">
                                <Name>LogSphereAllParams</Name>
                              </Expression>
                              <Expression xsi:type="IncludeWorkflow" Path="Bonsai.Harp:WithLatestTimestamp.bonsai">
                                <Name>Timestamp</Name>
                              </Expression>
                              <Expression xsi:type="scr:ExpressionTransform">
                                <scr:Name>Rename</scr:Name>
                                <scr:Expression>new(
Timestamp as HarpTime,
Value.Item1.Item1.Item1 as SphereID,
Value.Item1.Item1.Item2 as SphereStartTime,
Value.Item1.Item2.Item1 as Theta,
Value.Item1.Item2.Item2 as Z0,
Value.Item1.Item2.Item3 as Radius,
Value.Item1.Item3.Item1 as X,
Value.Item1.Item3.Item2 as Y,
Value.Item1.Item3.Item3 as Z,
Value.Item1.Item4.Item1 as EyeZ,
Value.Item1.Item4.Item2 as MouseZ,
Value.Item1.Item5.Item1 as OriginalSize,
Value.Item1.Item5.Item2 as Size,
Value.Item2 as Ambience
)</scr:Expression>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>RootName</Name>
                              </Expression>
                              <Expression xsi:type="Format">
                                <Format>{0}\AllParams.csv</Format>
                                <Selector>it</Selector>
                              </Expression>
                              <Expression xsi:type="PropertyMapping">
                                <PropertyMappings>
                                  <Property Name="FileName" />
                                </PropertyMappings>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>FrameZ</Name>
                              </Expression>
                              <Expression xsi:type="MemberSelector">
                                <Selector>FrameObject.TimeStep</Selector>
                              </Expression>
                              <Expression xsi:type="rx:Accumulate" />
                              <Expression xsi:type="MemberSelector">
                                <Selector>FrameIndex</Selector>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:Zip" />
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>UpdateFrameIndex</Name>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:WithLatestFrom" />
                              </Expression>
                              <Expression xsi:type="scr:ExpressionTransform">
                                <scr:Name>Rename</scr:Name>
                                <scr:Expression>new(
Item1.Item2 as Frameindex,
Item1.Item1.ElapsedTime as ElapsedTimeSinceSpheres,
Item1.Item1.ElapsedRealTime as ElapsedRealTimeSinceSpheres,
Item2 as UpdateFrameIndex)
</scr:Expression>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:WithLatestFrom" />
                              </Expression>
                              <Expression xsi:type="scr:ExpressionTransform">
                                <scr:Name>Rename</scr:Name>
                                <scr:Expression>new(
Item1.HarpTime as HarpTime,
Item2.Frameindex as Frameindex,
Item2.ElapsedTimeSinceSpheres as ElapsedTimeSinceSpheres,
Item2.ElapsedRealTimeSinceSpheres as ElapsedRealTimeSinceSpheres,
Item2.UpdateFrameIndex as UpdateFrameIndex,
Item1.SphereID as SphereID,
Item1.Theta/Math.PI*180 as Theta,
Item1.Z0 as Z0,
Item1.Radius as Radius,
Item1.X as X,
Item1.Y as Y,
Item1.Z as Z,
Item1.EyeZ as EyeZ,
Item1.MouseZ as MouseZ,
Item1.OriginalSize as OriginalSize,
Item1.Size as Size,
Item1.Ambience as Ambience)</scr:Expression>
                              </Expression>
                              <Expression xsi:type="io:CsvWriter">
                                <io:FileName>D:\data\Test\S20240821\R140249_SpheresPermTubeReward\\AllParams.csv</io:FileName>
                                <io:Append>false</io:Append>
                                <io:Overwrite>false</io:Overwrite>
                                <io:Suffix>None</io:Suffix>
                                <io:IncludeHeader>true</io:IncludeHeader>
                              </Expression>
                            </Nodes>
                            <Edges>
                              <Edge From="0" To="1" Label="Source1" />
                              <Edge From="1" To="2" Label="Source1" />
                              <Edge From="2" To="14" Label="Source1" />
                              <Edge From="3" To="4" Label="Source1" />
                              <Edge From="4" To="5" Label="Source1" />
                              <Edge From="5" To="16" Label="Source2" />
                              <Edge From="6" To="7" Label="Source1" />
                              <Edge From="6" To="9" Label="Source1" />
                              <Edge From="7" To="8" Label="Source1" />
                              <Edge From="8" To="10" Label="Source1" />
                              <Edge From="9" To="10" Label="Source2" />
                              <Edge From="10" To="12" Label="Source1" />
                              <Edge From="11" To="12" Label="Source2" />
                              <Edge From="12" To="13" Label="Source1" />
                              <Edge From="13" To="14" Label="Source2" />
                              <Edge From="14" To="15" Label="Source1" />
                              <Edge From="15" To="16" Label="Source1" />
                              <Edge From="16" To="17" Label="Source1" />
                              <Edge From="16" To="18" Label="Source1" />
                              <Edge From="16" To="19" Label="Source1" />
                              <Edge From="16" To="20" Label="Source1" />
                              <Edge From="16" To="21" Label="Source1" />
                              <Edge From="17" To="22" Label="Source1" />
                              <Edge From="18" To="22" Label="Source2" />
                              <Edge From="19" To="22" Label="Source3" />
                              <Edge From="20" To="22" Label="Source4" />
                              <Edge From="21" To="22" Label="Source5" />
                              <Edge From="22" To="23" Label="Source1" />
                              <Edge From="23" To="24" Label="Source1" />
                              <Edge From="25" To="26" Label="Source1" />
                              <Edge From="26" To="27" Label="Source1" />
                              <Edge From="27" To="39" Label="Source1" />
                              <Edge From="28" To="29" Label="Source1" />
                              <Edge From="29" To="30" Label="Source1" />
                              <Edge From="30" To="41" Label="Source2" />
                              <Edge From="31" To="32" Label="Source1" />
                              <Edge From="31" To="34" Label="Source1" />
                              <Edge From="32" To="33" Label="Source1" />
                              <Edge From="33" To="35" Label="Source1" />
                              <Edge From="34" To="35" Label="Source2" />
                              <Edge From="35" To="37" Label="Source1" />
                              <Edge From="36" To="37" Label="Source2" />
                              <Edge From="37" To="38" Label="Source1" />
                              <Edge From="38" To="39" Label="Source2" />
                              <Edge From="39" To="40" Label="Source1" />
                              <Edge From="40" To="41" Label="Source1" />
                            </Edges>
                          </Workflow>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject" TypeArguments="sys:Tuple(scg:IList(sys:Boolean),sys:Boolean)">
                          <Name>EndTriggerOut</Name>
                        </Expression>
                        <Expression xsi:type="PublishSubject">
                          <Name>EndTriggerIn</Name>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="rx:ElementIndex" />
                        </Expression>
                        <Expression xsi:type="MemberSelector">
                          <Selector>Index</Selector>
                        </Expression>
                        <Expression xsi:type="Add">
                          <Operand xsi:type="IntProperty">
                            <Value>1</Value>
                          </Operand>
                        </Expression>
                        <Expression xsi:type="PublishSubject">
                          <Name>TrialCount</Name>
                        </Expression>
                        <Expression xsi:type="BehaviorSubject" TypeArguments="sys:Double">
                          <Name>StartTriggerOut</Name>
                        </Expression>
                        <Expression xsi:type="PublishSubject">
                          <Name>StartTriggerIn</Name>
                        </Expression>
                        <Expression xsi:type="GroupWorkflow">
                          <Name>RewardLog</Name>
                          <Workflow>
                            <Nodes>
                              <Expression xsi:type="BehaviorSubject" TypeArguments="sys:Boolean">
                                <Name>RewardLog</Name>
                              </Expression>
                              <Expression xsi:type="IncludeWorkflow" Path="Bonsai.Harp:WithLatestTimestamp.bonsai">
                                <Name>Timestamp</Name>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>RootName</Name>
                              </Expression>
                              <Expression xsi:type="Format">
                                <Format>{0}\RewardLog.csv</Format>
                                <Selector>it</Selector>
                              </Expression>
                              <Expression xsi:type="PropertyMapping">
                                <PropertyMappings>
                                  <Property Name="FileName" />
                                </PropertyMappings>
                              </Expression>
                              <Expression xsi:type="SubscribeSubject">
                                <Name>FrameZ</Name>
                              </Expression>
                              <Expression xsi:type="MemberSelector">
                                <Selector>FrameObject.TimeStep</Selector>
                              </Expression>
                              <Expression xsi:type="rx:Accumulate" />
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:ElementIndex" />
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:UpdateFrame" />
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:ElementIndex" />
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:WithLatestFrom" />
                              </Expression>
                              <Expression xsi:type="scr:ExpressionTransform">
                                <scr:Name>Rename</scr:Name>
                                <scr:Expression>new(
Item1.Index as Frameindex,
Item1.Value.ElapsedTime as ElapsedTime,
Item1.Value.ElapsedRealTime as ElapsedRealTime,
Item2.Index as UpdateFrameIndex)
</scr:Expression>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:WithLatestFrom" />
                              </Expression>
                              <Expression xsi:type="scr:ExpressionTransform">
                                <scr:Name>Rename</scr:Name>
                                <scr:Expression>new(
Item1.Timestamp as HarpTime,
Item2.Frameindex as Frameindex,
Item2.ElapsedTime as ElapsedTime,
Item2.ElapsedRealTime as ElapsedRealTime,
Item2.UpdateFrameIndex as UpdateFrameIndex,
Item1.Value as Reward)</scr:Expression>
                              </Expression>
                              <Expression xsi:type="io:CsvWriter">
                                <io:FileName>D:\data\Test\S20240821\R140249_SpheresPermTubeReward\\RewardLog.csv</io:FileName>
                                <io:Append>false</io:Append>
                                <io:Overwrite>false</io:Overwrite>
                                <io:Suffix>None</io:Suffix>
                                <io:IncludeHeader>true</io:IncludeHeader>
                              </Expression>
                              <Expression xsi:type="WorkflowOutput" />
                            </Nodes>
                            <Edges>
                              <Edge From="0" To="1" Label="Source1" />
                              <Edge From="1" To="13" Label="Source1" />
                              <Edge From="2" To="3" Label="Source1" />
                              <Edge From="3" To="4" Label="Source1" />
                              <Edge From="4" To="15" Label="Source2" />
                              <Edge From="5" To="6" Label="Source1" />
                              <Edge From="6" To="7" Label="Source1" />
                              <Edge From="7" To="8" Label="Source1" />
                              <Edge From="8" To="11" Label="Source1" />
                              <Edge From="9" To="10" Label="Source1" />
                              <Edge From="10" To="11" Label="Source2" />
                              <Edge From="11" To="12" Label="Source1" />
                              <Edge From="12" To="13" Label="Source2" />
                              <Edge From="13" To="14" Label="Source1" />
                              <Edge From="14" To="15" Label="Source1" />
                              <Edge From="15" To="16" Label="Source1" />
                            </Edges>
                          </Workflow>
                        </Expression>
                      </Nodes>
                      <Edges>
                        <Edge From="0" To="1" Label="Source1" />
                        <Edge From="2" To="5" Label="Source1" />
                        <Edge From="3" To="9" Label="Source2" />
                        <Edge From="4" To="5" Label="Source2" />
                        <Edge From="5" To="6" Label="Source1" />
                        <Edge From="6" To="7" Label="Source1" />
                        <Edge From="7" To="8" Label="Source1" />
                        <Edge From="8" To="9" Label="Source1" />
                        <Edge From="9" To="10" Label="Source1" />
                        <Edge From="12" To="13" Label="Source1" />
                        <Edge From="13" To="14" Label="Source1" />
                        <Edge From="14" To="15" Label="Source1" />
                        <Edge From="15" To="16" Label="Source1" />
                        <Edge From="16" To="17" Label="Source1" />
                        <Edge From="18" To="19" Label="Source1" />
                      </Edges>
                    </Workflow>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:DelaySubscription">
                      <rx:DueTime>PT30S</rx:DueTime>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>TrialCount</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>DepthCount</Name>
                  </Expression>
                  <Expression xsi:type="PropertyMapping">
                    <PropertyMappings>
                      <Property Name="Value" />
                    </PropertyMappings>
                  </Expression>
                  <Expression xsi:type="Divide">
                    <Operand xsi:type="IntProperty">
                      <Value>8</Value>
                    </Operand>
                  </Expression>
                  <Expression xsi:type="MulticastSubject">
                    <Name>TrialNo</Name>
                  </Expression>
                </Nodes>
                <Edges>
                  <Edge From="0" To="1" Label="Source1" />
                  <Edge From="2" To="3" Label="Source1" />
                  <Edge From="3" To="4" Label="Source1" />
                  <Edge From="5" To="6" Label="Source1" />
                  <Edge From="7" To="10" Label="Source2" />
                  <Edge From="8" To="9" Label="Source1" />
                  <Edge From="9" To="10" Label="Source1" />
                  <Edge From="11" To="14" Label="Source1" />
                  <Edge From="12" To="13" Label="Source1" />
                  <Edge From="13" To="14" Label="Source2" />
                  <Edge From="14" To="15" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:TakeUntil" />
            </Expression>
          </Nodes>
          <Edges>
            <Edge From="7" To="16" Label="Source1" />
            <Edge From="8" To="18" Label="Source2" />
            <Edge From="9" To="13" Label="Source3" />
            <Edge From="10" To="13" Label="Source2" />
            <Edge From="11" To="13" Label="Source1" />
            <Edge From="12" To="13" Label="Source4" />
            <Edge From="13" To="14" Label="Source1" />
            <Edge From="14" To="15" Label="Source1" />
            <Edge From="14" To="16" Label="Source2" />
            <Edge From="16" To="17" Label="Source1" />
            <Edge From="17" To="18" Label="Source1" />
          </Edges>
        </Workflow>
      </Expression>
      <Expression xsi:type="Combinator">
        <Combinator xsi:type="rx:DelaySubscription">
          <rx:DueTime>PT3S</rx:DueTime>
        </Combinator>
      </Expression>
      <Expression xsi:type="SubscribeSubject">
        <Name>TrialNo</Name>
      </Expression>
    </Nodes>
    <Edges>
      <Edge From="4" To="5" Label="Source1" />
      <Edge From="5" To="6" Label="Source1" />
      <Edge From="6" To="7" Label="Source1" />
      <Edge From="8" To="9" Label="Source1" />
      <Edge From="11" To="12" Label="Source1" />
      <Edge From="12" To="13" Label="Source1" />
      <Edge From="14" To="15" Label="Source1" />
    </Edges>
  </Workflow>
</WorkflowBuilder>