<?xml version="1.0" encoding="utf-8"?>
<WorkflowBuilder Version="2.6.0"
                 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                 xmlns:gl="clr-namespace:Bonsai.Shaders;assembly=Bonsai.Shaders"
                 xmlns:res="clr-namespace:Bonsai.Resources;assembly=Bonsai.System"
                 xmlns:wie="clr-namespace:Bonsai.Windows.Input;assembly=Bonsai.Windows.Input"
                 xmlns:dsp="clr-namespace:Bonsai.Dsp;assembly=Bonsai.Dsp"
                 xmlns:io="clr-namespace:Bonsai.IO;assembly=Bonsai.System"
                 xmlns:rx="clr-namespace:Bonsai.Reactive;assembly=Bonsai.Core"
                 xmlns:scr="clr-namespace:Bonsai.Scripting;assembly=Bonsai.Scripting"
                 xmlns:sys="clr-namespace:System;assembly=mscorlib"
                 xmlns:num="clr-namespace:Bonsai.Numerics;assembly=Bonsai.Numerics"
                 xmlns:p1="clr-namespace:;assembly=Extensions"
                 xmlns:harp="clr-namespace:Bonsai.Harp;assembly=Bonsai.Harp"
                 xmlns:p2="clr-namespace:Bonsai.Harp.CF;assembly=Bonsai.Harp.CF"
                 xmlns="https://bonsai-rx.org/2018/workflow">
  <Workflow>
    <Nodes>
      <Expression xsi:type="GroupWorkflow">
        <Name>InitBonvision3D</Name>
        <Workflow>
          <Nodes>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="WindowState" />
              <Property Name="DisplayDevice" />
              <Property Name="ClearColor" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="gl:CreateWindow">
                <gl:Width>640</gl:Width>
                <gl:Height>480</gl:Height>
                <gl:VSync>On</gl:VSync>
                <gl:SwapSync>false</gl:SwapSync>
                <gl:ClearColor>Gray</gl:ClearColor>
                <gl:ClearMask>DepthBufferBit ColorBufferBit</gl:ClearMask>
                <gl:CursorVisible>true</gl:CursorVisible>
                <gl:Location xsi:nil="true" />
                <gl:WindowBorder>Fixed</gl:WindowBorder>
                <gl:WindowState>Fullscreen</gl:WindowState>
                <gl:DisplayDevice>Second</gl:DisplayDevice>
                <gl:TargetRenderFrequency>0</gl:TargetRenderFrequency>
                <gl:TargetUpdateFrequency xsi:nil="true" />
                <gl:RenderState />
                <gl:GraphicsMode>
                  <gl:ColorFormat>
                    <gl:Red>8</gl:Red>
                    <gl:Green>8</gl:Green>
                    <gl:Blue>8</gl:Blue>
                    <gl:Alpha>8</gl:Alpha>
                  </gl:ColorFormat>
                  <gl:Depth>16</gl:Depth>
                  <gl:Stencil>0</gl:Stencil>
                  <gl:Samples>0</gl:Samples>
                  <gl:AccumulatorFormat>
                    <gl:Red>0</gl:Red>
                    <gl:Green>0</gl:Green>
                    <gl:Blue>0</gl:Blue>
                    <gl:Alpha>0</gl:Alpha>
                  </gl:AccumulatorFormat>
                  <gl:Buffers>2</gl:Buffers>
                  <gl:Stereo>false</gl:Stereo>
                </gl:GraphicsMode>
              </Combinator>
            </Expression>
            <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.BonVisionResources.bonsai" />
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="gl:ShaderResources">
                <gl:Shaders />
              </Combinator>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="gl:MeshResources">
                <gl:Meshes>
                  <gl:MeshConfiguration xsi:type="gl:TexturedModel">
                    <gl:Name>sphere</gl:Name>
                    <gl:FileName>D:\code\vis-stim-depth\Spheres\Objects\sphere.obj</gl:FileName>
                  </gl:MeshConfiguration>
                </gl:Meshes>
              </Combinator>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="gl:TextureResources">
                <gl:Textures>
                  <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                    <gl:Name>fwn1</gl:Name>
                    <gl:Width xsi:nil="true" />
                    <gl:Height xsi:nil="true" />
                    <gl:InternalFormat>Rgba</gl:InternalFormat>
                    <gl:WrapS>Repeat</gl:WrapS>
                    <gl:WrapT>Repeat</gl:WrapT>
                    <gl:MinFilter>Linear</gl:MinFilter>
                    <gl:MagFilter>Linear</gl:MagFilter>
                    <gl:FileName>Textures\fwn1.jpg</gl:FileName>
                    <gl:ColorType>Unchanged</gl:ColorType>
                    <gl:FlipMode>Vertical</gl:FlipMode>
                  </gl:TextureConfiguration>
                  <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                    <gl:Name>fwn2</gl:Name>
                    <gl:Width xsi:nil="true" />
                    <gl:Height xsi:nil="true" />
                    <gl:InternalFormat>Rgba</gl:InternalFormat>
                    <gl:WrapS>Repeat</gl:WrapS>
                    <gl:WrapT>Repeat</gl:WrapT>
                    <gl:MinFilter>Linear</gl:MinFilter>
                    <gl:MagFilter>Linear</gl:MagFilter>
                    <gl:FileName>Textures\fwn2.jpg</gl:FileName>
                    <gl:ColorType>Unchanged</gl:ColorType>
                    <gl:FlipMode>Vertical</gl:FlipMode>
                  </gl:TextureConfiguration>
                  <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                    <gl:Name>fwn3</gl:Name>
                    <gl:Width xsi:nil="true" />
                    <gl:Height xsi:nil="true" />
                    <gl:InternalFormat>Rgba</gl:InternalFormat>
                    <gl:WrapS>Repeat</gl:WrapS>
                    <gl:WrapT>Repeat</gl:WrapT>
                    <gl:MinFilter>Linear</gl:MinFilter>
                    <gl:MagFilter>Linear</gl:MagFilter>
                    <gl:FileName>Textures\fwn3.jpg</gl:FileName>
                    <gl:ColorType>Unchanged</gl:ColorType>
                    <gl:FlipMode>Vertical</gl:FlipMode>
                  </gl:TextureConfiguration>
                  <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                    <gl:Name>fwn4</gl:Name>
                    <gl:Width xsi:nil="true" />
                    <gl:Height xsi:nil="true" />
                    <gl:InternalFormat>Rgba</gl:InternalFormat>
                    <gl:WrapS>Repeat</gl:WrapS>
                    <gl:WrapT>Repeat</gl:WrapT>
                    <gl:MinFilter>Linear</gl:MinFilter>
                    <gl:MagFilter>Linear</gl:MagFilter>
                    <gl:FileName>Textures\fwn4.jpg</gl:FileName>
                    <gl:ColorType>Unchanged</gl:ColorType>
                    <gl:FlipMode>Vertical</gl:FlipMode>
                  </gl:TextureConfiguration>
                  <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                    <gl:Name>grayEnd</gl:Name>
                    <gl:Width xsi:nil="true" />
                    <gl:Height xsi:nil="true" />
                    <gl:InternalFormat>Rgba</gl:InternalFormat>
                    <gl:WrapS>Repeat</gl:WrapS>
                    <gl:WrapT>Repeat</gl:WrapT>
                    <gl:MinFilter>Linear</gl:MinFilter>
                    <gl:MagFilter>Linear</gl:MagFilter>
                    <gl:FileName>Textures\grayEnd.jpg</gl:FileName>
                    <gl:ColorType>Unchanged</gl:ColorType>
                    <gl:FlipMode>Vertical</gl:FlipMode>
                  </gl:TextureConfiguration>
                  <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                    <gl:Name>horGrat</gl:Name>
                    <gl:Width xsi:nil="true" />
                    <gl:Height xsi:nil="true" />
                    <gl:InternalFormat>Rgba</gl:InternalFormat>
                    <gl:WrapS>Repeat</gl:WrapS>
                    <gl:WrapT>Repeat</gl:WrapT>
                    <gl:MinFilter>Linear</gl:MinFilter>
                    <gl:MagFilter>Linear</gl:MagFilter>
                    <gl:FileName>Textures\horGrat.jpg</gl:FileName>
                    <gl:ColorType>Unchanged</gl:ColorType>
                    <gl:FlipMode>Vertical</gl:FlipMode>
                  </gl:TextureConfiguration>
                  <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                    <gl:Name>plaid</gl:Name>
                    <gl:Width xsi:nil="true" />
                    <gl:Height xsi:nil="true" />
                    <gl:InternalFormat>Rgba</gl:InternalFormat>
                    <gl:WrapS>Repeat</gl:WrapS>
                    <gl:WrapT>Repeat</gl:WrapT>
                    <gl:MinFilter>Linear</gl:MinFilter>
                    <gl:MagFilter>Linear</gl:MagFilter>
                    <gl:FileName>Textures\plaid.jpg</gl:FileName>
                    <gl:ColorType>Unchanged</gl:ColorType>
                    <gl:FlipMode>Vertical</gl:FlipMode>
                  </gl:TextureConfiguration>
                  <gl:TextureConfiguration xsi:type="gl:ImageTexture">
                    <gl:Name>vertGrat</gl:Name>
                    <gl:Width xsi:nil="true" />
                    <gl:Height xsi:nil="true" />
                    <gl:InternalFormat>Rgba</gl:InternalFormat>
                    <gl:WrapS>Repeat</gl:WrapS>
                    <gl:WrapT>Repeat</gl:WrapT>
                    <gl:MinFilter>Linear</gl:MinFilter>
                    <gl:MagFilter>Linear</gl:MagFilter>
                    <gl:FileName>Textures\vertGrat.jpg</gl:FileName>
                    <gl:ColorType>Unchanged</gl:ColorType>
                    <gl:FlipMode>Vertical</gl:FlipMode>
                  </gl:TextureConfiguration>
                </gl:Textures>
              </Combinator>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="res:LoadResources" />
            </Expression>
            <Expression xsi:type="Disable">
              <Builder xsi:type="Combinator">
                <Combinator xsi:type="wie:MouseMove" />
              </Builder>
            </Expression>
            <Expression xsi:type="Disable">
              <Builder xsi:type="MemberSelector">
                <Selector>Y</Selector>
              </Builder>
            </Expression>
            <Expression xsi:type="Disable">
              <Builder xsi:type="Combinator">
                <Combinator xsi:type="dsp:Rescale">
                  <dsp:Min>0</dsp:Min>
                  <dsp:Max>2000</dsp:Max>
                  <dsp:RangeMin>0</dsp:RangeMin>
                  <dsp:RangeMax>10</dsp:RangeMax>
                  <dsp:RescaleType>Linear</dsp:RescaleType>
                </Combinator>
              </Builder>
            </Expression>
            <Expression xsi:type="Disable">
              <Builder xsi:type="Combinator">
                <Combinator xsi:type="gl:LatestOnUpdateFrame" />
              </Builder>
            </Expression>
            <Expression xsi:type="Disable">
              <Builder xsi:type="PublishSubject">
                <Name>MouseZ</Name>
              </Builder>
            </Expression>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="ScreenCalibFile" Category="Calibrations" />
              <Property Name="GammaCalibFile" Category="Calibrations" />
            </Expression>
            <Expression xsi:type="GroupWorkflow">
              <Name>CalibrationFiles</Name>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="FileName" DisplayName="ScreenCalibFile" Category="Calibration" />
                  </Expression>
                  <Expression xsi:type="io:CsvReader">
                    <io:FileName>D:\code\vis-stim-depth\Calibrations\monitor_calibration.csv</io:FileName>
                    <io:ListSeparator>,</io:ListSeparator>
                    <io:ScanPattern>%f</io:ScanPattern>
                    <io:SkipRows>1</io:SkipRows>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:ToArray" />
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Expression>new(
it[0] as Screen1_params,
it[1] as Screen2_params,
it[2] as Screen3_params,
it[3] as Screen4_params
)</scr:Expression>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Screen1_params</Selector>
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Expression>new(
it[0] as Height,
it[1] as Width,
it[2] as RotationX,
-it[3] as RotationY,
it[4] as RotationZ,
it[5] as TranslationX,
it[6] as TranslationY,
-it[7] as TranslationZ,
it[8] as ViewportWidth,
it[9] as ViewportX
)

</scr:Expression>
                  </Expression>
                  <Expression xsi:type="ReplaySubject">
                    <Name>Screen1pos</Name>
                    <BufferSize xsi:nil="true" />
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Screen2_params</Selector>
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Expression>new(
it[0] as Height,
it[1] as Width,
it[2] as RotationX,
-it[3] as RotationY,
it[4] as RotationZ,
it[5] as TranslationX,
it[6] as TranslationY,
-it[7] as TranslationZ,
it[8] as ViewportWidth,
it[9] as ViewportX
)

</scr:Expression>
                  </Expression>
                  <Expression xsi:type="ReplaySubject">
                    <Name>Screen2pos</Name>
                    <BufferSize xsi:nil="true" />
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Screen3_params</Selector>
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Expression>new(
it[0] as Height,
it[1] as Width,
it[2] as RotationX,
-it[3] as RotationY,
it[4] as RotationZ,
it[5] as TranslationX,
it[6] as TranslationY,
-it[7] as TranslationZ,
it[8] as ViewportWidth,
it[9] as ViewportX
)

</scr:Expression>
                  </Expression>
                  <Expression xsi:type="ReplaySubject">
                    <Name>Screen3pos</Name>
                    <BufferSize xsi:nil="true" />
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Screen4_params</Selector>
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Expression>new(
it[0] as Height,
it[1] as Width,
it[2] as RotationX,
-it[3] as RotationY,
it[4] as RotationZ,
it[5] as TranslationX,
it[6] as TranslationY,
-it[7] as TranslationZ,
it[8] as ViewportWidth,
it[9] as ViewportX
)

</scr:Expression>
                  </Expression>
                  <Expression xsi:type="ReplaySubject">
                    <Name>Screen4pos</Name>
                    <BufferSize xsi:nil="true" />
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="FileName" DisplayName="GammaCalibFile" Category="Calibration" />
                  </Expression>
                  <Expression xsi:type="io:CsvReader">
                    <io:FileName>D:\code\vis-stim-depth\Calibrations\gamma_calibration.csv</io:FileName>
                    <io:ListSeparator />
                    <io:ScanPattern>%s</io:ScanPattern>
                    <io:SkipRows>0</io:SkipRows>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:ToArray" />
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Expression>new(
it[0] as Screen1_gammalut,
it[1] as Screen2_gammalut,
it[2] as Screen3_gammalut,
it[3] as Screen4_gammalut
)</scr:Expression>
                  </Expression>
                  <Expression xsi:type="ReplaySubject">
                    <Name>GammaLut</Name>
                    <BufferSize xsi:nil="true" />
                  </Expression>
                </Nodes>
                <Edges>
                  <Edge From="0" To="1" Label="Source1" />
                  <Edge From="1" To="2" Label="Source1" />
                  <Edge From="2" To="3" Label="Source1" />
                  <Edge From="3" To="4" Label="Source1" />
                  <Edge From="3" To="7" Label="Source1" />
                  <Edge From="3" To="10" Label="Source1" />
                  <Edge From="3" To="13" Label="Source1" />
                  <Edge From="4" To="5" Label="Source1" />
                  <Edge From="5" To="6" Label="Source1" />
                  <Edge From="7" To="8" Label="Source1" />
                  <Edge From="8" To="9" Label="Source1" />
                  <Edge From="10" To="11" Label="Source1" />
                  <Edge From="11" To="12" Label="Source1" />
                  <Edge From="13" To="14" Label="Source1" />
                  <Edge From="14" To="15" Label="Source1" />
                  <Edge From="16" To="17" Label="Source1" />
                  <Edge From="17" To="18" Label="Source1" />
                  <Edge From="18" To="19" Label="Source1" />
                  <Edge From="19" To="20" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="GroupWorkflow">
              <Name>SetMouseZ</Name>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>Mouse Distance</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:UpdateFrame" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:WithLatestFrom" />
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Item2</Selector>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="IncludeWorkflow" Path="BonVision:Primitives.RangeAnimation.bonsai">
                      <Duration>100</Duration>
                      <RangeBegin>0</RangeBegin>
                      <RangeEnd>500</RangeEnd>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="PublishSubject">
                    <Name>MouseZ</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>MouseZ</Name>
                  </Expression>
                  <Expression xsi:type="ReplaySubject">
                    <Name>MouseZClose</Name>
                    <BufferSize xsi:nil="true" />
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>CloseLoopDuration</Name>
                  </Expression>
                  <Expression xsi:type="PropertyMapping">
                    <PropertyMappings>
                      <Property Name="DueTime" />
                    </PropertyMappings>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:Timer">
                      <gl:DueTime>PT3M20S</gl:DueTime>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:TakeUntil" />
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>MouseZ</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>OpenLoopStartTime</Name>
                  </Expression>
                  <Expression xsi:type="PropertyMapping">
                    <PropertyMappings>
                      <Property Name="DueTime" />
                    </PropertyMappings>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:Timer">
                      <gl:DueTime>PT3M25S</gl:DueTime>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Sample" />
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>MouseZOpenStart</Name>
                  </Expression>
                </Nodes>
                <Edges>
                  <Edge From="0" To="2" Label="Source2" />
                  <Edge From="1" To="2" Label="Source1" />
                  <Edge From="2" To="3" Label="Source1" />
                  <Edge From="3" To="4" Label="Source1" />
                  <Edge From="4" To="5" Label="Source1" />
                  <Edge From="6" To="7" Label="Source1" />
                  <Edge From="7" To="11" Label="Source1" />
                  <Edge From="8" To="9" Label="Source1" />
                  <Edge From="9" To="10" Label="Source1" />
                  <Edge From="10" To="11" Label="Source2" />
                  <Edge From="12" To="16" Label="Source1" />
                  <Edge From="13" To="14" Label="Source1" />
                  <Edge From="14" To="15" Label="Source1" />
                  <Edge From="15" To="16" Label="Source2" />
                  <Edge From="16" To="17" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="GroupWorkflow">
              <Name>MouseDistance</Name>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>MouseZClose</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>MouseZClose</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>OpenLoopStartTime</Name>
                  </Expression>
                  <Expression xsi:type="PropertyMapping">
                    <PropertyMappings>
                      <Property Name="DueTime" />
                    </PropertyMappings>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:Delay">
                      <gl:DueTime>PT3M25S</gl:DueTime>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>MouseZOpenStart</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:WithLatestFrom" />
                  </Expression>
                  <Expression xsi:type="Add" />
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Merge" />
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Name>Rename1</scr:Name>
                    <scr:Expression>new(
0 as X,
0 as Y,
it as EyeZ)</scr:Expression>
                  </Expression>
                  <Expression xsi:type="WorkflowOutput" />
                </Nodes>
                <Edges>
                  <Edge From="0" To="8" Label="Source1" />
                  <Edge From="1" To="4" Label="Source1" />
                  <Edge From="2" To="3" Label="Source1" />
                  <Edge From="3" To="4" Label="Source2" />
                  <Edge From="4" To="6" Label="Source1" />
                  <Edge From="5" To="6" Label="Source2" />
                  <Edge From="6" To="7" Label="Source1" />
                  <Edge From="7" To="8" Label="Source2" />
                  <Edge From="8" To="9" Label="Source1" />
                  <Edge From="9" To="10" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="PublishSubject">
              <Name>Eye</Name>
            </Expression>
            <Expression xsi:type="PropertyMapping">
              <PropertyMappings>
                <Property Name="Eye" Selector="X,Y,EyeZ" />
              </PropertyMappings>
            </Expression>
            <Expression xsi:type="GroupWorkflow">
              <Name>SetViewports</Name>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:RenderFrame" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:UpdateViewportState">
                      <gl:X>0</gl:X>
                      <gl:Y>0</gl:Y>
                      <gl:Width>1</gl:Width>
                      <gl:Height>1</gl:Height>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="SubscribeSubject">
                      <Name>Screen1pos</Name>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="SubscribeSubject">
                      <Name>Screen2pos</Name>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="SubscribeSubject">
                      <Name>Screen3pos</Name>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="SubscribeSubject">
                      <Name>Screen4pos</Name>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="SubscribeSubject">
                      <Name>GammaLut</Name>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="MemberSelector">
                      <Selector>Screen1_gammalut</Selector>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="SubscribeSubject">
                      <Name>GammaLut</Name>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="MemberSelector">
                      <Selector>Screen2_gammalut</Selector>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="SubscribeSubject">
                      <Name>GammaLut</Name>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="MemberSelector">
                      <Selector>Screen3_gammalut</Selector>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="SubscribeSubject">
                      <Name>GammaLut</Name>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="MemberSelector">
                      <Selector>Screen4_gammalut</Selector>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="SubscribeSubject">
                      <Name>Screen1pos</Name>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="SubscribeSubject">
                      <Name>Screen2pos</Name>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="SubscribeSubject">
                      <Name>Screen3pos</Name>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="SubscribeSubject">
                      <Name>Screen4pos</Name>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Eye" />
                  </Expression>
                  <Expression xsi:type="IncludeWorkflow" Path="BonVision:Environment.CubemapView.bonsai">
                    <Eye>
                      <X>0</X>
                      <Y>0</Y>
                      <Z>0</Z>
                    </Eye>
                    <NearClip>0.1</NearClip>
                    <FarClip>1000</FarClip>
                    <Light>
                      <X>0</X>
                      <Y>0</Y>
                      <Z>0</Z>
                    </Light>
                  </Expression>
                  <Expression xsi:type="PublishSubject">
                    <Name>Draw</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:RenderCubemap">
                      <gl:RenderState />
                      <gl:ClearColor>Gray</gl:ClearColor>
                      <gl:ClearMask>DepthBufferBit ColorBufferBit</gl:ClearMask>
                      <gl:FaceSize xsi:nil="true" />
                      <gl:InternalFormat>Rgb</gl:InternalFormat>
                      <gl:MinFilter>Linear</gl:MinFilter>
                      <gl:MagFilter>Linear</gl:MagFilter>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="Combinator">
                      <Combinator xsi:type="rx:CombineLatest" />
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="InputMapping">
                      <PropertyMappings>
                        <Property Name="Width" Selector="Item2.Width" />
                        <Property Name="Height" Selector="Item2.Height" />
                        <Property Name="Rotation" Selector="Item2.RotationX,Item2.RotationY,Item2.RotationZ" />
                        <Property Name="Translation" Selector="Item2.TranslationX,Item2.TranslationY,Item2.TranslationZ" />
                      </PropertyMappings>
                      <Selector>Item1</Selector>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="IncludeWorkflow" Path="BonVision:Environment.ViewWindow.bonsai">
                    <Width>29.296875</Width>
                    <Height>52.0833321</Height>
                    <Rotation>
                      <X>0.00062900001648813486</X>
                      <Y>-1.5299999713897705</Y>
                      <Z>0.0082700001075863838</Z>
                    </Rotation>
                    <Translation>
                      <X>-27</X>
                      <Y>-0.11900000274181366</Y>
                      <Z>0.79100000858306885</Z>
                    </Translation>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="Combinator">
                      <Combinator xsi:type="rx:CombineLatest" />
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="InputMapping">
                      <PropertyMappings>
                        <Property Name="GammaLut" Selector="Item2" />
                      </PropertyMappings>
                      <Selector>Item1</Selector>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="GroupWorkflow">
                    <Name>GammaCorrection</Name>
                    <Description>Renders the current scene to a texture and applies gamma correction as a post-processing effect.</Description>
                    <Workflow>
                      <Nodes>
                        <Expression xsi:type="WorkflowInput">
                          <Name>Source1</Name>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:UpdateViewportState">
                            <gl:X>0</gl:X>
                            <gl:Y>0</gl:Y>
                            <gl:Width>1</gl:Width>
                            <gl:Height>1</gl:Height>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="ExternalizedProperty">
                          <MemberName>ClearColor</MemberName>
                          <Name>ClearColor</Name>
                          <Category>Misc</Category>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:RenderTexture">
                            <gl:RenderState />
                            <gl:ClearColor>Gray</gl:ClearColor>
                            <gl:ClearMask>DepthBufferBit ColorBufferBit</gl:ClearMask>
                            <gl:Width xsi:nil="true" />
                            <gl:Height xsi:nil="true" />
                            <gl:InternalFormat>Rgb</gl:InternalFormat>
                            <gl:WrapS>ClampToEdge</gl:WrapS>
                            <gl:WrapT>ClampToEdge</gl:WrapT>
                            <gl:MinFilter>Linear</gl:MinFilter>
                            <gl:MagFilter>Linear</gl:MagFilter>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:BindTexture">
                            <gl:TextureSlot>Texture0</gl:TextureSlot>
                            <gl:ShaderName>Gamma</gl:ShaderName>
                            <gl:TextureTarget>Texture2D</gl:TextureTarget>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="ExternalizedProperty">
                          <MemberName>Value</MemberName>
                          <Name>GammaLut</Name>
                        </Expression>
                        <Expression xsi:type="PropertySource" TypeArguments="gl:LoadImage,sys:String">
                          <MemberName>FileName</MemberName>
                          <Value>D:\code\vis-stim-depth\Calibrations\calibration210305\gammalut_gray_Scr01.bmp</Value>
                        </Expression>
                        <Expression xsi:type="InputMapping">
                          <PropertyMappings>
                            <Property Name="FileName" />
                          </PropertyMappings>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:LoadImage">
                            <gl:Width xsi:nil="true" />
                            <gl:Height xsi:nil="true" />
                            <gl:InternalFormat>Rgba</gl:InternalFormat>
                            <gl:WrapS>ClampToEdge</gl:WrapS>
                            <gl:WrapT>ClampToEdge</gl:WrapT>
                            <gl:MinFilter>Linear</gl:MinFilter>
                            <gl:MagFilter>Linear</gl:MagFilter>
                            <gl:FileName>D:\code\vis-stim-depth\Calibrations\calibration210305\gammalut_gray_Scr01.bmp</gl:FileName>
                            <gl:ColorType>Unchanged</gl:ColorType>
                            <gl:FlipMode>Vertical</gl:FlipMode>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="rx:WithLatestFrom" />
                        </Expression>
                        <Expression xsi:type="MemberSelector">
                          <Selector>Item2</Selector>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:BindTexture">
                            <gl:TextureSlot>Texture1</gl:TextureSlot>
                            <gl:ShaderName>Gamma</gl:ShaderName>
                            <gl:TextureTarget>Texture2D</gl:TextureTarget>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:DrawMesh">
                            <gl:ShaderName>Gamma</gl:ShaderName>
                            <gl:MeshName>ViewportQuad</gl:MeshName>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="WorkflowOutput" />
                      </Nodes>
                      <Edges>
                        <Edge From="0" To="1" Label="Source1" />
                        <Edge From="1" To="3" Label="Source1" />
                        <Edge From="2" To="3" Label="Source2" />
                        <Edge From="3" To="4" Label="Source1" />
                        <Edge From="4" To="9" Label="Source1" />
                        <Edge From="5" To="6" Label="Source1" />
                        <Edge From="6" To="7" Label="Source1" />
                        <Edge From="7" To="8" Label="Source1" />
                        <Edge From="8" To="9" Label="Source2" />
                        <Edge From="9" To="10" Label="Source1" />
                        <Edge From="10" To="11" Label="Source1" />
                        <Edge From="11" To="12" Label="Source1" />
                        <Edge From="12" To="13" Label="Source1" />
                      </Edges>
                    </Workflow>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="Combinator">
                      <Combinator xsi:type="rx:CombineLatest" />
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="InputMapping">
                      <PropertyMappings>
                        <Property Name="X" Selector="Item2.ViewportX" />
                        <Property Name="Width" Selector="Item2.ViewportWidth" />
                      </PropertyMappings>
                      <Selector>Item1</Selector>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="IncludeWorkflow" Path="BonVision:Environment.DrawViewport.bonsai">
                    <X>0</X>
                    <Y>0</Y>
                    <Width>0.25</Width>
                    <Height>1</Height>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="Combinator">
                      <Combinator xsi:type="rx:CombineLatest" />
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="InputMapping">
                      <PropertyMappings>
                        <Property Name="Width" Selector="Item2.Width" />
                        <Property Name="Height" Selector="Item2.Height" />
                        <Property Name="Rotation" Selector="Item2.RotationX,Item2.RotationY,Item2.RotationZ" />
                        <Property Name="Translation" Selector="Item2.TranslationX,Item2.TranslationY,Item2.TranslationZ" />
                      </PropertyMappings>
                      <Selector>Item1</Selector>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="IncludeWorkflow" Path="BonVision:Environment.ViewWindow.bonsai">
                    <Width>29.296875</Width>
                    <Height>52.0833321</Height>
                    <Rotation>
                      <X>0.0017999999690800905</X>
                      <Y>-0.47299998998641968</Y>
                      <Z>0.018699999898672104</Z>
                    </Rotation>
                    <Translation>
                      <X>-13.300000190734863</X>
                      <Y>0.29100000858306885</Y>
                      <Z>23.5</Z>
                    </Translation>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="Combinator">
                      <Combinator xsi:type="rx:CombineLatest" />
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="InputMapping">
                      <PropertyMappings>
                        <Property Name="GammaLut" Selector="Item2" />
                      </PropertyMappings>
                      <Selector>Item1</Selector>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="GroupWorkflow">
                    <Name>GammaCorrection</Name>
                    <Description>Renders the current scene to a texture and applies gamma correction as a post-processing effect.</Description>
                    <Workflow>
                      <Nodes>
                        <Expression xsi:type="WorkflowInput">
                          <Name>Source1</Name>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:UpdateViewportState">
                            <gl:X>0</gl:X>
                            <gl:Y>0</gl:Y>
                            <gl:Width>1</gl:Width>
                            <gl:Height>1</gl:Height>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="ExternalizedProperty">
                          <MemberName>ClearColor</MemberName>
                          <Name>ClearColor</Name>
                          <Category>Misc</Category>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:RenderTexture">
                            <gl:RenderState />
                            <gl:ClearColor>Gray</gl:ClearColor>
                            <gl:ClearMask>DepthBufferBit ColorBufferBit</gl:ClearMask>
                            <gl:Width xsi:nil="true" />
                            <gl:Height xsi:nil="true" />
                            <gl:InternalFormat>Rgb</gl:InternalFormat>
                            <gl:WrapS>ClampToEdge</gl:WrapS>
                            <gl:WrapT>ClampToEdge</gl:WrapT>
                            <gl:MinFilter>Linear</gl:MinFilter>
                            <gl:MagFilter>Linear</gl:MagFilter>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:BindTexture">
                            <gl:TextureSlot>Texture0</gl:TextureSlot>
                            <gl:ShaderName>Gamma</gl:ShaderName>
                            <gl:TextureTarget>Texture2D</gl:TextureTarget>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="ExternalizedProperty">
                          <MemberName>Value</MemberName>
                          <Name>GammaLut</Name>
                        </Expression>
                        <Expression xsi:type="PropertySource" TypeArguments="gl:LoadImage,sys:String">
                          <MemberName>FileName</MemberName>
                          <Value>D:\code\vis-stim-depth\Calibrations\calibration210305\gammalut_gray_Scr02.bmp</Value>
                        </Expression>
                        <Expression xsi:type="InputMapping">
                          <PropertyMappings>
                            <Property Name="FileName" />
                          </PropertyMappings>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:LoadImage">
                            <gl:Width xsi:nil="true" />
                            <gl:Height xsi:nil="true" />
                            <gl:InternalFormat>Rgba</gl:InternalFormat>
                            <gl:WrapS>ClampToEdge</gl:WrapS>
                            <gl:WrapT>ClampToEdge</gl:WrapT>
                            <gl:MinFilter>Linear</gl:MinFilter>
                            <gl:MagFilter>Linear</gl:MagFilter>
                            <gl:FileName>D:\code\vis-stim-depth\Calibrations\calibration210305\gammalut_gray_Scr02.bmp</gl:FileName>
                            <gl:ColorType>Unchanged</gl:ColorType>
                            <gl:FlipMode>Vertical</gl:FlipMode>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="rx:WithLatestFrom" />
                        </Expression>
                        <Expression xsi:type="MemberSelector">
                          <Selector>Item2</Selector>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:BindTexture">
                            <gl:TextureSlot>Texture1</gl:TextureSlot>
                            <gl:ShaderName>Gamma</gl:ShaderName>
                            <gl:TextureTarget>Texture2D</gl:TextureTarget>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:DrawMesh">
                            <gl:ShaderName>Gamma</gl:ShaderName>
                            <gl:MeshName>ViewportQuad</gl:MeshName>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="WorkflowOutput" />
                      </Nodes>
                      <Edges>
                        <Edge From="0" To="1" Label="Source1" />
                        <Edge From="1" To="3" Label="Source1" />
                        <Edge From="2" To="3" Label="Source2" />
                        <Edge From="3" To="4" Label="Source1" />
                        <Edge From="4" To="9" Label="Source1" />
                        <Edge From="5" To="6" Label="Source1" />
                        <Edge From="6" To="7" Label="Source1" />
                        <Edge From="7" To="8" Label="Source1" />
                        <Edge From="8" To="9" Label="Source2" />
                        <Edge From="9" To="10" Label="Source1" />
                        <Edge From="10" To="11" Label="Source1" />
                        <Edge From="11" To="12" Label="Source1" />
                        <Edge From="12" To="13" Label="Source1" />
                      </Edges>
                    </Workflow>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="Combinator">
                      <Combinator xsi:type="rx:CombineLatest" />
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="InputMapping">
                      <PropertyMappings>
                        <Property Name="X" Selector="Item2.ViewportX" />
                        <Property Name="Width" Selector="Item2.ViewportWidth" />
                      </PropertyMappings>
                      <Selector>Item1</Selector>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="IncludeWorkflow" Path="BonVision:Environment.DrawViewport.bonsai">
                    <X>0.25</X>
                    <Y>0</Y>
                    <Width>0.25</Width>
                    <Height>1</Height>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="Combinator">
                      <Combinator xsi:type="rx:CombineLatest" />
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="InputMapping">
                      <PropertyMappings>
                        <Property Name="Width" Selector="Item2.Width" />
                        <Property Name="Height" Selector="Item2.Height" />
                        <Property Name="Rotation" Selector="Item2.RotationX,Item2.RotationY,Item2.RotationZ" />
                        <Property Name="Translation" Selector="Item2.TranslationX,Item2.TranslationY,Item2.TranslationZ" />
                      </PropertyMappings>
                      <Selector>Item1</Selector>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="IncludeWorkflow" Path="BonVision:Environment.ViewWindow.bonsai">
                    <Width>29.296875</Width>
                    <Height>52.0833321</Height>
                    <Rotation>
                      <X>0.014499999582767487</X>
                      <Y>0.42399999499320984</Y>
                      <Z>0.008320000022649765</Z>
                    </Rotation>
                    <Translation>
                      <X>16.200000762939453</X>
                      <Y>0.51899999380111694</Y>
                      <Z>21.299999237060547</Z>
                    </Translation>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="Combinator">
                      <Combinator xsi:type="rx:CombineLatest" />
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="InputMapping">
                      <PropertyMappings>
                        <Property Name="GammaLut" Selector="Item2" />
                      </PropertyMappings>
                      <Selector>Item1</Selector>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="GroupWorkflow">
                    <Name>GammaCorrection</Name>
                    <Description>Renders the current scene to a texture and applies gamma correction as a post-processing effect.</Description>
                    <Workflow>
                      <Nodes>
                        <Expression xsi:type="WorkflowInput">
                          <Name>Source1</Name>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:UpdateViewportState">
                            <gl:X>0</gl:X>
                            <gl:Y>0</gl:Y>
                            <gl:Width>1</gl:Width>
                            <gl:Height>1</gl:Height>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="ExternalizedProperty">
                          <MemberName>ClearColor</MemberName>
                          <Name>ClearColor</Name>
                          <Category>Misc</Category>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:RenderTexture">
                            <gl:RenderState />
                            <gl:ClearColor>Gray</gl:ClearColor>
                            <gl:ClearMask>DepthBufferBit ColorBufferBit</gl:ClearMask>
                            <gl:Width xsi:nil="true" />
                            <gl:Height xsi:nil="true" />
                            <gl:InternalFormat>Rgb</gl:InternalFormat>
                            <gl:WrapS>ClampToEdge</gl:WrapS>
                            <gl:WrapT>ClampToEdge</gl:WrapT>
                            <gl:MinFilter>Linear</gl:MinFilter>
                            <gl:MagFilter>Linear</gl:MagFilter>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:BindTexture">
                            <gl:TextureSlot>Texture0</gl:TextureSlot>
                            <gl:ShaderName>Gamma</gl:ShaderName>
                            <gl:TextureTarget>Texture2D</gl:TextureTarget>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="ExternalizedProperty">
                          <MemberName>Value</MemberName>
                          <Name>GammaLut</Name>
                        </Expression>
                        <Expression xsi:type="PropertySource" TypeArguments="gl:LoadImage,sys:String">
                          <MemberName>FileName</MemberName>
                          <Value>D:\code\vis-stim-depth\Calibrations\calibration210305\gammalut_gray_Scr03.bmp</Value>
                        </Expression>
                        <Expression xsi:type="InputMapping">
                          <PropertyMappings>
                            <Property Name="FileName" />
                          </PropertyMappings>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:LoadImage">
                            <gl:Width xsi:nil="true" />
                            <gl:Height xsi:nil="true" />
                            <gl:InternalFormat>Rgba</gl:InternalFormat>
                            <gl:WrapS>ClampToEdge</gl:WrapS>
                            <gl:WrapT>ClampToEdge</gl:WrapT>
                            <gl:MinFilter>Linear</gl:MinFilter>
                            <gl:MagFilter>Linear</gl:MagFilter>
                            <gl:FileName>D:\code\vis-stim-depth\Calibrations\calibration210305\gammalut_gray_Scr03.bmp</gl:FileName>
                            <gl:ColorType>Unchanged</gl:ColorType>
                            <gl:FlipMode>Vertical</gl:FlipMode>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="rx:WithLatestFrom" />
                        </Expression>
                        <Expression xsi:type="MemberSelector">
                          <Selector>Item2</Selector>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:BindTexture">
                            <gl:TextureSlot>Texture1</gl:TextureSlot>
                            <gl:ShaderName>Gamma</gl:ShaderName>
                            <gl:TextureTarget>Texture2D</gl:TextureTarget>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:DrawMesh">
                            <gl:ShaderName>Gamma</gl:ShaderName>
                            <gl:MeshName>ViewportQuad</gl:MeshName>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="WorkflowOutput" />
                      </Nodes>
                      <Edges>
                        <Edge From="0" To="1" Label="Source1" />
                        <Edge From="1" To="3" Label="Source1" />
                        <Edge From="2" To="3" Label="Source2" />
                        <Edge From="3" To="4" Label="Source1" />
                        <Edge From="4" To="9" Label="Source1" />
                        <Edge From="5" To="6" Label="Source1" />
                        <Edge From="6" To="7" Label="Source1" />
                        <Edge From="7" To="8" Label="Source1" />
                        <Edge From="8" To="9" Label="Source2" />
                        <Edge From="9" To="10" Label="Source1" />
                        <Edge From="10" To="11" Label="Source1" />
                        <Edge From="11" To="12" Label="Source1" />
                        <Edge From="12" To="13" Label="Source1" />
                      </Edges>
                    </Workflow>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="Combinator">
                      <Combinator xsi:type="rx:CombineLatest" />
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="InputMapping">
                      <PropertyMappings>
                        <Property Name="X" Selector="Item2.ViewportX" />
                        <Property Name="Width" Selector="Item2.ViewportWidth" />
                      </PropertyMappings>
                      <Selector>Item1</Selector>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="IncludeWorkflow" Path="BonVision:Environment.DrawViewport.bonsai">
                    <X>0.5</X>
                    <Y>0</Y>
                    <Width>0.25</Width>
                    <Height>1</Height>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="Combinator">
                      <Combinator xsi:type="rx:CombineLatest" />
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="InputMapping">
                      <PropertyMappings>
                        <Property Name="Width" Selector="Item2.Width" />
                        <Property Name="Height" Selector="Item2.Height" />
                        <Property Name="Rotation" Selector="Item2.RotationX,Item2.RotationY,Item2.RotationZ" />
                        <Property Name="Translation" Selector="Item2.TranslationX,Item2.TranslationY,Item2.TranslationZ" />
                      </PropertyMappings>
                      <Selector>Item1</Selector>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="IncludeWorkflow" Path="BonVision:Environment.ViewWindow.bonsai">
                    <Width>29.296875</Width>
                    <Height>52.0833321</Height>
                    <Rotation>
                      <X>0.0082000000402331352</X>
                      <Y>1.5900000333786011</Y>
                      <Z>-0.0019099999917671084</Z>
                    </Rotation>
                    <Translation>
                      <X>29.5</X>
                      <Y>0.41800001263618469</Y>
                      <Z>-0.65100002288818359</Z>
                    </Translation>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="Combinator">
                      <Combinator xsi:type="rx:CombineLatest" />
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="InputMapping">
                      <PropertyMappings>
                        <Property Name="GammaLut" Selector="Item2" />
                      </PropertyMappings>
                      <Selector>Item1</Selector>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="GroupWorkflow">
                    <Name>GammaCorrection</Name>
                    <Description>Renders the current scene to a texture and applies gamma correction as a post-processing effect.</Description>
                    <Workflow>
                      <Nodes>
                        <Expression xsi:type="WorkflowInput">
                          <Name>Source1</Name>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:UpdateViewportState">
                            <gl:X>0</gl:X>
                            <gl:Y>0</gl:Y>
                            <gl:Width>1</gl:Width>
                            <gl:Height>1</gl:Height>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="ExternalizedProperty">
                          <MemberName>ClearColor</MemberName>
                          <Name>ClearColor</Name>
                          <Category>Misc</Category>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:RenderTexture">
                            <gl:RenderState />
                            <gl:ClearColor>Gray</gl:ClearColor>
                            <gl:ClearMask>DepthBufferBit ColorBufferBit</gl:ClearMask>
                            <gl:Width xsi:nil="true" />
                            <gl:Height xsi:nil="true" />
                            <gl:InternalFormat>Rgb</gl:InternalFormat>
                            <gl:WrapS>ClampToEdge</gl:WrapS>
                            <gl:WrapT>ClampToEdge</gl:WrapT>
                            <gl:MinFilter>Linear</gl:MinFilter>
                            <gl:MagFilter>Linear</gl:MagFilter>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:BindTexture">
                            <gl:TextureSlot>Texture0</gl:TextureSlot>
                            <gl:ShaderName>Gamma</gl:ShaderName>
                            <gl:TextureTarget>Texture2D</gl:TextureTarget>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="ExternalizedProperty">
                          <MemberName>Value</MemberName>
                          <Name>GammaLut</Name>
                        </Expression>
                        <Expression xsi:type="PropertySource" TypeArguments="gl:LoadImage,sys:String">
                          <MemberName>FileName</MemberName>
                          <Value>D:\code\vis-stim-depth\Calibrations\calibration210305\gammalut_gray_Scr04.bmp</Value>
                        </Expression>
                        <Expression xsi:type="InputMapping">
                          <PropertyMappings>
                            <Property Name="FileName" />
                          </PropertyMappings>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:LoadImage">
                            <gl:Width xsi:nil="true" />
                            <gl:Height xsi:nil="true" />
                            <gl:InternalFormat>Rgba</gl:InternalFormat>
                            <gl:WrapS>ClampToEdge</gl:WrapS>
                            <gl:WrapT>ClampToEdge</gl:WrapT>
                            <gl:MinFilter>Linear</gl:MinFilter>
                            <gl:MagFilter>Linear</gl:MagFilter>
                            <gl:FileName>D:\code\vis-stim-depth\Calibrations\calibration210305\gammalut_gray_Scr04.bmp</gl:FileName>
                            <gl:ColorType>Unchanged</gl:ColorType>
                            <gl:FlipMode>Vertical</gl:FlipMode>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="rx:WithLatestFrom" />
                        </Expression>
                        <Expression xsi:type="MemberSelector">
                          <Selector>Item2</Selector>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:BindTexture">
                            <gl:TextureSlot>Texture1</gl:TextureSlot>
                            <gl:ShaderName>Gamma</gl:ShaderName>
                            <gl:TextureTarget>Texture2D</gl:TextureTarget>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="gl:DrawMesh">
                            <gl:ShaderName>Gamma</gl:ShaderName>
                            <gl:MeshName>ViewportQuad</gl:MeshName>
                          </Combinator>
                        </Expression>
                        <Expression xsi:type="WorkflowOutput" />
                      </Nodes>
                      <Edges>
                        <Edge From="0" To="1" Label="Source1" />
                        <Edge From="1" To="3" Label="Source1" />
                        <Edge From="2" To="3" Label="Source2" />
                        <Edge From="3" To="4" Label="Source1" />
                        <Edge From="4" To="9" Label="Source1" />
                        <Edge From="5" To="6" Label="Source1" />
                        <Edge From="6" To="7" Label="Source1" />
                        <Edge From="7" To="8" Label="Source1" />
                        <Edge From="8" To="9" Label="Source2" />
                        <Edge From="9" To="10" Label="Source1" />
                        <Edge From="10" To="11" Label="Source1" />
                        <Edge From="11" To="12" Label="Source1" />
                        <Edge From="12" To="13" Label="Source1" />
                      </Edges>
                    </Workflow>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="Combinator">
                      <Combinator xsi:type="rx:CombineLatest" />
                    </Builder>
                  </Expression>
                  <Expression xsi:type="Disable">
                    <Builder xsi:type="InputMapping">
                      <PropertyMappings>
                        <Property Name="X" Selector="Item2.ViewportX" />
                        <Property Name="Width" Selector="Item2.ViewportWidth" />
                      </PropertyMappings>
                      <Selector>Item1</Selector>
                    </Builder>
                  </Expression>
                  <Expression xsi:type="IncludeWorkflow" Path="BonVision:Environment.DrawViewport.bonsai">
                    <X>0.75</X>
                    <Y>0</Y>
                    <Width>0.25</Width>
                    <Height>1</Height>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Zip" />
                  </Expression>
                  <Expression xsi:type="WorkflowOutput" />
                </Nodes>
                <Edges>
                  <Edge From="0" To="1" Label="Source1" />
                  <Edge From="1" To="19" Label="Source1" />
                  <Edge From="2" To="22" Label="Source2" />
                  <Edge From="3" To="31" Label="Source2" />
                  <Edge From="4" To="40" Label="Source2" />
                  <Edge From="5" To="49" Label="Source2" />
                  <Edge From="6" To="7" Label="Source1" />
                  <Edge From="7" To="25" Label="Source2" />
                  <Edge From="8" To="9" Label="Source1" />
                  <Edge From="9" To="34" Label="Source2" />
                  <Edge From="10" To="11" Label="Source1" />
                  <Edge From="11" To="43" Label="Source2" />
                  <Edge From="12" To="13" Label="Source1" />
                  <Edge From="13" To="52" Label="Source2" />
                  <Edge From="14" To="28" Label="Source2" />
                  <Edge From="15" To="37" Label="Source2" />
                  <Edge From="16" To="46" Label="Source2" />
                  <Edge From="17" To="55" Label="Source2" />
                  <Edge From="18" To="19" Label="Source2" />
                  <Edge From="19" To="20" Label="Source1" />
                  <Edge From="20" To="21" Label="Source1" />
                  <Edge From="21" To="22" Label="Source1" />
                  <Edge From="21" To="31" Label="Source1" />
                  <Edge From="21" To="40" Label="Source1" />
                  <Edge From="21" To="49" Label="Source1" />
                  <Edge From="22" To="23" Label="Source1" />
                  <Edge From="23" To="24" Label="Source1" />
                  <Edge From="24" To="25" Label="Source1" />
                  <Edge From="25" To="26" Label="Source1" />
                  <Edge From="26" To="27" Label="Source1" />
                  <Edge From="27" To="28" Label="Source1" />
                  <Edge From="28" To="29" Label="Source1" />
                  <Edge From="29" To="30" Label="Source1" />
                  <Edge From="30" To="58" Label="Source1" />
                  <Edge From="31" To="32" Label="Source1" />
                  <Edge From="32" To="33" Label="Source1" />
                  <Edge From="33" To="34" Label="Source1" />
                  <Edge From="34" To="35" Label="Source1" />
                  <Edge From="35" To="36" Label="Source1" />
                  <Edge From="36" To="37" Label="Source1" />
                  <Edge From="37" To="38" Label="Source1" />
                  <Edge From="38" To="39" Label="Source1" />
                  <Edge From="39" To="58" Label="Source2" />
                  <Edge From="40" To="41" Label="Source1" />
                  <Edge From="41" To="42" Label="Source1" />
                  <Edge From="42" To="43" Label="Source1" />
                  <Edge From="43" To="44" Label="Source1" />
                  <Edge From="44" To="45" Label="Source1" />
                  <Edge From="45" To="46" Label="Source1" />
                  <Edge From="46" To="47" Label="Source1" />
                  <Edge From="47" To="48" Label="Source1" />
                  <Edge From="48" To="58" Label="Source3" />
                  <Edge From="49" To="50" Label="Source1" />
                  <Edge From="50" To="51" Label="Source1" />
                  <Edge From="51" To="52" Label="Source1" />
                  <Edge From="52" To="53" Label="Source1" />
                  <Edge From="53" To="54" Label="Source1" />
                  <Edge From="54" To="55" Label="Source1" />
                  <Edge From="55" To="56" Label="Source1" />
                  <Edge From="56" To="57" Label="Source1" />
                  <Edge From="57" To="58" Label="Source4" />
                  <Edge From="58" To="59" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
          </Nodes>
          <Edges>
            <Edge From="0" To="1" Label="Source1" />
            <Edge From="1" To="2" Label="Source1" />
            <Edge From="2" To="3" Label="Source1" />
            <Edge From="3" To="4" Label="Source1" />
            <Edge From="4" To="5" Label="Source1" />
            <Edge From="5" To="6" Label="Source1" />
            <Edge From="7" To="8" Label="Source1" />
            <Edge From="8" To="9" Label="Source1" />
            <Edge From="9" To="10" Label="Source1" />
            <Edge From="10" To="11" Label="Source1" />
            <Edge From="12" To="13" Label="Source1" />
            <Edge From="15" To="16" Label="Source1" />
            <Edge From="16" To="17" Label="Source1" />
            <Edge From="17" To="18" Label="Source1" />
          </Edges>
        </Workflow>
      </Expression>
      <Expression xsi:type="GroupWorkflow">
        <Name>BasicSettings</Name>
        <Workflow>
          <Nodes>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="Value" DisplayName="CloseLoopDuration" Category="Timings" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="FloatProperty">
                <Value>200</Value>
              </Combinator>
            </Expression>
            <Expression xsi:type="Multiply">
              <Operand xsi:type="FloatProperty">
                <Value>1E+07</Value>
              </Operand>
            </Expression>
            <Expression xsi:type="BehaviorSubject">
              <Name>CloseLoopDuration</Name>
            </Expression>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="Value" DisplayName="InitialDelayReplay" Category="Timings" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="FloatProperty">
                <Value>5</Value>
              </Combinator>
            </Expression>
            <Expression xsi:type="Multiply">
              <Operand xsi:type="FloatProperty">
                <Value>1E+07</Value>
              </Operand>
            </Expression>
            <Expression xsi:type="BehaviorSubject">
              <Name>InitialDelayReplay</Name>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:Zip" />
            </Expression>
            <Expression xsi:type="Add" />
            <Expression xsi:type="BehaviorSubject">
              <Name>OpenLoopStartTime</Name>
            </Expression>
          </Nodes>
          <Edges>
            <Edge From="0" To="1" Label="Source1" />
            <Edge From="1" To="2" Label="Source1" />
            <Edge From="2" To="3" Label="Source1" />
            <Edge From="3" To="8" Label="Source1" />
            <Edge From="4" To="5" Label="Source1" />
            <Edge From="5" To="6" Label="Source1" />
            <Edge From="6" To="7" Label="Source1" />
            <Edge From="7" To="8" Label="Source2" />
            <Edge From="8" To="9" Label="Source1" />
            <Edge From="9" To="10" Label="Source1" />
          </Edges>
        </Workflow>
      </Expression>
      <Expression xsi:type="GroupWorkflow">
        <Name>PhotodiodeQuad</Name>
        <Workflow>
          <Nodes>
            <Expression xsi:type="SubscribeSubject">
              <Name>Draw</Name>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="gl:UpdateFrame" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:ElementIndex" />
            </Expression>
            <Expression xsi:type="MemberSelector">
              <Selector>Index</Selector>
            </Expression>
            <Expression xsi:type="Mod">
              <Operand xsi:type="IntProperty">
                <Value>2</Value>
              </Operand>
            </Expression>
            <Expression xsi:type="PublishSubject">
              <Name>PhotoQuadAmbient</Name>
            </Expression>
            <Expression xsi:type="PropertyMapping">
              <PropertyMappings>
                <Property Name="Ambient" />
              </PropertyMappings>
            </Expression>
            <Expression xsi:type="Disable">
              <Builder xsi:type="Combinator">
                <Combinator xsi:type="gl:UpdateFrame" />
              </Builder>
            </Expression>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="ScaleX" />
              <Property Name="ScaleY" />
              <Property Name="ScaleZ" />
            </Expression>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="Value" DisplayName="PhotoquadX" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="FloatProperty">
                <Value>-25</Value>
              </Combinator>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="num:DegreeToRadian" />
            </Expression>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="Value" DisplayName="PhotoquadY" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="FloatProperty">
                <Value>-37</Value>
              </Combinator>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="num:DegreeToRadian" />
            </Expression>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="Value" DisplayName="PhotoquadZ" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="FloatProperty">
                <Value>5</Value>
              </Combinator>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:Zip" />
            </Expression>
            <Expression xsi:type="scr:ExpressionTransform">
              <scr:Name>SphericalCoordinates</scr:Name>
              <scr:Expression>new(
Item3 * Math.Cos(Item2) * Math.Cos(Item1) as X,
Item3 * Math.Sin(Item2) as Y,
Item3 * Math.Cos(Item2) * Math.Sin(Item1) as Z0
)</scr:Expression>
            </Expression>
            <Expression xsi:type="MemberSelector">
              <Selector>X</Selector>
            </Expression>
            <Expression xsi:type="PropertyMapping">
              <PropertyMappings>
                <Property Name="TranslationX" />
              </PropertyMappings>
            </Expression>
            <Expression xsi:type="MemberSelector">
              <Selector>Y</Selector>
            </Expression>
            <Expression xsi:type="PropertyMapping">
              <PropertyMappings>
                <Property Name="TranslationY" />
              </PropertyMappings>
            </Expression>
            <Expression xsi:type="MemberSelector">
              <Selector>Z0</Selector>
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>Eye</Name>
            </Expression>
            <Expression xsi:type="MemberSelector">
              <Selector>EyeZ</Selector>
            </Expression>
            <Expression xsi:type="Disable">
              <Builder xsi:type="Combinator">
                <Combinator xsi:type="rx:WithLatestFrom" />
              </Builder>
            </Expression>
            <Expression xsi:type="Disable">
              <Builder xsi:type="MemberSelector">
                <Selector>Item2</Selector>
              </Builder>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:CombineLatest" />
            </Expression>
            <Expression xsi:type="Add" />
            <Expression xsi:type="PropertyMapping">
              <PropertyMappings>
                <Property Name="TranslationZ" />
              </PropertyMappings>
            </Expression>
            <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.DrawModel.bonsai">
              <TranslationX>3.61904788</TranslationX>
              <TranslationY>-3.00907516</TranslationY>
              <TranslationZ>-1.68758976</TranslationZ>
              <ScaleX>0.5</ScaleX>
              <ScaleY>0.5</ScaleY>
              <ScaleZ>0.5</ScaleZ>
              <MeshName>Plane</MeshName>
              <Ambient>
                <X>0</X>
                <Y>0</Y>
                <Z>0</Z>
              </Ambient>
              <Diffuse>
                <X>0</X>
                <Y>0</Y>
                <Z>0</Z>
              </Diffuse>
              <Specular>
                <X>0</X>
                <Y>0</Y>
                <Z>0</Z>
              </Specular>
              <SpecularExponent>10</SpecularExponent>
              <RotationZ>0</RotationZ>
              <RotationY>90</RotationY>
              <RotationX>0</RotationX>
            </Expression>
            <Expression xsi:type="WorkflowOutput" />
            <Expression xsi:type="Disable">
              <Builder xsi:type="GroupWorkflow">
                <Name>PhotoQuadLogger</Name>
                <Workflow>
                  <Nodes>
                    <Expression xsi:type="SubscribeSubject">
                      <Name>photodiode</Name>
                    </Expression>
                    <Expression xsi:type="SubscribeSubject">
                      <Name>PhotoQuadAmbient</Name>
                    </Expression>
                    <Expression xsi:type="Combinator">
                      <Combinator xsi:type="gl:UpdateFrame" />
                    </Expression>
                    <Expression xsi:type="MemberSelector">
                      <Selector>TimeStep</Selector>
                    </Expression>
                    <Expression xsi:type="Combinator">
                      <Combinator xsi:type="rx:ElementIndex" />
                    </Expression>
                    <Expression xsi:type="Combinator">
                      <Combinator xsi:type="rx:CombineLatest" />
                    </Expression>
                    <Expression xsi:type="scr:ExpressionTransform">
                      <scr:Description />
                      <scr:Expression>new(
Item3.Index as Frame,
Item3.Value.ElapsedTime as ElapsedTime,
Item3.Value.ElapsedRealTime as ElapsedRealTime,
Item2 as PhotodiodeAmbient,
Item1 as PhotodiodeSignal
)</scr:Expression>
                    </Expression>
                    <Expression xsi:type="io:CsvWriter">
                      <io:FileName>saved_csv\PhotodiodeQuad.csv</io:FileName>
                      <io:Append>false</io:Append>
                      <io:Overwrite>false</io:Overwrite>
                      <io:Suffix>Timestamp</io:Suffix>
                      <io:IncludeHeader>true</io:IncludeHeader>
                    </Expression>
                    <Expression xsi:type="WorkflowOutput" />
                  </Nodes>
                  <Edges>
                    <Edge From="0" To="5" Label="Source1" />
                    <Edge From="1" To="5" Label="Source2" />
                    <Edge From="2" To="3" Label="Source1" />
                    <Edge From="3" To="4" Label="Source1" />
                    <Edge From="4" To="5" Label="Source3" />
                    <Edge From="5" To="6" Label="Source1" />
                    <Edge From="6" To="7" Label="Source1" />
                    <Edge From="7" To="8" Label="Source1" />
                  </Edges>
                </Workflow>
              </Builder>
            </Expression>
          </Nodes>
          <Edges>
            <Edge From="0" To="31" Label="Source1" />
            <Edge From="1" To="2" Label="Source1" />
            <Edge From="2" To="3" Label="Source1" />
            <Edge From="3" To="4" Label="Source1" />
            <Edge From="4" To="5" Label="Source1" />
            <Edge From="5" To="6" Label="Source1" />
            <Edge From="6" To="31" Label="Source2" />
            <Edge From="7" To="26" Label="Source1" />
            <Edge From="8" To="31" Label="Source6" />
            <Edge From="9" To="10" Label="Source1" />
            <Edge From="10" To="11" Label="Source1" />
            <Edge From="11" To="17" Label="Source1" />
            <Edge From="12" To="13" Label="Source1" />
            <Edge From="13" To="14" Label="Source1" />
            <Edge From="14" To="17" Label="Source2" />
            <Edge From="15" To="16" Label="Source1" />
            <Edge From="16" To="17" Label="Source3" />
            <Edge From="17" To="18" Label="Source1" />
            <Edge From="18" To="19" Label="Source1" />
            <Edge From="18" To="21" Label="Source1" />
            <Edge From="18" To="23" Label="Source1" />
            <Edge From="19" To="20" Label="Source1" />
            <Edge From="20" To="31" Label="Source3" />
            <Edge From="21" To="22" Label="Source1" />
            <Edge From="22" To="31" Label="Source4" />
            <Edge From="23" To="28" Label="Source1" />
            <Edge From="24" To="25" Label="Source1" />
            <Edge From="25" To="26" Label="Source2" />
            <Edge From="26" To="27" Label="Source1" />
            <Edge From="27" To="28" Label="Source2" />
            <Edge From="28" To="29" Label="Source1" />
            <Edge From="29" To="30" Label="Source1" />
            <Edge From="30" To="31" Label="Source5" />
            <Edge From="31" To="32" Label="Source1" />
          </Edges>
        </Workflow>
      </Expression>
      <Expression xsi:type="GroupWorkflow">
        <Name>Floor</Name>
        <Workflow>
          <Nodes>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="Period" DisplayName="RegenerateInterval" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="gl:Timer">
                <gl:DueTime>PT0S</gl:DueTime>
                <gl:Period>PT1S</gl:Period>
              </Combinator>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:ElementIndex" />
            </Expression>
            <Expression xsi:type="MemberSelector">
              <Selector>Index</Selector>
            </Expression>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="TextureName" />
              <Property Name="Ambient" />
              <Property Name="TranslationX" />
              <Property Name="TranslationY" />
              <Property Name="ScaleZ" />
              <Property Name="RotationX" />
              <Property Name="RotationY" />
              <Property Name="RotationZ" />
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>FloorLength</Name>
            </Expression>
            <Expression xsi:type="PropertyMapping">
              <PropertyMappings>
                <Property Name="Value" />
              </PropertyMappings>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="FloatProperty">
                <Value>1000</Value>
              </Combinator>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:CombineLatest" />
            </Expression>
            <Expression xsi:type="Multiply" />
            <Expression xsi:type="CreateObservable">
              <Workflow>
                <Nodes>
                  <Expression xsi:type="WorkflowInput">
                    <Name>Source1</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>Draw</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>FloorWidth</Name>
                  </Expression>
                  <Expression xsi:type="PropertyMapping">
                    <PropertyMappings>
                      <Property Name="ScaleX" />
                    </PropertyMappings>
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="TextureName" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:BindTexture">
                      <gl:TextureSlot>Texture0</gl:TextureSlot>
                      <gl:ShaderName>TexturedModel</gl:ShaderName>
                      <gl:TextureName>plaid</gl:TextureName>
                      <gl:TextureTarget>Texture2D</gl:TextureTarget>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:CombineLatest" />
                  </Expression>
                  <Expression xsi:type="InputMapping">
                    <PropertyMappings>
                      <Property Name="TranslationZ" Selector="Item2" />
                    </PropertyMappings>
                    <Selector>Item1</Selector>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>FloorLength</Name>
                  </Expression>
                  <Expression xsi:type="PropertyMapping">
                    <PropertyMappings>
                      <Property Name="ScaleY" />
                    </PropertyMappings>
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Ambient" />
                    <Property Name="TranslationX" />
                    <Property Name="TranslationY" />
                    <Property Name="ScaleZ" />
                    <Property Name="RotationZ" />
                    <Property Name="RotationY" />
                    <Property Name="RotationX" />
                  </Expression>
                  <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.DrawTexturedModel.bonsai">
                    <TranslationX>0</TranslationX>
                    <TranslationY>-1</TranslationY>
                    <TranslationZ>3000</TranslationZ>
                    <ScaleX>2</ScaleX>
                    <ScaleY>1000</ScaleY>
                    <ScaleZ>0</ScaleZ>
                    <MeshName>Plane</MeshName>
                    <Ambient>
                      <X>0.5</X>
                      <Y>0.5</Y>
                      <Z>0.5</Z>
                    </Ambient>
                    <Diffuse>
                      <X>1</X>
                      <Y>1</Y>
                      <Z>1</Z>
                    </Diffuse>
                    <Specular>
                      <X>1</X>
                      <Y>1</Y>
                      <Z>1</Z>
                    </Specular>
                    <SpecularExponent>10</SpecularExponent>
                    <RotationZ>0</RotationZ>
                    <RotationY>0</RotationY>
                    <RotationX>-90</RotationX>
                  </Expression>
                  <Expression xsi:type="WorkflowOutput" />
                </Nodes>
                <Edges>
                  <Edge From="0" To="6" Label="Source2" />
                  <Edge From="1" To="5" Label="Source1" />
                  <Edge From="2" To="3" Label="Source1" />
                  <Edge From="3" To="11" Label="Source2" />
                  <Edge From="4" To="5" Label="Source2" />
                  <Edge From="5" To="6" Label="Source1" />
                  <Edge From="6" To="7" Label="Source1" />
                  <Edge From="7" To="11" Label="Source1" />
                  <Edge From="8" To="9" Label="Source1" />
                  <Edge From="9" To="11" Label="Source3" />
                  <Edge From="10" To="11" Label="Source4" />
                  <Edge From="11" To="12" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:Merge" />
            </Expression>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="Value" DisplayName="FloorLength" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="FloatProperty">
                <Value>1000</Value>
              </Combinator>
            </Expression>
            <Expression xsi:type="BehaviorSubject">
              <Name>FloorLength</Name>
            </Expression>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="Value" DisplayName="FloorWidth" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="FloatProperty">
                <Value>2</Value>
              </Combinator>
            </Expression>
            <Expression xsi:type="BehaviorSubject">
              <Name>FloorWidth</Name>
            </Expression>
          </Nodes>
          <Edges>
            <Edge From="0" To="1" Label="Source1" />
            <Edge From="1" To="2" Label="Source1" />
            <Edge From="2" To="3" Label="Source1" />
            <Edge From="3" To="8" Label="Source1" />
            <Edge From="4" To="10" Label="Source2" />
            <Edge From="5" To="6" Label="Source1" />
            <Edge From="6" To="7" Label="Source1" />
            <Edge From="7" To="8" Label="Source2" />
            <Edge From="8" To="9" Label="Source1" />
            <Edge From="9" To="10" Label="Source1" />
            <Edge From="10" To="11" Label="Source1" />
            <Edge From="12" To="13" Label="Source1" />
            <Edge From="13" To="14" Label="Source1" />
            <Edge From="15" To="16" Label="Source1" />
            <Edge From="16" To="17" Label="Source1" />
          </Edges>
        </Workflow>
      </Expression>
      <Expression xsi:type="GroupWorkflow">
        <Name>SpheresClose</Name>
        <Description>Depth is in log10 space.</Description>
        <Workflow>
          <Nodes>
            <Expression xsi:type="SubscribeSubject">
              <Name>MouseZ</Name>
            </Expression>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="Value" DisplayName="Size" Category="MiscParams" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="FloatProperty">
                <Value>0.043</Value>
              </Combinator>
            </Expression>
            <Expression xsi:type="BehaviorSubject">
              <Name>OriginalSize</Name>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:Take">
                <rx:Count>1</rx:Count>
              </Combinator>
            </Expression>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="DueTime" DisplayName="InitialDelay" Category="Timings" />
            </Expression>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="LifeTime" Category="Timings" />
              <Property Name="Ymin" Category="Positions" />
              <Property Name="Ymax" Category="Positions" />
              <Property Name="Ycount" Category="Positions" />
              <Property Name="DepthMin" Category="Positions" />
              <Property Name="DepthMax" Category="Positions" />
              <Property Name="DepthCount" Category="Positions" />
              <Property Name="SphereInterval" Category="Timings" />
              <Property Name="Xmin" Category="Positions" />
              <Property Name="XminLim" Category="Positions" />
              <Property Name="XminCount" Category="Positions" />
              <Property Name="XmaxLim" Category="Positions" />
              <Property Name="Xmax" Category="Positions" />
              <Property Name="XmaxCount" Category="Positions" />
            </Expression>
            <Expression xsi:type="GroupWorkflow">
              <Name>SetParams</Name>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Value" DisplayName="LifeTime" Category="Timings" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="FloatProperty">
                      <Value>4</Value>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>LifeTime</Name>
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Ymin" Category="Position" />
                    <Property Name="Ymax" Category="Position" />
                    <Property Name="Ycount" Category="Position" />
                    <Property Name="DepthMin" Category="Position" />
                    <Property Name="DepthMax" Category="Position" />
                    <Property Name="DepthCount" Category="Position" />
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Period" DisplayName="SphereInterval" Category="Timings" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:Timer">
                      <gl:DueTime>PT0S</gl:DueTime>
                      <gl:Period>PT0.5S</gl:Period>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="ExternalizedMapping">
                    <Property Name="Xmin" />
                    <Property Name="XminLim" />
                    <Property Name="XminCount" />
                    <Property Name="XmaxLim" />
                    <Property Name="Xmax" />
                    <Property Name="XmaxCount" />
                  </Expression>
                  <Expression xsi:type="GroupWorkflow">
                    <Name>Xrange</Name>
                    <Workflow>
                      <Nodes>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="RangeMin" DisplayName="Xmin" />
                          <Property Name="RangeMax" DisplayName="XminLim" />
                          <Property Name="Count" DisplayName="XminCount" />
                        </Expression>
                        <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.ParameterRange.bonsai">
                          <RangeMin>60</RangeMin>
                          <RangeMax>70</RangeMax>
                          <Count>2</Count>
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="RangeMin" DisplayName="XmaxLim" />
                          <Property Name="RangeMax" DisplayName="Xmax" />
                          <Property Name="Count" DisplayName="XmaxCount" />
                        </Expression>
                        <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.ParameterRange.bonsai">
                          <RangeMin>110</RangeMin>
                          <RangeMax>120</RangeMax>
                          <Count>2</Count>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="rx:Concat" />
                        </Expression>
                        <Expression xsi:type="WorkflowOutput" />
                      </Nodes>
                      <Edges>
                        <Edge From="0" To="1" Label="Source1" />
                        <Edge From="1" To="4" Label="Source1" />
                        <Edge From="2" To="3" Label="Source1" />
                        <Edge From="3" To="4" Label="Source2" />
                        <Edge From="4" To="5" Label="Source1" />
                      </Edges>
                    </Workflow>
                  </Expression>
                  <Expression xsi:type="CreateObservable">
                    <Name>YZrange</Name>
                    <Workflow>
                      <Nodes>
                        <Expression xsi:type="WorkflowInput">
                          <Name>Source1</Name>
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="RangeMin" DisplayName="Ymin" />
                          <Property Name="RangeMax" DisplayName="Ymax" />
                          <Property Name="Count" DisplayName="Ycount" />
                        </Expression>
                        <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.ParameterRange.bonsai">
                          <RangeMin>0</RangeMin>
                          <RangeMax>40</RangeMax>
                          <Count>3</Count>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="rx:CombineLatest" />
                        </Expression>
                        <Expression xsi:type="ExternalizedMapping">
                          <Property Name="DepthMin" />
                          <Property Name="DepthMax" />
                          <Property Name="DepthCount" />
                        </Expression>
                        <Expression xsi:type="CreateObservable">
                          <Name>DepthRange</Name>
                          <Workflow>
                            <Nodes>
                              <Expression xsi:type="WorkflowInput">
                                <Name>Source1</Name>
                              </Expression>
                              <Expression xsi:type="ExternalizedMapping">
                                <Property Name="RangeMin" DisplayName="DepthMin" />
                                <Property Name="RangeMax" DisplayName="DepthMax" />
                                <Property Name="Count" DisplayName="DepthCount" />
                              </Expression>
                              <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.ParameterRange.bonsai">
                                <RangeMin>1</RangeMin>
                                <RangeMax>2</RangeMax>
                                <Count>2</Count>
                              </Expression>
                              <Expression xsi:type="scr:ExpressionTransform">
                                <scr:Name>LogSpace(10)</scr:Name>
                                <scr:Expression>Math.Pow(10,it)</scr:Expression>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="rx:CombineLatest" />
                              </Expression>
                              <Expression xsi:type="InputMapping">
                                <PropertyMappings>
                                  <Property Name="X" Selector="Item1.Item1" />
                                  <Property Name="Y" Selector="Item1.Item2" />
                                  <Property Name="Z" Selector="Item2" />
                                </PropertyMappings>
                              </Expression>
                              <Expression xsi:type="Combinator">
                                <Combinator xsi:type="gl:CreateVector3">
                                  <gl:X>120</gl:X>
                                  <gl:Y>40</gl:Y>
                                  <gl:Z>100</gl:Z>
                                </Combinator>
                              </Expression>
                              <Expression xsi:type="WorkflowOutput" />
                            </Nodes>
                            <Edges>
                              <Edge From="0" To="4" Label="Source1" />
                              <Edge From="1" To="2" Label="Source1" />
                              <Edge From="2" To="3" Label="Source1" />
                              <Edge From="3" To="4" Label="Source2" />
                              <Edge From="4" To="5" Label="Source1" />
                              <Edge From="5" To="6" Label="Source1" />
                              <Edge From="6" To="7" Label="Source1" />
                            </Edges>
                          </Workflow>
                        </Expression>
                        <Expression xsi:type="Combinator">
                          <Combinator xsi:type="rx:Concat" />
                        </Expression>
                        <Expression xsi:type="WorkflowOutput" />
                      </Nodes>
                      <Edges>
                        <Edge From="0" To="3" Label="Source1" />
                        <Edge From="1" To="2" Label="Source1" />
                        <Edge From="2" To="3" Label="Source2" />
                        <Edge From="3" To="5" Label="Source1" />
                        <Edge From="4" To="5" Label="Source2" />
                        <Edge From="5" To="6" Label="Source1" />
                        <Edge From="6" To="7" Label="Source1" />
                      </Edges>
                    </Workflow>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Concat" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="num:Permutation" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Zip" />
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Item1</Selector>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Repeat" />
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Expression>new(
it.X as X,
it.Y as Y, 
it.Z as Depth
)</scr:Expression>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>CloseLoopDuration</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>LifeTime</Name>
                  </Expression>
                  <Expression xsi:type="Multiply">
                    <Operand xsi:type="FloatProperty">
                      <Value>-1E+07</Value>
                    </Operand>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Zip" />
                  </Expression>
                  <Expression xsi:type="Add" />
                  <Expression xsi:type="PropertyMapping">
                    <PropertyMappings>
                      <Property Name="DueTime" />
                    </PropertyMappings>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:Timer">
                      <gl:DueTime>PT3M16S</gl:DueTime>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:TakeUntil" />
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>X</Selector>
                  </Expression>
                  <Expression xsi:type="ReplaySubject">
                    <Name>Xdeg</Name>
                    <BufferSize xsi:nil="true" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="num:DegreeToRadian" />
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Y</Selector>
                  </Expression>
                  <Expression xsi:type="ReplaySubject">
                    <Name>Ydeg</Name>
                    <BufferSize xsi:nil="true" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="num:DegreeToRadian" />
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Depth</Selector>
                  </Expression>
                  <Expression xsi:type="ReplaySubject">
                    <Name>Depth</Name>
                    <BufferSize xsi:nil="true" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Zip" />
                  </Expression>
                  <Expression xsi:type="WorkflowOutput" />
                </Nodes>
                <Edges>
                  <Edge From="0" To="1" Label="Source1" />
                  <Edge From="1" To="2" Label="Source1" />
                  <Edge From="3" To="8" Label="Source2" />
                  <Edge From="4" To="5" Label="Source1" />
                  <Edge From="5" To="11" Label="Source2" />
                  <Edge From="6" To="7" Label="Source1" />
                  <Edge From="7" To="8" Label="Source1" />
                  <Edge From="8" To="9" Label="Source1" />
                  <Edge From="9" To="10" Label="Source1" />
                  <Edge From="10" To="11" Label="Source1" />
                  <Edge From="11" To="12" Label="Source1" />
                  <Edge From="12" To="13" Label="Source1" />
                  <Edge From="13" To="14" Label="Source1" />
                  <Edge From="14" To="22" Label="Source1" />
                  <Edge From="15" To="18" Label="Source1" />
                  <Edge From="16" To="17" Label="Source1" />
                  <Edge From="17" To="18" Label="Source2" />
                  <Edge From="18" To="19" Label="Source1" />
                  <Edge From="19" To="20" Label="Source1" />
                  <Edge From="20" To="21" Label="Source1" />
                  <Edge From="21" To="22" Label="Source2" />
                  <Edge From="22" To="23" Label="Source1" />
                  <Edge From="22" To="26" Label="Source1" />
                  <Edge From="22" To="29" Label="Source1" />
                  <Edge From="23" To="24" Label="Source1" />
                  <Edge From="24" To="25" Label="Source1" />
                  <Edge From="25" To="31" Label="Source1" />
                  <Edge From="26" To="27" Label="Source1" />
                  <Edge From="27" To="28" Label="Source1" />
                  <Edge From="28" To="31" Label="Source2" />
                  <Edge From="29" To="30" Label="Source1" />
                  <Edge From="30" To="31" Label="Source3" />
                  <Edge From="31" To="32" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:ElementIndex" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:CombineLatest" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:WithLatestFrom" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="p1:SphericalCoordinates" />
            </Expression>
            <Expression xsi:type="CreateObservable">
              <Name>CreateSpheres</Name>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="WorkflowInput">
                    <Name>Source1</Name>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>ThisSphereParams</Name>
                  </Expression>
                  <Expression xsi:type="MulticastSubject">
                    <Name>SphereNewParams</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>Draw</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>LifeTime</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>LifeTime</Name>
                  </Expression>
                  <Expression xsi:type="Multiply">
                    <Operand xsi:type="FloatProperty">
                      <Value>1E+07</Value>
                    </Operand>
                  </Expression>
                  <Expression xsi:type="PropertyMapping">
                    <PropertyMappings>
                      <Property Name="DueTime" />
                    </PropertyMappings>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:Timer">
                      <gl:DueTime>PT4S</gl:DueTime>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:RenderFrame" />
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>TimeStep.ElapsedRealTime</Selector>
                  </Expression>
                  <Expression xsi:type="rx:Accumulate" />
                  <Expression xsi:type="SubscribeSubject">
                    <Name>ThisSphereParams</Name>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Item1</Selector>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:CombineLatest" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="p1:CreateFading" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:CombineLatest" />
                  </Expression>
                  <Expression xsi:type="MulticastSubject">
                    <Name>SphereAllParams</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:CombineLatest" />
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Name>Rename</scr:Name>
                    <scr:Expression>new(
Item1 as Draw,
Item2.Item2 as Ambient,
Item2.Item1.Item1 as SphereID,
Item2.Item1.Item2.Item1 as Azimuth,
Item2.Item1.Item2.Item2 as Elevation,
Item2.Item1.Item2.Item3 as Depth,
Item2.Item1.Item3.Item1 as X, 
Item2.Item1.Item3.Item2 as Y, 
Item2.Item1.Item3.Item3 as Z0, 
Item2.Item1.Item3.Item4 as Z, 
Item2.Item1.Item3.Item5 as MouseZ,
Item2.Item1.Item4.Item2 as Size)</scr:Expression>
                  </Expression>
                  <Expression xsi:type="InputMapping">
                    <PropertyMappings>
                      <Property Name="TranslationX" Selector="X" />
                      <Property Name="TranslationY" Selector="Y" />
                      <Property Name="TranslationZ" Selector="Z" />
                      <Property Name="ScaleX" Selector="Size" />
                      <Property Name="ScaleY" Selector="Size" />
                      <Property Name="ScaleZ" Selector="Size" />
                      <Property Name="Ambient" Selector="Ambient" />
                    </PropertyMappings>
                    <Selector>Draw</Selector>
                  </Expression>
                  <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.DrawModel.bonsai">
                    <TranslationX>-26.2002621</TranslationX>
                    <TranslationY>64.27876</TranslationY>
                    <TranslationZ>71.9846344</TranslationZ>
                    <ScaleX>4.3</ScaleX>
                    <ScaleY>4.3</ScaleY>
                    <ScaleZ>4.3</ScaleZ>
                    <MeshName>sphere</MeshName>
                    <Ambient>
                      <X>0.8822967</X>
                      <Y>0.8822967</Y>
                      <Z>0.8822967</Z>
                    </Ambient>
                    <Diffuse>
                      <X>0</X>
                      <Y>0</Y>
                      <Z>0</Z>
                    </Diffuse>
                    <Specular>
                      <X>0</X>
                      <Y>0</Y>
                      <Z>0</Z>
                    </Specular>
                    <SpecularExponent>10</SpecularExponent>
                    <RotationZ>0</RotationZ>
                    <RotationY>0</RotationY>
                    <RotationX>0</RotationX>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:TakeUntil" />
                  </Expression>
                  <Expression xsi:type="WorkflowOutput" />
                </Nodes>
                <Edges>
                  <Edge From="0" To="1" Label="Source1" />
                  <Edge From="1" To="2" Label="Source1" />
                  <Edge From="2" To="16" Label="Source1" />
                  <Edge From="3" To="18" Label="Source1" />
                  <Edge From="4" To="14" Label="Source3" />
                  <Edge From="5" To="6" Label="Source1" />
                  <Edge From="6" To="7" Label="Source1" />
                  <Edge From="7" To="8" Label="Source1" />
                  <Edge From="8" To="22" Label="Source2" />
                  <Edge From="9" To="10" Label="Source1" />
                  <Edge From="10" To="11" Label="Source1" />
                  <Edge From="11" To="14" Label="Source2" />
                  <Edge From="12" To="13" Label="Source1" />
                  <Edge From="13" To="14" Label="Source1" />
                  <Edge From="14" To="15" Label="Source1" />
                  <Edge From="15" To="16" Label="Source2" />
                  <Edge From="16" To="17" Label="Source1" />
                  <Edge From="17" To="18" Label="Source2" />
                  <Edge From="18" To="19" Label="Source1" />
                  <Edge From="19" To="20" Label="Source1" />
                  <Edge From="20" To="21" Label="Source1" />
                  <Edge From="21" To="22" Label="Source1" />
                  <Edge From="22" To="23" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:Merge" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:DelaySubscription">
                <rx:DueTime>PT5S</rx:DueTime>
              </Combinator>
            </Expression>
            <Expression xsi:type="WorkflowOutput" />
          </Nodes>
          <Edges>
            <Edge From="0" To="10" Label="Source2" />
            <Edge From="1" To="2" Label="Source1" />
            <Edge From="2" To="3" Label="Source1" />
            <Edge From="3" To="4" Label="Source1" />
            <Edge From="4" To="9" Label="Source2" />
            <Edge From="5" To="14" Label="Source2" />
            <Edge From="6" To="7" Label="Source1" />
            <Edge From="7" To="8" Label="Source1" />
            <Edge From="8" To="9" Label="Source1" />
            <Edge From="9" To="10" Label="Source1" />
            <Edge From="10" To="11" Label="Source1" />
            <Edge From="11" To="12" Label="Source1" />
            <Edge From="12" To="13" Label="Source1" />
            <Edge From="13" To="14" Label="Source1" />
            <Edge From="14" To="15" Label="Source1" />
          </Edges>
        </Workflow>
      </Expression>
      <Expression xsi:type="GroupWorkflow">
        <Name>SphereParamsLoggerClose</Name>
        <Workflow>
          <Nodes>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="gl:UpdateFrame" />
            </Expression>
            <Expression xsi:type="MemberSelector">
              <Selector>TimeStep</Selector>
            </Expression>
            <Expression xsi:type="rx:Accumulate" />
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:ElementIndex" />
            </Expression>
            <Expression xsi:type="PublishSubject">
              <Name>Frames</Name>
            </Expression>
            <Expression xsi:type="BehaviorSubject" TypeArguments="sys:Tuple(sys:Int32,sys:Tuple(sys:Single,sys:Single,sys:Single),sys:Tuple(sys:Single,sys:Single,sys:Single,sys:Single,sys:Single),sys:Tuple(sys:Single,sys:Single))">
              <Name>SphereNewParams</Name>
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>Frames</Name>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:WithLatestFrom" />
            </Expression>
            <Expression xsi:type="scr:ExpressionTransform">
              <scr:Expression>new(
Item2.Index as Frame,
Item2.Value.ElapsedTime as FrameElapsedTime,
Item2.Value.ElapsedRealTime as FrameElapsedRealTime,
Item1.Item1 as SphereID,
Math.Round(Item1.Item2.Item1/Math.PI*180) as Azimuth,
Math.Round(Item1.Item2.Item2/Math.PI*180) as Elevation,
Item1.Item2.Item3 as Depth,
Item1.Item3.Item1 as X, 
Item1.Item3.Item2 as Y, 
Item1.Item3.Item3 as Z0, 
Item1.Item3.Item4 as Z, 
Item1.Item3.Item5 as MouseZ,
Item1.Item4.Item1 as OriginalSize,
Item1.Item4.Item2 as Size)</scr:Expression>
            </Expression>
            <Expression xsi:type="io:CsvWriter">
              <io:FileName>saved_csv\Spheres_NewParams_Close.csv</io:FileName>
              <io:Append>false</io:Append>
              <io:Overwrite>false</io:Overwrite>
              <io:Suffix>Timestamp</io:Suffix>
              <io:IncludeHeader>true</io:IncludeHeader>
            </Expression>
            <Expression xsi:type="MemberSelector">
              <Selector>SphereID</Selector>
            </Expression>
            <Expression xsi:type="MemberSelector">
              <Selector>Azimuth</Selector>
            </Expression>
            <Expression xsi:type="MemberSelector">
              <Selector>Elevation</Selector>
            </Expression>
            <Expression xsi:type="MemberSelector">
              <Selector>Depth</Selector>
            </Expression>
            <Expression xsi:type="MemberSelector">
              <Selector>Frame</Selector>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:Zip" />
            </Expression>
            <Expression xsi:type="scr:ExpressionTransform">
              <scr:Expression>new(
Item5 as Frame,
Item1 as SphereID,
Item2 as Azimuth,
Item3 as Elevation,
Item4 as Depth
)</scr:Expression>
            </Expression>
            <Expression xsi:type="ReplaySubject">
              <Name>SphereParamsReplay</Name>
              <BufferSize xsi:nil="true" />
            </Expression>
            <Expression xsi:type="BehaviorSubject" TypeArguments="sys:Tuple(sys:Tuple(sys:Int32,sys:Tuple(sys:Single,sys:Single,sys:Single),sys:Tuple(sys:Single,sys:Single,sys:Single,sys:Single,sys:Single),sys:Tuple(sys:Single,sys:Single)),sys:Single)">
              <Name>SphereAllParams</Name>
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>Frames</Name>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:CombineLatest" />
            </Expression>
            <Expression xsi:type="scr:ExpressionTransform">
              <scr:Expression>new(
Item2.Index as Frame,
Item2.Value.ElapsedTime as FrameElapsedTime,
Item2.Value.ElapsedRealTime as FrameElapsedRealTime,
Item1.Item1.Item1 as SphereID,
Math.Round(Item1.Item1.Item2.Item1/Math.PI*180) as Azimuth,
Math.Round(Item1.Item1.Item2.Item2/Math.PI*180) as Elevation,
Item1.Item1.Item2.Item3 as Depth,
Item1.Item1.Item3.Item1 as X, 
Item1.Item1.Item3.Item2 as Y, 
Item1.Item1.Item3.Item3 as Z0, 
Item1.Item1.Item3.Item4 as Z, 
Item1.Item1.Item3.Item5 as MouseZ,
Item1.Item1.Item4.Item1 as OriginalSize,
Item1.Item1.Item4.Item2 as Size,
Item1.Item2 as Ambient)</scr:Expression>
            </Expression>
            <Expression xsi:type="io:CsvWriter">
              <io:FileName>saved_csv\Spheres_AllParams_Close.csv</io:FileName>
              <io:Append>false</io:Append>
              <io:Overwrite>true</io:Overwrite>
              <io:Suffix>Timestamp</io:Suffix>
              <io:IncludeHeader>true</io:IncludeHeader>
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>CloseLoopDuration</Name>
            </Expression>
            <Expression xsi:type="Multiply">
              <Operand xsi:type="FloatProperty">
                <Value>1E+07</Value>
              </Operand>
            </Expression>
            <Expression xsi:type="PropertyMapping">
              <PropertyMappings>
                <Property Name="DueTime" />
              </PropertyMappings>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="gl:Timer">
                <gl:DueTime>P23148DT3H34M14.5128448S</gl:DueTime>
              </Combinator>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:TakeUntil" />
            </Expression>
          </Nodes>
          <Edges>
            <Edge From="0" To="1" Label="Source1" />
            <Edge From="1" To="2" Label="Source1" />
            <Edge From="2" To="3" Label="Source1" />
            <Edge From="3" To="4" Label="Source1" />
            <Edge From="5" To="7" Label="Source1" />
            <Edge From="6" To="7" Label="Source2" />
            <Edge From="7" To="8" Label="Source1" />
            <Edge From="8" To="9" Label="Source1" />
            <Edge From="9" To="10" Label="Source1" />
            <Edge From="9" To="11" Label="Source1" />
            <Edge From="9" To="12" Label="Source1" />
            <Edge From="9" To="13" Label="Source1" />
            <Edge From="9" To="14" Label="Source1" />
            <Edge From="10" To="15" Label="Source1" />
            <Edge From="11" To="15" Label="Source2" />
            <Edge From="12" To="15" Label="Source3" />
            <Edge From="13" To="15" Label="Source4" />
            <Edge From="14" To="15" Label="Source5" />
            <Edge From="15" To="16" Label="Source1" />
            <Edge From="16" To="17" Label="Source1" />
            <Edge From="18" To="20" Label="Source1" />
            <Edge From="19" To="20" Label="Source2" />
            <Edge From="20" To="21" Label="Source1" />
            <Edge From="21" To="22" Label="Source1" />
            <Edge From="22" To="27" Label="Source1" />
            <Edge From="23" To="24" Label="Source1" />
            <Edge From="24" To="25" Label="Source1" />
            <Edge From="25" To="26" Label="Source1" />
            <Edge From="26" To="27" Label="Source2" />
          </Edges>
        </Workflow>
      </Expression>
      <Expression xsi:type="GroupWorkflow">
        <Name>SpheresOpen</Name>
        <Workflow>
          <Nodes>
            <Expression xsi:type="SubscribeSubject">
              <Name>Ydeg</Name>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="num:DegreeToRadian" />
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>Depth</Name>
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>MouseZ</Name>
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>CloseLoopDuration</Name>
            </Expression>
            <Expression xsi:type="Multiply">
              <Operand xsi:type="FloatProperty">
                <Value>1E+07</Value>
              </Operand>
            </Expression>
            <Expression xsi:type="PropertyMapping">
              <PropertyMappings>
                <Property Name="DueTime" />
              </PropertyMappings>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="gl:Timer">
                <gl:DueTime>P23148DT3H34M14.5128448S</gl:DueTime>
              </Combinator>
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>OriginalSize</Name>
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>Xdeg</Name>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="num:DegreeToRadian" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:Zip" />
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>OpenLoopStartTime</Name>
            </Expression>
            <Expression xsi:type="PropertyMapping">
              <PropertyMappings>
                <Property Name="DueTime" />
              </PropertyMappings>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="gl:Delay">
                <gl:DueTime>PT3M25S</gl:DueTime>
              </Combinator>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:ElementIndex" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:CombineLatest" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:WithLatestFrom" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="p1:SphericalCoordinates" />
            </Expression>
            <Expression xsi:type="CreateObservable">
              <Name>CreateSpheres</Name>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="WorkflowInput">
                    <Name>Source1</Name>
                  </Expression>
                  <Expression xsi:type="BehaviorSubject">
                    <Name>ThisSphereParams</Name>
                  </Expression>
                  <Expression xsi:type="MulticastSubject">
                    <Name>SphereNewParamsOpen</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>Draw</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>LifeTime</Name>
                  </Expression>
                  <Expression xsi:type="SubscribeSubject">
                    <Name>LifeTime</Name>
                  </Expression>
                  <Expression xsi:type="Multiply">
                    <Operand xsi:type="FloatProperty">
                      <Value>1E+07</Value>
                    </Operand>
                  </Expression>
                  <Expression xsi:type="PropertyMapping">
                    <PropertyMappings>
                      <Property Name="DueTime" />
                    </PropertyMappings>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:Timer">
                      <gl:DueTime>PT10S</gl:DueTime>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="gl:RenderFrame" />
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>TimeStep.ElapsedRealTime</Selector>
                  </Expression>
                  <Expression xsi:type="rx:Accumulate" />
                  <Expression xsi:type="SubscribeSubject">
                    <Name>ThisSphereParams</Name>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>Item1</Selector>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:CombineLatest" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="p1:CreateFading" />
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:CombineLatest" />
                  </Expression>
                  <Expression xsi:type="MulticastSubject">
                    <Name>SphereAllParamsOpen</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:CombineLatest" />
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Name>Rename</scr:Name>
                    <scr:Expression>new(
Item1 as Draw,
Item2.Item2 as Ambient,
Item2.Item1.Item1 as SphereID,
Item2.Item1.Item2.Item1 as Azimuth,
Item2.Item1.Item2.Item2 as Elevation,
Item2.Item1.Item2.Item3 as Depth,
Item2.Item1.Item3.Item1 as X, 
Item2.Item1.Item3.Item2 as Y, 
Item2.Item1.Item3.Item3 as Z0, 
Item2.Item1.Item3.Item4 as Z, 
Item2.Item1.Item3.Item5 as MouseZ,
Item2.Item1.Item4.Item2 as Size)</scr:Expression>
                  </Expression>
                  <Expression xsi:type="InputMapping">
                    <PropertyMappings>
                      <Property Name="TranslationX" Selector="X" />
                      <Property Name="TranslationY" Selector="Y" />
                      <Property Name="TranslationZ" Selector="Z" />
                      <Property Name="ScaleX" Selector="Size" />
                      <Property Name="ScaleY" Selector="Size" />
                      <Property Name="ScaleZ" Selector="Size" />
                      <Property Name="Ambient" Selector="Ambient" />
                    </PropertyMappings>
                    <Selector>Draw</Selector>
                  </Expression>
                  <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.DrawModel.bonsai">
                    <TranslationX>-26.2002621</TranslationX>
                    <TranslationY>64.27876</TranslationY>
                    <TranslationZ>253.984634</TranslationZ>
                    <ScaleX>5</ScaleX>
                    <ScaleY>5</ScaleY>
                    <ScaleZ>5</ScaleZ>
                    <MeshName>sphere</MeshName>
                    <Ambient>
                      <X>1</X>
                      <Y>1</Y>
                      <Z>1</Z>
                    </Ambient>
                    <Diffuse>
                      <X>0</X>
                      <Y>0</Y>
                      <Z>0</Z>
                    </Diffuse>
                    <Specular>
                      <X>0</X>
                      <Y>0</Y>
                      <Z>0</Z>
                    </Specular>
                    <SpecularExponent>10</SpecularExponent>
                    <RotationZ>0</RotationZ>
                    <RotationY>0</RotationY>
                    <RotationX>0</RotationX>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:TakeUntil" />
                  </Expression>
                  <Expression xsi:type="WorkflowOutput" />
                </Nodes>
                <Edges>
                  <Edge From="0" To="1" Label="Source1" />
                  <Edge From="1" To="2" Label="Source1" />
                  <Edge From="2" To="16" Label="Source1" />
                  <Edge From="3" To="18" Label="Source1" />
                  <Edge From="4" To="14" Label="Source3" />
                  <Edge From="5" To="6" Label="Source1" />
                  <Edge From="6" To="7" Label="Source1" />
                  <Edge From="7" To="8" Label="Source1" />
                  <Edge From="8" To="22" Label="Source2" />
                  <Edge From="9" To="10" Label="Source1" />
                  <Edge From="10" To="11" Label="Source1" />
                  <Edge From="11" To="14" Label="Source2" />
                  <Edge From="12" To="13" Label="Source1" />
                  <Edge From="13" To="14" Label="Source1" />
                  <Edge From="14" To="15" Label="Source1" />
                  <Edge From="15" To="16" Label="Source2" />
                  <Edge From="16" To="17" Label="Source1" />
                  <Edge From="17" To="18" Label="Source2" />
                  <Edge From="18" To="19" Label="Source1" />
                  <Edge From="19" To="20" Label="Source1" />
                  <Edge From="20" To="21" Label="Source1" />
                  <Edge From="21" To="22" Label="Source1" />
                  <Edge From="22" To="23" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:Merge" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:TakeUntil" />
            </Expression>
            <Expression xsi:type="WorkflowOutput" />
          </Nodes>
          <Edges>
            <Edge From="0" To="1" Label="Source1" />
            <Edge From="1" To="11" Label="Source2" />
            <Edge From="2" To="11" Label="Source3" />
            <Edge From="3" To="17" Label="Source2" />
            <Edge From="4" To="5" Label="Source1" />
            <Edge From="5" To="6" Label="Source1" />
            <Edge From="6" To="7" Label="Source1" />
            <Edge From="7" To="21" Label="Source2" />
            <Edge From="8" To="16" Label="Source2" />
            <Edge From="9" To="10" Label="Source1" />
            <Edge From="10" To="11" Label="Source1" />
            <Edge From="11" To="14" Label="Source1" />
            <Edge From="12" To="13" Label="Source1" />
            <Edge From="13" To="14" Label="Source2" />
            <Edge From="14" To="15" Label="Source1" />
            <Edge From="15" To="16" Label="Source1" />
            <Edge From="16" To="17" Label="Source1" />
            <Edge From="17" To="18" Label="Source1" />
            <Edge From="18" To="19" Label="Source1" />
            <Edge From="19" To="20" Label="Source1" />
            <Edge From="20" To="21" Label="Source1" />
            <Edge From="21" To="22" Label="Source1" />
          </Edges>
        </Workflow>
      </Expression>
      <Expression xsi:type="GroupWorkflow">
        <Name>SphereParamsLoggerOpen</Name>
        <Workflow>
          <Nodes>
            <Expression xsi:type="BehaviorSubject" TypeArguments="sys:Tuple(sys:Int32,sys:Tuple(sys:Single,sys:Single,sys:Single),sys:Tuple(sys:Single,sys:Single,sys:Single,sys:Single,sys:Single),sys:Tuple(sys:Single,sys:Single))">
              <Name>SphereNewParamsOpen</Name>
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>Frames</Name>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:WithLatestFrom" />
            </Expression>
            <Expression xsi:type="scr:ExpressionTransform">
              <scr:Expression>new(
Item2.Index as Frame,
Item2.Value.ElapsedTime as FrameElapsedTime,
Item2.Value.ElapsedRealTime as FrameElapsedRealTime,
Item1.Item1 as SphereID,
Math.Round(Item1.Item2.Item1/Math.PI*180) as Azimuth,
Math.Round(Item1.Item2.Item2/Math.PI*180) as Elevation,
Item1.Item2.Item3 as Depth,
Item1.Item3.Item1 as X, 
Item1.Item3.Item2 as Y, 
Item1.Item3.Item3 as Z0, 
Item1.Item3.Item4 as Z, 
Item1.Item3.Item5 as MouseZ,
Item1.Item4.Item1 as OriginalSize,
Item1.Item4.Item2 as Size)</scr:Expression>
            </Expression>
            <Expression xsi:type="io:CsvWriter">
              <io:FileName>saved_csv\Spheres_NewParams_Open.csv</io:FileName>
              <io:Append>false</io:Append>
              <io:Overwrite>false</io:Overwrite>
              <io:Suffix>Timestamp</io:Suffix>
              <io:IncludeHeader>true</io:IncludeHeader>
            </Expression>
            <Expression xsi:type="BehaviorSubject" TypeArguments="sys:Tuple(sys:Tuple(sys:Int32,sys:Tuple(sys:Single,sys:Single,sys:Single),sys:Tuple(sys:Single,sys:Single,sys:Single,sys:Single,sys:Single),sys:Tuple(sys:Single,sys:Single)),sys:Single)">
              <Name>SphereAllParamsOpen</Name>
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>Frames</Name>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:CombineLatest" />
            </Expression>
            <Expression xsi:type="scr:ExpressionTransform">
              <scr:Expression>new(
Item2.Index as Frame,
Item2.Value.ElapsedTime as FrameElapsedTime,
Item2.Value.ElapsedRealTime as FrameElapsedRealTime,
Item1.Item1.Item1 as SphereID,
Math.Round(Item1.Item1.Item2.Item1/Math.PI*180) as Azimuth,
Math.Round(Item1.Item1.Item2.Item2/Math.PI*180) as Elevation,
Item1.Item1.Item2.Item3 as Depth,
Item1.Item1.Item3.Item1 as X, 
Item1.Item1.Item3.Item2 as Y, 
Item1.Item1.Item3.Item3 as Z0, 
Item1.Item1.Item3.Item4 as Z, 
Item1.Item1.Item3.Item5 as MouseZ,
Item1.Item1.Item4.Item1 as OriginalSize,
Item1.Item1.Item4.Item2 as Size,
Item1.Item2 as Ambient)</scr:Expression>
            </Expression>
            <Expression xsi:type="io:CsvWriter">
              <io:FileName>saved_csv\Spheres_AllParams_Open.csv</io:FileName>
              <io:Append>false</io:Append>
              <io:Overwrite>true</io:Overwrite>
              <io:Suffix>Timestamp</io:Suffix>
              <io:IncludeHeader>true</io:IncludeHeader>
            </Expression>
            <Expression xsi:type="SubscribeSubject">
              <Name>CloseLoopDuration</Name>
            </Expression>
            <Expression xsi:type="Multiply">
              <Operand xsi:type="FloatProperty">
                <Value>1E+07</Value>
              </Operand>
            </Expression>
            <Expression xsi:type="PropertyMapping">
              <PropertyMappings>
                <Property Name="DueTime" />
              </PropertyMappings>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="gl:Timer">
                <gl:DueTime>P23148DT3H34M14.5128448S</gl:DueTime>
              </Combinator>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:TakeUntil" />
            </Expression>
          </Nodes>
          <Edges>
            <Edge From="0" To="2" Label="Source1" />
            <Edge From="1" To="2" Label="Source2" />
            <Edge From="2" To="3" Label="Source1" />
            <Edge From="3" To="4" Label="Source1" />
            <Edge From="5" To="7" Label="Source1" />
            <Edge From="6" To="7" Label="Source2" />
            <Edge From="7" To="8" Label="Source1" />
            <Edge From="8" To="9" Label="Source1" />
            <Edge From="9" To="14" Label="Source1" />
            <Edge From="10" To="11" Label="Source1" />
            <Edge From="11" To="12" Label="Source1" />
            <Edge From="12" To="13" Label="Source1" />
            <Edge From="13" To="14" Label="Source2" />
          </Edges>
        </Workflow>
      </Expression>
      <Expression xsi:type="GroupWorkflow">
        <Name>harp_hardware</Name>
        <Workflow>
          <Nodes>
            <Expression xsi:type="IncludeWorkflow" Path="Bonsai.Harp:CommandSubject.bonsai">
              <Name>Command</Name>
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="harp:Device">
                <harp:DeviceState>Active</harp:DeviceState>
                <harp:DumpRegisters>true</harp:DumpRegisters>
                <harp:LedState>On</harp:LedState>
                <harp:VisualIndicators>On</harp:VisualIndicators>
                <harp:Heartbeat>Disable</harp:Heartbeat>
                <harp:IgnoreErrors>false</harp:IgnoreErrors>
                <harp:PortName>COM3</harp:PortName>
              </Combinator>
            </Expression>
            <Expression xsi:type="MemberSelector">
              <Selector>MessageBytes</Selector>
            </Expression>
            <Expression xsi:type="ExternalizedMapping">
              <Property Name="Path" DisplayName="HarpSavePath" Category="Logging" />
            </Expression>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="dsp:MatrixWriter">
                <dsp:Path>harp_meassges.bin</dsp:Path>
                <dsp:Suffix>Timestamp</dsp:Suffix>
                <dsp:Overwrite>false</dsp:Overwrite>
                <dsp:Layout>ColumnMajor</dsp:Layout>
              </Combinator>
            </Expression>
            <Expression xsi:type="IncludeWorkflow" Path="Bonsai.Harp:MulticastTimestamp.bonsai">
              <Name>Timestamp</Name>
            </Expression>
            <Expression xsi:type="p2:BehaviorEvent">
              <p2:Type>Input</p2:Type>
              <p2:Mask>Port1</p2:Mask>
            </Expression>
            <Expression xsi:type="PublishSubject">
              <Name>LickDetection</Name>
            </Expression>
            <Expression xsi:type="p2:BehaviorEvent">
              <p2:Type>RegisterAnalogInput</p2:Type>
              <p2:Mask>Port2</p2:Mask>
            </Expression>
            <Expression xsi:type="MemberSelector">
              <Selector>Value</Selector>
            </Expression>
            <Expression xsi:type="BehaviorSubject">
              <Name>photodiode</Name>
            </Expression>
            <Expression xsi:type="p2:BehaviorEvent">
              <p2:Type>QuadratureCounter</p2:Type>
              <p2:Mask>Port2</p2:Mask>
            </Expression>
            <Expression xsi:type="GroupWorkflow">
              <Name>CalculateDistance</Name>
              <Workflow>
                <Nodes>
                  <Expression xsi:type="WorkflowInput">
                    <Name>Source1</Name>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Skip">
                      <rx:Count>1</rx:Count>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="Combinator">
                    <Combinator xsi:type="rx:Buffer">
                      <rx:Count>2</rx:Count>
                      <rx:Skip>1</rx:Skip>
                    </Combinator>
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Name>diffence</scr:Name>
                    <scr:Expression>it[0]-it[1]</scr:Expression>
                  </Expression>
                  <Expression xsi:type="scr:ExpressionTransform">
                    <scr:Name>CutArtefact</scr:Name>
                    <scr:Expression>new(
(it &gt; 60000)? (it-65536) : ((it&lt;-60000)? (it+65536) : it) as step
) </scr:Expression>
                  </Expression>
                  <Expression xsi:type="MemberSelector">
                    <Selector>step</Selector>
                  </Expression>
                  <Expression xsi:type="rx:Accumulate" />
                  <Expression xsi:type="WorkflowOutput" />
                </Nodes>
                <Edges>
                  <Edge From="0" To="1" Label="Source1" />
                  <Edge From="1" To="2" Label="Source1" />
                  <Edge From="2" To="3" Label="Source1" />
                  <Edge From="3" To="4" Label="Source1" />
                  <Edge From="4" To="5" Label="Source1" />
                  <Edge From="5" To="6" Label="Source1" />
                  <Edge From="6" To="7" Label="Source1" />
                </Edges>
              </Workflow>
            </Expression>
            <Expression xsi:type="BehaviorSubject">
              <Name>Mouse Distance</Name>
            </Expression>
            <Expression xsi:type="p2:BehaviorEvent">
              <p2:Type>Input</p2:Type>
              <p2:Mask>Port0</p2:Mask>
            </Expression>
            <Expression xsi:type="PublishSubject">
              <Name>SIFrameTrigger</Name>
            </Expression>
            <Expression xsi:type="PublishSubject" TypeArguments="sys:Boolean">
              <Name>Reward</Name>
            </Expression>
            <Expression xsi:type="Disable">
              <Builder xsi:type="Combinator">
                <Combinator xsi:type="BooleanProperty">
                  <Value>false</Value>
                </Combinator>
              </Builder>
            </Expression>
            <Expression xsi:type="p2:BehaviorCommand">
              <p2:Type>ToggleOutput</p2:Type>
              <p2:Mask>Poke2Valve</p2:Mask>
            </Expression>
            <Expression xsi:type="MulticastSubject">
              <Name>Command</Name>
            </Expression>
            <Expression xsi:type="IncludeWorkflow" Path="Bonsai.Harp:TimestampSubject.bonsai">
              <Name>Timestamp</Name>
            </Expression>
            <Expression xsi:type="PublishSubject" TypeArguments="sys:Boolean">
              <Name>DO0</Name>
            </Expression>
            <Expression xsi:type="Disable">
              <Builder xsi:type="Combinator">
                <Combinator xsi:type="BooleanProperty">
                  <Value>false</Value>
                </Combinator>
              </Builder>
            </Expression>
            <Expression xsi:type="p2:BehaviorCommand">
              <p2:Type>ToggleOutput</p2:Type>
              <p2:Mask>Digital0</p2:Mask>
            </Expression>
            <Expression xsi:type="MulticastSubject">
              <Name>Command</Name>
            </Expression>
          </Nodes>
          <Edges>
            <Edge From="0" To="1" Label="Source1" />
            <Edge From="1" To="2" Label="Source1" />
            <Edge From="1" To="5" Label="Source1" />
            <Edge From="1" To="6" Label="Source1" />
            <Edge From="1" To="8" Label="Source1" />
            <Edge From="1" To="11" Label="Source1" />
            <Edge From="1" To="14" Label="Source1" />
            <Edge From="2" To="4" Label="Source2" />
            <Edge From="3" To="4" Label="Source1" />
            <Edge From="6" To="7" Label="Source1" />
            <Edge From="8" To="9" Label="Source1" />
            <Edge From="9" To="10" Label="Source1" />
            <Edge From="11" To="12" Label="Source1" />
            <Edge From="12" To="13" Label="Source1" />
            <Edge From="14" To="15" Label="Source1" />
            <Edge From="16" To="17" Label="Source1" />
            <Edge From="17" To="18" Label="Source1" />
            <Edge From="18" To="19" Label="Source1" />
            <Edge From="21" To="22" Label="Source1" />
            <Edge From="22" To="23" Label="Source1" />
            <Edge From="23" To="24" Label="Source1" />
          </Edges>
        </Workflow>
      </Expression>
      <Expression xsi:type="Disable">
        <Builder xsi:type="GroupWorkflow">
          <Name>TestSphereSize</Name>
          <Workflow>
            <Nodes>
              <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.ParameterRange.bonsai">
                <RangeMin>0</RangeMin>
                <RangeMax>180</RangeMax>
                <Count>37</Count>
              </Expression>
              <Expression xsi:type="Combinator">
                <Combinator xsi:type="num:DegreeToRadian" />
              </Expression>
              <Expression xsi:type="Combinator">
                <Combinator xsi:type="FloatProperty">
                  <Value>0</Value>
                </Combinator>
              </Expression>
              <Expression xsi:type="Combinator">
                <Combinator xsi:type="num:DegreeToRadian" />
              </Expression>
              <Expression xsi:type="Combinator">
                <Combinator xsi:type="FloatProperty">
                  <Value>3</Value>
                </Combinator>
              </Expression>
              <Expression xsi:type="Combinator">
                <Combinator xsi:type="FloatProperty">
                  <Value>0.043</Value>
                </Combinator>
              </Expression>
              <Expression xsi:type="Combinator">
                <Combinator xsi:type="rx:CombineLatest" />
              </Expression>
              <Expression xsi:type="SelectMany">
                <Workflow>
                  <Nodes>
                    <Expression xsi:type="WorkflowInput">
                      <Name>Source1</Name>
                    </Expression>
                    <Expression xsi:type="scr:ExpressionTransform">
                      <scr:Expression>new(
Item1 as Azi,
Item2 as Ele,
Item3 as Depth,
Item4 as OriSize)</scr:Expression>
                    </Expression>
                    <Expression xsi:type="scr:ExpressionTransform">
                      <scr:Expression>new(
Depth * Math.Cos(Ele) * Math.Cos(Azi) as X,
Depth * Math.Sin(Ele) as Y,
Depth * Math.Cos(Ele) * Math.Sin(Azi) as Z0,
Depth * OriSize as Size
)

</scr:Expression>
                    </Expression>
                    <Expression xsi:type="SubscribeSubject">
                      <Name>Draw</Name>
                    </Expression>
                    <Expression xsi:type="Combinator">
                      <Combinator xsi:type="rx:CombineLatest" />
                    </Expression>
                    <Expression xsi:type="InputMapping">
                      <PropertyMappings>
                        <Property Name="TranslationX" Selector="Item1.X" />
                        <Property Name="TranslationY" Selector="Item1.Y" />
                        <Property Name="TranslationZ" Selector="Item1.Z0" />
                        <Property Name="ScaleX" Selector="Item1.Size" />
                        <Property Name="ScaleY" Selector="Item1.Size" />
                        <Property Name="ScaleZ" Selector="Item1.Size" />
                      </PropertyMappings>
                      <Selector>Item2</Selector>
                    </Expression>
                    <Expression xsi:type="IncludeWorkflow" Path="BonVision:Primitives.DrawModel.bonsai">
                      <TranslationX>-3</TranslationX>
                      <TranslationY>0</TranslationY>
                      <TranslationZ>3.673819E-16</TranslationZ>
                      <ScaleX>0.129000008</ScaleX>
                      <ScaleY>0.129000008</ScaleY>
                      <ScaleZ>0.129000008</ScaleZ>
                      <MeshName>sphere</MeshName>
                      <Ambient>
                        <X>1</X>
                        <Y>1</Y>
                        <Z>1</Z>
                      </Ambient>
                      <Diffuse>
                        <X>1</X>
                        <Y>1</Y>
                        <Z>1</Z>
                      </Diffuse>
                      <Specular>
                        <X>1</X>
                        <Y>1</Y>
                        <Z>1</Z>
                      </Specular>
                      <SpecularExponent>10</SpecularExponent>
                      <RotationZ>0</RotationZ>
                      <RotationY>0</RotationY>
                      <RotationX>0</RotationX>
                    </Expression>
                    <Expression xsi:type="WorkflowOutput" />
                  </Nodes>
                  <Edges>
                    <Edge From="0" To="1" Label="Source1" />
                    <Edge From="1" To="2" Label="Source1" />
                    <Edge From="2" To="4" Label="Source1" />
                    <Edge From="3" To="4" Label="Source2" />
                    <Edge From="4" To="5" Label="Source1" />
                    <Edge From="5" To="6" Label="Source1" />
                    <Edge From="6" To="7" Label="Source1" />
                  </Edges>
                </Workflow>
              </Expression>
              <Expression xsi:type="WorkflowOutput" />
            </Nodes>
            <Edges>
              <Edge From="0" To="1" Label="Source1" />
              <Edge From="1" To="6" Label="Source1" />
              <Edge From="2" To="3" Label="Source1" />
              <Edge From="3" To="6" Label="Source2" />
              <Edge From="4" To="6" Label="Source3" />
              <Edge From="5" To="6" Label="Source4" />
              <Edge From="6" To="7" Label="Source1" />
              <Edge From="7" To="8" Label="Source1" />
            </Edges>
          </Workflow>
        </Builder>
      </Expression>
      <Expression xsi:type="GroupWorkflow">
        <Name>FrameLogger</Name>
        <Workflow>
          <Nodes>
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="gl:UpdateFrame" />
            </Expression>
            <Expression xsi:type="Disable">
              <Builder xsi:type="Combinator">
                <Combinator xsi:type="gl:RenderFrame" />
              </Builder>
            </Expression>
            <Expression xsi:type="MemberSelector">
              <Selector>TimeStep.ElapsedRealTime</Selector>
            </Expression>
            <Expression xsi:type="rx:Accumulate" />
            <Expression xsi:type="Combinator">
              <Combinator xsi:type="rx:ElementIndex" />
            </Expression>
            <Expression xsi:type="IncludeWorkflow" Path="Bonsai.Harp:WithLatestTimestamp.bonsai">
              <Name>Timestamp</Name>
            </Expression>
            <Expression xsi:type="scr:ExpressionTransform">
              <scr:Expression>new(
it.Value.Index as Frame,
it.Value.Value as BonsaiElapsedTime, it.Timestamp as HarpTime)</scr:Expression>
            </Expression>
            <Expression xsi:type="io:CsvWriter">
              <io:FileName>saved_csv\Spheres_framelog.csv</io:FileName>
              <io:Delimiter>,</io:Delimiter>
              <io:Append>true</io:Append>
              <io:Overwrite>false</io:Overwrite>
              <io:Suffix>Timestamp</io:Suffix>
              <io:IncludeHeader>true</io:IncludeHeader>
            </Expression>
            <Expression xsi:type="WorkflowOutput" />
          </Nodes>
          <Edges>
            <Edge From="0" To="1" Label="Source1" />
            <Edge From="1" To="2" Label="Source1" />
            <Edge From="2" To="3" Label="Source1" />
            <Edge From="3" To="4" Label="Source1" />
            <Edge From="4" To="5" Label="Source1" />
            <Edge From="5" To="6" Label="Source1" />
            <Edge From="6" To="7" Label="Source1" />
            <Edge From="7" To="8" Label="Source1" />
          </Edges>
        </Workflow>
      </Expression>
    </Nodes>
    <Edges />
  </Workflow>
</WorkflowBuilder>